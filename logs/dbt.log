[0m12:28:37.838124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B780385D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B78039D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B7803B790>]}


============================== 12:28:37.846124 | 41a5f294-174b-4ea9-bb4b-6a38ac3bc7da ==============================
[0m12:28:37.846124 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:28:37.847124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init telegram_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:28:37.900507 [info ] [MainThread]: Creating dbt configuration folder at C:\Users\pc\.dbt
[0m12:28:37.904508 [debug] [MainThread]: Starter project path: C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\include\starter_project
[0m12:28:37.987864 [info ] [MainThread]: 
Your new dbt project "telegram_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:28:37.990116 [info ] [MainThread]: Setting up your profile.
[0m12:45:34.939601 [info ] [MainThread]: Profile telegram_project written to C:\Users\pc\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:45:34.942630 [debug] [MainThread]: Command `dbt init` succeeded at 12:45:34.941602 after 1017.22 seconds
[0m12:45:34.942630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B715E15D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B780641D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B71357F90>]}
[0m12:45:34.943604 [debug] [MainThread]: Flushing usage events
[0m12:45:36.552563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:22.606306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024086919590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240868EED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240868ED010>]}


============================== 13:13:22.611300 | 50ec8988-1c41-4e53-b6c5-c12fb8e771a6 ==============================
[0m13:13:22.611300 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:13:22.612270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:13:22.613300 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:13:22.615302 [debug] [MainThread]: Command `dbt run` failed at 13:13:22.614270 after 0.10 seconds
[0m13:13:22.615302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240868B22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408690FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FFF01690>]}
[0m13:13:22.616301 [debug] [MainThread]: Flushing usage events
[0m13:13:24.248889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:52.955823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6368DBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B635A248D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63693B5D0>]}


============================== 13:13:52.959823 | c34d0a8b-b689-452a-887c-97c4c4f9d922 ==============================
[0m13:13:52.959823 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:13:52.960823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:13:52.961823 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:13:52.963822 [debug] [MainThread]: Command `dbt run` failed at 13:13:52.963822 after 0.09 seconds
[0m13:13:52.963822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B636938D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6368D2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63664CED0>]}
[0m13:13:52.964823 [debug] [MainThread]: Flushing usage events
[0m13:13:54.253310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:49.087754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB898410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB86D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB86F9D0>]}


============================== 14:15:49.095759 | b789fbe4-6bae-49e6-99e9-c3a579889732 ==============================
[0m14:15:49.095759 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:15:49.096755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:49.097756 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m14:15:49.100756 [debug] [MainThread]: Command `dbt run` failed at 14:15:49.100756 after 0.10 seconds
[0m14:15:49.101754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB82E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CD4E41690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CDB838DD0>]}
[0m14:15:49.102755 [debug] [MainThread]: Flushing usage events
[0m14:15:50.680038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:45.216874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B61EBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B624B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B6249B90>]}


============================== 08:54:45.221883 | 7f31c09d-e8a3-436d-85f2-37e33dc1356b ==============================
[0m08:54:45.221883 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:54:45.223877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:54:45.224874 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  C:\Users\pc\.dbt/profiles.yml
  
[0m08:54:45.226876 [debug] [MainThread]: Command `dbt run` failed at 08:54:45.225875 after 0.07 seconds
[0m08:54:45.226876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B61E2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF851790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243B6249110>]}
[0m08:54:45.227875 [debug] [MainThread]: Flushing usage events
[0m08:54:46.020995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:00.694034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022507759AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225077B9C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225077B90D0>]}


============================== 08:58:00.698034 | 86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d ==============================
[0m08:58:00.698034 [info ] [MainThread]: Running with dbt=1.10.3
[0m08:58:00.699034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:58:00.880034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225079A33D0>]}
[0m08:58:00.933034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225041449D0>]}
[0m08:58:00.935034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:58:01.154082 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m08:58:01.155035 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:58:01.156035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022507759910>]}
[0m08:58:01.842108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.telegram_project.marts
- models.telegram_project.staging
[0m08:58:01.848141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225089D0190>]}
[0m08:58:01.885108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m08:58:01.888109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m08:58:01.909950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022508C884D0>]}
[0m08:58:01.909950 [info ] [MainThread]: Found 433 macros
[0m08:58:01.910956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ce85e0-e32d-4ef0-bfed-9eb31a44ab8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022507837E50>]}
[0m08:58:01.911957 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:58:01.912957 [debug] [MainThread]: Command end result
[0m08:58:01.929955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m08:58:01.931956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m08:58:01.935965 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m08:58:01.936957 [debug] [MainThread]: Command `dbt run` succeeded at 08:58:01.936957 after 1.31 seconds
[0m08:58:01.937965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022500D66910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022500B47650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022500DD17D0>]}
[0m08:58:01.938958 [debug] [MainThread]: Flushing usage events
[0m08:58:02.719599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:13.604849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815844D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815818D110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815844D090>]}


============================== 09:02:13.608850 | 0a40f0b2-40b6-479d-8d1e-9f83f8f6926d ==============================
[0m09:02:13.608850 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:02:13.609850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:02:13.793848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815865CF90>]}
[0m09:02:13.849884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018154E05E50>]}
[0m09:02:13.850878 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:02:14.070852 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:02:14.117850 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:02:14.119853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018157B660D0>]}
[0m09:02:14.771866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.telegram_project.marts
- models.telegram_project.staging
[0m09:02:14.776849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018157B47110>]}
[0m09:02:14.814850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:02:14.816850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:02:14.840850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181599CB610>]}
[0m09:02:14.841849 [info ] [MainThread]: Found 433 macros
[0m09:02:14.842869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a40f0b2-40b6-479d-8d1e-9f83f8f6926d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815997A0D0>]}
[0m09:02:14.843850 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:02:14.844857 [debug] [MainThread]: Command end result
[0m09:02:14.864850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:02:14.866850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:02:14.869849 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:02:14.871849 [debug] [MainThread]: Command `dbt run` succeeded at 09:02:14.871849 after 1.34 seconds
[0m09:02:14.871849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181519B6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018151797650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018151A217D0>]}
[0m09:02:14.872850 [debug] [MainThread]: Flushing usage events
[0m09:02:15.685562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:44.376147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B892F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B8904CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B8904490>]}


============================== 09:02:44.379147 | 3ed3d0d6-8957-4918-8e7f-7820d8d6e854 ==============================
[0m09:02:44.379147 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:02:44.380146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:02:44.400147 [info ] [MainThread]: dbt version: 1.10.3
[0m09:02:44.400147 [info ] [MainThread]: python version: 3.11.3
[0m09:02:44.401167 [info ] [MainThread]: python path: C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Scripts\python.exe
[0m09:02:44.402147 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m09:02:44.458147 [info ] [MainThread]: Using profiles dir at C:\Users\pc\.dbt
[0m09:02:44.458147 [info ] [MainThread]: Using profiles.yml file at C:\Users\pc\.dbt\profiles.yml
[0m09:02:44.459162 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\dbt_project.yml
[0m09:02:44.460155 [info ] [MainThread]: adapter type: postgres
[0m09:02:44.461147 [info ] [MainThread]: adapter version: 1.9.0
[0m09:02:44.555148 [info ] [MainThread]: Configuration:
[0m09:02:44.555148 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:02:44.556148 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:02:44.556148 [info ] [MainThread]: Required dependencies:
[0m09:02:44.557148 [debug] [MainThread]: Executing "git --help"
[0m09:02:44.591147 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:02:44.592148 [debug] [MainThread]: STDERR: "b''"
[0m09:02:44.593147 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:02:44.594147 [info ] [MainThread]: Connection:
[0m09:02:44.594147 [info ] [MainThread]:   host: localhost
[0m09:02:44.595147 [info ] [MainThread]:   port: 5433
[0m09:02:44.595147 [info ] [MainThread]:   user: postgres
[0m09:02:44.596147 [info ] [MainThread]:   database: telegram_db
[0m09:02:44.597148 [info ] [MainThread]:   schema: analytics
[0m09:02:44.597148 [info ] [MainThread]:   connect_timeout: 10
[0m09:02:44.598147 [info ] [MainThread]:   role: None
[0m09:02:44.598147 [info ] [MainThread]:   search_path: None
[0m09:02:44.599150 [info ] [MainThread]:   keepalives_idle: 0
[0m09:02:44.599150 [info ] [MainThread]:   sslmode: None
[0m09:02:44.600147 [info ] [MainThread]:   sslcert: None
[0m09:02:44.600147 [info ] [MainThread]:   sslkey: None
[0m09:02:44.601148 [info ] [MainThread]:   sslrootcert: None
[0m09:02:44.601148 [info ] [MainThread]:   application_name: dbt
[0m09:02:44.602148 [info ] [MainThread]:   retries: 1
[0m09:02:44.603147 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:02:44.845143 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:02:46.012151 [debug] [MainThread]: Using postgres connection "debug"
[0m09:02:46.013144 [debug] [MainThread]: On debug: select 1 as id
[0m09:02:46.013144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:02:46.210579 [debug] [MainThread]: SQL status: SELECT 1 in 0.197 seconds
[0m09:02:46.211598 [debug] [MainThread]: On debug: Close
[0m09:02:46.211598 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:02:46.212610 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:02:46.214606 [debug] [MainThread]: Command `dbt debug` succeeded at 09:02:46.214606 after 1.90 seconds
[0m09:02:46.214606 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:02:46.215579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B8905190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B8904F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291B864D810>]}
[0m09:02:46.215579 [debug] [MainThread]: Flushing usage events
[0m09:02:46.909980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:03:06.847173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AE62F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B1CEBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B1C8A190>]}


============================== 09:03:06.851172 | 1e9f4c70-b9db-4223-84b3-6e17bd1edf59 ==============================
[0m09:03:06.851172 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:03:06.852187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ls', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:03:07.043213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e9f4c70-b9db-4223-84b3-6e17bd1edf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B1C8A350>]}
[0m09:03:07.101208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e9f4c70-b9db-4223-84b3-6e17bd1edf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AE674B10>]}
[0m09:03:07.102206 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:03:07.324207 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:03:07.413172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:03:07.414186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:03:07.414186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.telegram_project.staging
- models.telegram_project.marts
[0m09:03:07.419206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9f4c70-b9db-4223-84b3-6e17bd1edf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3140A10>]}
[0m09:03:07.459206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:03:07.462203 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:03:07.483173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9f4c70-b9db-4223-84b3-6e17bd1edf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B1E30610>]}
[0m09:03:07.484175 [info ] [MainThread]: Found 433 macros
[0m09:03:07.484175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9f4c70-b9db-4223-84b3-6e17bd1edf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3173F10>]}
[0m09:03:07.485189 [warn ] [MainThread]: No nodes selected!
[0m09:03:07.486173 [debug] [MainThread]: Command `dbt ls` succeeded at 09:03:07.486173 after 0.70 seconds
[0m09:03:07.487172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B1C86410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AB047690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3140610>]}
[0m09:03:07.487172 [debug] [MainThread]: Flushing usage events
[0m09:03:08.209336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:29.323597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1B99B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1B99C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1B99710>]}


============================== 09:05:29.326597 | cc2e76dd-b0d5-4e91-9cf7-ed1b35fdcefb ==============================
[0m09:05:29.326597 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:05:29.327597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:05:29.459597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc2e76dd-b0d5-4e91-9cf7-ed1b35fdcefb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1CBED90>]}
[0m09:05:29.481597 [debug] [MainThread]: Command `dbt clean` succeeded at 09:05:29.481597 after 0.23 seconds
[0m09:05:29.482597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1B96490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1C19DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4C1C1A350>]}
[0m09:05:29.483598 [debug] [MainThread]: Flushing usage events
[0m09:05:30.549119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:49.661992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E60A05310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E60A041D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E60A045D0>]}


============================== 09:05:49.666002 | 5502fbf8-7605-4205-b71e-bdc6e7ed4d93 ==============================
[0m09:05:49.666002 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:05:49.667007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:05:49.680992 [info ] [MainThread]: dbt version: 1.10.3
[0m09:05:49.681992 [info ] [MainThread]: python version: 3.11.3
[0m09:05:49.683012 [info ] [MainThread]: python path: C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Scripts\python.exe
[0m09:05:49.683012 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m09:05:49.736022 [info ] [MainThread]: Using profiles dir at C:\Users\pc\.dbt
[0m09:05:49.737021 [info ] [MainThread]: Using profiles.yml file at C:\Users\pc\.dbt\profiles.yml
[0m09:05:49.737993 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\dbt_project.yml
[0m09:05:49.741027 [info ] [MainThread]: adapter type: postgres
[0m09:05:49.742027 [info ] [MainThread]: adapter version: 1.9.0
[0m09:05:49.834992 [info ] [MainThread]: Configuration:
[0m09:05:49.835991 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:05:49.835991 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:05:49.836992 [info ] [MainThread]: Required dependencies:
[0m09:05:49.836992 [debug] [MainThread]: Executing "git --help"
[0m09:05:49.866903 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:05:49.867974 [debug] [MainThread]: STDERR: "b''"
[0m09:05:49.868494 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:05:49.869015 [info ] [MainThread]: Connection:
[0m09:05:49.869532 [info ] [MainThread]:   host: localhost
[0m09:05:49.870055 [info ] [MainThread]:   port: 5433
[0m09:05:49.870580 [info ] [MainThread]:   user: postgres
[0m09:05:49.871104 [info ] [MainThread]:   database: telegram_db
[0m09:05:49.871628 [info ] [MainThread]:   schema: analytics
[0m09:05:49.872161 [info ] [MainThread]:   connect_timeout: 10
[0m09:05:49.872687 [info ] [MainThread]:   role: None
[0m09:05:49.873269 [info ] [MainThread]:   search_path: None
[0m09:05:49.873777 [info ] [MainThread]:   keepalives_idle: 0
[0m09:05:49.874306 [info ] [MainThread]:   sslmode: None
[0m09:05:49.874829 [info ] [MainThread]:   sslcert: None
[0m09:05:49.875349 [info ] [MainThread]:   sslkey: None
[0m09:05:49.875869 [info ] [MainThread]:   sslrootcert: None
[0m09:05:49.876388 [info ] [MainThread]:   application_name: dbt
[0m09:05:49.876904 [info ] [MainThread]:   retries: 1
[0m09:05:49.877425 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:05:50.122016 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:05:50.185048 [debug] [MainThread]: Using postgres connection "debug"
[0m09:05:50.185048 [debug] [MainThread]: On debug: select 1 as id
[0m09:05:50.186019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:05:50.350072 [debug] [MainThread]: SQL status: SELECT 1 in 0.164 seconds
[0m09:05:50.352042 [debug] [MainThread]: On debug: Close
[0m09:05:50.352042 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:05:50.353043 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:05:50.354042 [debug] [MainThread]: Command `dbt debug` succeeded at 09:05:50.354042 after 0.76 seconds
[0m09:05:50.354042 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:05:50.355041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E61D81B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6074D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E59DB7650>]}
[0m09:05:50.355041 [debug] [MainThread]: Flushing usage events
[0m09:05:51.066188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:07.128211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B261AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B25EB990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B261BED0>]}


============================== 09:06:07.132212 | 2b70bbe1-89a5-4f81-825f-ddeeb1536a62 ==============================
[0m09:06:07.132212 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:06:07.132212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m09:06:07.311211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b70bbe1-89a5-4f81-825f-ddeeb1536a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B2802E10>]}
[0m09:06:07.365212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b70bbe1-89a5-4f81-825f-ddeeb1536a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232AEFB55D0>]}
[0m09:06:07.366211 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:07.582254 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:06:07.583245 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:06:07.584212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b70bbe1-89a5-4f81-825f-ddeeb1536a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B261AB50>]}
[0m09:06:08.653213 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_project.stg_image_detections' (telegram_project/models\staging\stg_image_detections.sql) depends on a source named 'raw.image_detections' which was not found
[0m09:06:08.655212 [debug] [MainThread]: Command `dbt ls` failed at 09:06:08.655212 after 1.59 seconds
[0m09:06:08.656212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B25B2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B261B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B2618D10>]}
[0m09:06:08.656212 [debug] [MainThread]: Flushing usage events
[0m09:06:09.372121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:47.464957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C5BA790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C32D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C5B9F90>]}


============================== 09:07:47.468956 | 6bdbfd9e-5200-4941-a700-0dcc7f45d0ec ==============================
[0m09:07:47.468956 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:07:47.469957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:07:47.646989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bdbfd9e-5200-4941-a700-0dcc7f45d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C803C50>]}
[0m09:07:47.699989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bdbfd9e-5200-4941-a700-0dcc7f45d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223487B4C10>]}
[0m09:07:47.701979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:07:47.931991 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:07:47.932957 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:07:47.932957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6bdbfd9e-5200-4941-a700-0dcc7f45d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D999850>]}
[0m09:07:49.084018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bdbfd9e-5200-4941-a700-0dcc7f45d0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234DBE13D0>]}
[0m09:07:49.160991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:07:49.163993 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:07:49.180990 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages
[0m09:07:49.191990 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 372, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\main.py", line 520, in list
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\list.py", line 158, in run
    self.compile_manifest()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages

[0m09:07:49.195008 [debug] [MainThread]: Command `dbt ls` failed at 09:07:49.195008 after 1.79 seconds
[0m09:07:49.196026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C5B2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C619FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C61A650>]}
[0m09:07:49.196026 [debug] [MainThread]: Flushing usage events
[0m09:07:49.982588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:25.484131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252702FBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527000CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527029A350>]}


============================== 09:10:25.488130 | 8101a950-f22b-4997-bba1-c65b3e7f0900 ==============================
[0m09:10:25.488130 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:10:25.489131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:10:25.667164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8101a950-f22b-4997-bba1-c65b3e7f0900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252704E3310>]}
[0m09:10:25.722167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8101a950-f22b-4997-bba1-c65b3e7f0900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526CC94AD0>]}
[0m09:10:25.724171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:10:25.948133 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:10:26.100167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:26.100167 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\sources.yml
[0m09:10:26.188164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8101a950-f22b-4997-bba1-c65b3e7f0900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527000D590>]}
[0m09:10:26.262158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:10:26.265170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:10:26.283130 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages
[0m09:10:26.285130 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 372, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\main.py", line 520, in list
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\list.py", line 158, in run
    self.compile_manifest()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages

[0m09:10:26.287131 [debug] [MainThread]: Command `dbt ls` failed at 09:10:26.287131 after 0.87 seconds
[0m09:10:26.288132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252702CAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025269566890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025269844250>]}
[0m09:10:26.288132 [debug] [MainThread]: Flushing usage events
[0m09:10:27.071501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:39.573975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BD2C4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BCEE3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BD2C4D90>]}


============================== 09:13:39.577975 | 95760eb3-58af-47f3-9db0-4c503c7900f9 ==============================
[0m09:13:39.577975 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:13:39.578980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ls --select state:modified', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:13:39.754975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95760eb3-58af-47f3-9db0-4c503c7900f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BD3E0690>]}
[0m09:13:39.808974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95760eb3-58af-47f3-9db0-4c503c7900f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6B9C65710>]}
[0m09:13:39.809975 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:13:40.037974 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:13:40.182974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:40.183975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:40.231390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95760eb3-58af-47f3-9db0-4c503c7900f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BE6DC090>]}
[0m09:13:40.316247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:13:40.318248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:13:40.335248 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages
[0m09:13:40.337248 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 372, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\main.py", line 520, in list
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\list.py", line 158, in run
    self.compile_manifest()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages

[0m09:13:40.339248 [debug] [MainThread]: Command `dbt ls` failed at 09:13:40.339248 after 0.83 seconds
[0m09:13:40.339248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6B6844410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BE8C8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6BE8C82D0>]}
[0m09:13:40.340248 [debug] [MainThread]: Flushing usage events
[0m09:13:41.581706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:55.263464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AF7A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AFA9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AFA8350>]}


============================== 09:13:55.267463 | 8df0fe0c-5f50-47ff-833a-90bec9b8ed59 ==============================
[0m09:13:55.267463 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:13:55.268464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --select state:modified', 'send_anonymous_usage_stats': 'True'}
[0m09:13:55.445503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8df0fe0c-5f50-47ff-833a-90bec9b8ed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655B1BD290>]}
[0m09:13:55.499497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8df0fe0c-5f50-47ff-833a-90bec9b8ed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265579757D0>]}
[0m09:13:55.501497 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:13:55.726496 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:13:55.867464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:55.867464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:55.909492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8df0fe0c-5f50-47ff-833a-90bec9b8ed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655C38A890>]}
[0m09:13:55.985464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:13:55.987481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:13:56.010463 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages
[0m09:13:56.012492 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 372, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\main.py", line 520, in list
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\list.py", line 158, in run
    self.compile_manifest()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages

[0m09:13:56.014491 [debug] [MainThread]: Command `dbt ls` failed at 09:13:56.014491 after 0.82 seconds
[0m09:13:56.015497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AFA9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002655AF6E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265542C2A90>]}
[0m09:13:56.015497 [debug] [MainThread]: Flushing usage events
[0m09:13:57.121349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:10.476560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B9289A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B92BCF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B92BC590>]}


============================== 09:15:10.480544 | 55baa539-c30c-4d41-8fb5-a767c0709412 ==============================
[0m09:15:10.480544 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:15:10.481545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:15:10.614544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55baa539-c30c-4d41-8fb5-a767c0709412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B92E7AD0>]}
[0m09:15:10.634545 [debug] [MainThread]: Command `dbt clean` succeeded at 09:15:10.633556 after 0.22 seconds
[0m09:15:10.634545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B2536890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B9308310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B930A4D0>]}
[0m09:15:10.635545 [debug] [MainThread]: Flushing usage events
[0m09:15:11.442072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:33.806564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83E89A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83BCD790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83E880D0>]}


============================== 09:15:33.809563 | 42fdbb03-762b-4ef3-aa07-50950d96c7d5 ==============================
[0m09:15:33.809563 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:15:33.810563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:15:33.991563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42fdbb03-762b-4ef3-aa07-50950d96c7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83E89E90>]}
[0m09:15:34.047563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42fdbb03-762b-4ef3-aa07-50950d96c7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F808E4950>]}
[0m09:15:34.048564 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:34.265591 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:15:34.266564 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:15:34.267564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42fdbb03-762b-4ef3-aa07-50950d96c7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F8523A290>]}
[0m09:15:35.426166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fdbb03-762b-4ef3-aa07-50950d96c7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F85524B50>]}
[0m09:15:35.503139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:15:35.507171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:15:35.528150 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages
[0m09:15:35.531148 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\requires.py", line 372, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\cli\main.py", line 347, in compile
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\runnable.py", line 583, in run
    self._runtime_initialize()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\task\base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\venv\Lib\site-packages\dbt\compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_project.dim_channels --> model.telegram_project.stg_telegram_messages

[0m09:15:35.533138 [debug] [MainThread]: Command `dbt compile` failed at 09:15:35.533138 after 1.79 seconds
[0m09:15:35.534138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FFD116890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83EC7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F83EC5090>]}
[0m09:15:35.534138 [debug] [MainThread]: Flushing usage events
[0m09:15:36.465319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:03.596416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FA6241D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FA624E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FA624D90>]}


============================== 09:16:03.600416 | 38d873e2-3db0-4cc1-b33b-148daf552d18 ==============================
[0m09:16:03.600416 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:16:03.601417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:03.782416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FA812950>]}
[0m09:16:03.838415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F6FB4D90>]}
[0m09:16:03.839423 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:04.069444 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:16:04.233415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:16:04.233415 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:16:04.597416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FBDF2A50>]}
[0m09:16:04.715415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:16:04.718416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:16:04.741426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FBCDFD10>]}
[0m09:16:04.742416 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:16:04.743417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F9073F50>]}
[0m09:16:04.744416 [info ] [MainThread]: 
[0m09:16:04.745416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:04.746436 [info ] [MainThread]: 
[0m09:16:04.747416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:04.751437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:16:04.834415 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:16:04.835416 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:16:04.835416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:04.978156 [debug] [ThreadPool]: SQL status: BEGIN in 0.142 seconds
[0m09:16:04.978673 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:16:04.979189 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:16:05.009921 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m09:16:05.011472 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:16:05.012023 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:16:05.017354 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:05.017870 [debug] [MainThread]: On master: BEGIN
[0m09:16:05.017870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:05.164239 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m09:16:05.165270 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:05.165270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:05.182504 [debug] [MainThread]: SQL status: SELECT 4 in 0.016 seconds
[0m09:16:05.184503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d873e2-3db0-4cc1-b33b-148daf552d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FBCDC950>]}
[0m09:16:05.184503 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:05.185503 [debug] [MainThread]: On master: Close
[0m09:16:05.191508 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:16:05.191508 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:16:05.192509 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:16:05.198508 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:16:05.201509 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:16:05.202527 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:16:05.203509 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:16:05.203509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:16:05.204508 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:16:05.206509 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:16:05.207508 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:16:05.208509 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:16:05.209516 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:16:05.209516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:16:05.210542 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:16:05.212541 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:16:05.214509 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:16:05.215537 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:16:05.215537 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:16:05.216784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:16:05.216784 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:16:05.219789 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:16:05.220790 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:16:05.221789 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:16:05.221789 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:16:05.222789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m09:16:05.222789 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:16:05.232789 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:16:05.234812 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:16:05.234812 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:16:05.235789 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68
[0m09:16:05.236790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68)
[0m09:16:05.236790 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68
[0m09:16:05.239789 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68"
[0m09:16:05.241803 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68
[0m09:16:05.241803 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68
[0m09:16:05.242789 [debug] [Thread-1 (]: Began running node test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:16:05.242789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.not_null_stg_telegram_messages_message_text.e53a8c7e68, now test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m09:16:05.243789 [debug] [Thread-1 (]: Began compiling node test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:16:05.248789 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:16:05.249789 [debug] [Thread-1 (]: Began executing node test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:16:05.250790 [debug] [Thread-1 (]: Finished running node test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:16:05.251789 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m09:16:05.251789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.unique_stg_telegram_messages_message_id.1c7c22c9a1, now test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b)
[0m09:16:05.252790 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m09:16:05.255790 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b"
[0m09:16:05.257790 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m09:16:05.257790 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b
[0m09:16:05.258790 [debug] [Thread-1 (]: Began running node test.telegram_project.unique_dim_channels_channel_id.d14657a1ec
[0m09:16:05.258790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.not_null_dim_channels_channel_id.93e5e4b23b, now test.telegram_project.unique_dim_channels_channel_id.d14657a1ec)
[0m09:16:05.259789 [debug] [Thread-1 (]: Began compiling node test.telegram_project.unique_dim_channels_channel_id.d14657a1ec
[0m09:16:05.263789 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.unique_dim_channels_channel_id.d14657a1ec"
[0m09:16:05.265789 [debug] [Thread-1 (]: Began executing node test.telegram_project.unique_dim_channels_channel_id.d14657a1ec
[0m09:16:05.266790 [debug] [Thread-1 (]: Finished running node test.telegram_project.unique_dim_channels_channel_id.d14657a1ec
[0m09:16:05.266790 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:16:05.267789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.unique_dim_channels_channel_id.d14657a1ec, now model.telegram_project.fct_messages)
[0m09:16:05.267789 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:16:05.270789 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:16:05.272790 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:16:05.272790 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:16:05.273790 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:16:05.274790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.fct_image_detections)
[0m09:16:05.274790 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:16:05.277790 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:16:05.278790 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:16:05.278790 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:16:05.279790 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_fct_messages_message_id.de346706b5
[0m09:16:05.280807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now test.telegram_project.not_null_fct_messages_message_id.de346706b5)
[0m09:16:05.281792 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_fct_messages_message_id.de346706b5
[0m09:16:05.285790 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_fct_messages_message_id.de346706b5"
[0m09:16:05.286790 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_fct_messages_message_id.de346706b5
[0m09:16:05.286790 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_fct_messages_message_id.de346706b5
[0m09:16:05.287789 [debug] [Thread-1 (]: Began running node test.telegram_project.unique_fct_messages_message_id.655aa1a48d
[0m09:16:05.287789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.not_null_fct_messages_message_id.de346706b5, now test.telegram_project.unique_fct_messages_message_id.655aa1a48d)
[0m09:16:05.288790 [debug] [Thread-1 (]: Began compiling node test.telegram_project.unique_fct_messages_message_id.655aa1a48d
[0m09:16:05.291789 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.unique_fct_messages_message_id.655aa1a48d"
[0m09:16:05.292790 [debug] [Thread-1 (]: Began executing node test.telegram_project.unique_fct_messages_message_id.655aa1a48d
[0m09:16:05.293823 [debug] [Thread-1 (]: Finished running node test.telegram_project.unique_fct_messages_message_id.655aa1a48d
[0m09:16:05.293823 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:16:05.294791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_project.unique_fct_messages_message_id.655aa1a48d, now test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m09:16:05.294791 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:16:05.298824 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:16:05.299795 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:16:05.300821 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:16:05.301794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:05.302792 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:16:05.302792 [debug] [MainThread]: Connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8' was properly closed.
[0m09:16:05.305791 [debug] [MainThread]: Command end result
[0m09:16:05.326792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:16:05.328792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:16:05.334818 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:16:05.335792 [debug] [MainThread]: Command `dbt compile` succeeded at 09:16:05.335792 after 1.81 seconds
[0m09:16:05.336792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F3826890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F38F7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F38F7650>]}
[0m09:16:05.336792 [debug] [MainThread]: Flushing usage events
[0m09:16:11.681503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:37.633422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC581AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC584D210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5879310>]}


============================== 09:16:37.637418 | b751a6b2-4e33-4933-a218-794f3aecdfab ==============================
[0m09:16:37.637418 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:16:37.637418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:16:37.841420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b751a6b2-4e33-4933-a218-794f3aecdfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC5A62950>]}
[0m09:16:37.906418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b751a6b2-4e33-4933-a218-794f3aecdfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC2205390>]}
[0m09:16:37.907419 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:38.138418 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:16:38.283066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:38.283066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:38.324065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b751a6b2-4e33-4933-a218-794f3aecdfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6D62C50>]}
[0m09:16:38.400066 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:16:38.402066 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:16:38.424071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b751a6b2-4e33-4933-a218-794f3aecdfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC587BF50>]}
[0m09:16:38.424071 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:16:38.425066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b751a6b2-4e33-4933-a218-794f3aecdfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6BFAD50>]}
[0m09:16:38.426067 [info ] [MainThread]: telegram_project.marts.dim_channels
[0m09:16:38.427065 [info ] [MainThread]: telegram_project.marts.dim_dates
[0m09:16:38.428084 [info ] [MainThread]: telegram_project.marts.fct_image_detections
[0m09:16:38.429066 [info ] [MainThread]: telegram_project.marts.fct_messages
[0m09:16:38.429066 [info ] [MainThread]: telegram_project.staging.stg_image_detections
[0m09:16:38.430066 [info ] [MainThread]: telegram_project.staging.stg_telegram_messages
[0m09:16:38.430066 [info ] [MainThread]: source:telegram_project.raw.image_detections
[0m09:16:38.431088 [info ] [MainThread]: telegram_project.models.not_null_dim_channels_channel_id
[0m09:16:38.432066 [info ] [MainThread]: telegram_project.models.marts.not_null_fct_image_detections_message_id
[0m09:16:38.432066 [info ] [MainThread]: telegram_project.models.not_null_fct_messages_message_id
[0m09:16:38.433067 [info ] [MainThread]: telegram_project.models.not_null_stg_telegram_messages_message_id
[0m09:16:38.434067 [info ] [MainThread]: telegram_project.models.not_null_stg_telegram_messages_message_text
[0m09:16:38.434067 [info ] [MainThread]: telegram_project.models.unique_dim_channels_channel_id
[0m09:16:38.435066 [info ] [MainThread]: telegram_project.models.unique_fct_messages_message_id
[0m09:16:38.435066 [info ] [MainThread]: telegram_project.models.unique_stg_telegram_messages_message_id
[0m09:16:38.437068 [debug] [MainThread]: Command `dbt ls` succeeded at 09:16:38.436066 after 0.87 seconds
[0m09:16:38.437068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFBEB16890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC558D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFBEBE7650>]}
[0m09:16:38.438068 [debug] [MainThread]: Flushing usage events
[0m09:16:39.149332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:08.456618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6018C9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6018CBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A601929E10>]}


============================== 09:17:08.460286 | 889dc171-d80b-43f1-9b69-f9091bb80d3d ==============================
[0m09:17:08.460286 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:17:08.461261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:17:08.641928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A601B0DC10>]}
[0m09:17:08.696928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67E2A5090>]}
[0m09:17:08.697929 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:08.941049 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:17:09.078049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:17:09.079063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:17:09.119049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A602E1BED0>]}
[0m09:17:09.196049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:17:09.199053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:17:09.219049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A601AA0650>]}
[0m09:17:09.220049 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:17:09.221063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A602CD69D0>]}
[0m09:17:09.223049 [info ] [MainThread]: 
[0m09:17:09.223049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:17:09.224051 [info ] [MainThread]: 
[0m09:17:09.224051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:17:09.228049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:17:09.301079 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:17:09.302049 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:17:09.302049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:09.335049 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.033 seconds
[0m09:17:09.337049 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:17:09.338050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:17:09.344052 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:17:09.344052 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:17:09.344052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:09.375050 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m09:17:09.376083 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:17:09.376083 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:17:09.382050 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:17:09.383049 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:17:09.384088 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:17:09.389085 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.389085 [debug] [MainThread]: On master: BEGIN
[0m09:17:09.390083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:17:09.419051 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m09:17:09.420077 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.420077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:17:09.427049 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m09:17:09.429050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A601B12910>]}
[0m09:17:09.430050 [debug] [MainThread]: On master: ROLLBACK
[0m09:17:09.430050 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.431050 [debug] [MainThread]: On master: BEGIN
[0m09:17:09.431050 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:17:09.432050 [debug] [MainThread]: On master: COMMIT
[0m09:17:09.432050 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.432050 [debug] [MainThread]: On master: COMMIT
[0m09:17:09.433050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:17:09.433050 [debug] [MainThread]: On master: Close
[0m09:17:09.437051 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:17:09.438050 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:17:09.439050 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:17:09.439050 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:17:09.449049 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:17:09.450050 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:17:09.481083 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:17:09.483049 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:17:09.484049 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:17:09.484049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:17:09.513049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m09:17:09.513049 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:17:09.514051 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT
    CAST(detection_id AS TEXT) AS detection_id,
    file_name,
    object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:17:09.523050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "detection_id" does not exist
LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                 ^

[0m09:17:09.524048 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: ROLLBACK
[0m09:17:09.525063 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:17:09.618287 [debug] [Thread-1 (]: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:17:09.620252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A601543F10>]}
[0m09:17:09.620252 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_image_detections ............ [[31mERROR[0m in 0.18s]
[0m09:17:09.621286 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:17:09.622256 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:17:09.622256 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql.
[0m09:17:09.623286 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:17:09.625255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:17:09.625255 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:17:09.628254 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:17:09.629255 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:17:09.632254 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:17:09.633254 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:17:09.634254 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:17:09.634254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:09.669260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m09:17:09.670253 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:17:09.670253 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.telegram_messages
),

cleaned AS (
    SELECT
        CAST(id AS INTEGER) AS message_id,
        sender_id,
        text,
        CAST(date AS TIMESTAMP) AS message_timestamp,
        channel_id,
        CASE WHEN media IS NOT NULL THEN TRUE ELSE FALSE END AS has_image
    FROM source
)

SELECT * FROM cleaned
  );
[0m09:17:09.673254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 13:         CAST(id AS INTEGER) AS message_id,
                      ^

[0m09:17:09.673254 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:17:09.674255 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:17:09.676265 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "id" does not exist
  LINE 13:         CAST(id AS INTEGER) AS message_id,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:17:09.677254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889dc171-d80b-43f1-9b69-f9091bb80d3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A602FC7E50>]}
[0m09:17:09.678255 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.05s]
[0m09:17:09.678842 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:17:09.679850 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "id" does not exist
  LINE 13:         CAST(id AS INTEGER) AS message_id,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:17:09.680850 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:17:09.680850 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:17:09.681962 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:17:09.681962 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:17:09.682969 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:17:09.683969 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:17:09.684969 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:17:09.684969 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:17:09.685968 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:17:09.685968 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:17:09.686968 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:17:09.687968 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:17:09.688968 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.689975 [debug] [MainThread]: On master: BEGIN
[0m09:17:09.689975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:17:09.720967 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:17:09.720967 [debug] [MainThread]: On master: COMMIT
[0m09:17:09.721967 [debug] [MainThread]: Using postgres connection "master"
[0m09:17:09.721967 [debug] [MainThread]: On master: COMMIT
[0m09:17:09.722967 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:17:09.722967 [debug] [MainThread]: On master: Close
[0m09:17:09.723967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:09.723967 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:17:09.724969 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:17:09.724969 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:17:09.725968 [info ] [MainThread]: 
[0m09:17:09.725968 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m09:17:09.727968 [debug] [MainThread]: Command end result
[0m09:17:09.804999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:17:09.806968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:17:09.812967 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:17:09.813969 [info ] [MainThread]: 
[0m09:17:09.813969 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:17:09.814970 [info ] [MainThread]: 
[0m09:17:09.815968 [error] [MainThread]: [31mFailure in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)[0m
[0m09:17:09.816968 [error] [MainThread]:   Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:17:09.816968 [info ] [MainThread]: 
[0m09:17:09.817968 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:17:09.818968 [info ] [MainThread]: 
[0m09:17:09.818968 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:17:09.819968 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "id" does not exist
  LINE 13:         CAST(id AS INTEGER) AS message_id,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:17:09.819968 [info ] [MainThread]: 
[0m09:17:09.820968 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:17:09.820968 [info ] [MainThread]: 
[0m09:17:09.821968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=6
[0m09:17:09.822968 [debug] [MainThread]: Command `dbt run` failed at 09:17:09.822968 after 1.44 seconds
[0m09:17:09.823969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67AB76890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A603252090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67AED1790>]}
[0m09:17:09.823969 [debug] [MainThread]: Flushing usage events
[0m09:17:10.594664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:03.297457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31061EC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31039D510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31039D550>]}


============================== 09:20:03.301456 | dc11face-8ab4-4a07-ae08-705310c4cee6 ==============================
[0m09:20:03.301456 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:20:03.302480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:20:03.480492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc11face-8ab4-4a07-ae08-705310c4cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A31086F990>]}
[0m09:20:03.539457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc11face-8ab4-4a07-ae08-705310c4cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30D025610>]}
[0m09:20:03.540457 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:03.776350 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:20:03.918351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:03.918351 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:20:04.283352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc11face-8ab4-4a07-ae08-705310c4cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A311CB7650>]}
[0m09:20:04.403350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:20:04.406317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:20:04.426318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc11face-8ab4-4a07-ae08-705310c4cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A311D7F3D0>]}
[0m09:20:04.427316 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:20:04.428318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc11face-8ab4-4a07-ae08-705310c4cee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A311F0FB90>]}
[0m09:20:04.429317 [info ] [MainThread]: telegram_project.marts.dim_channels
[0m09:20:04.429317 [info ] [MainThread]: telegram_project.marts.dim_dates
[0m09:20:04.430317 [info ] [MainThread]: telegram_project.marts.fct_image_detections
[0m09:20:04.430317 [info ] [MainThread]: telegram_project.marts.fct_messages
[0m09:20:04.431335 [info ] [MainThread]: telegram_project.staging.stg_image_detections
[0m09:20:04.432317 [info ] [MainThread]: telegram_project.staging.stg_telegram_messages
[0m09:20:04.432317 [info ] [MainThread]: source:telegram_project.raw.image_detections
[0m09:20:04.433317 [info ] [MainThread]: telegram_project.models.not_null_dim_channels_channel_id
[0m09:20:04.433317 [info ] [MainThread]: telegram_project.models.marts.not_null_fct_image_detections_message_id
[0m09:20:04.434317 [info ] [MainThread]: telegram_project.models.not_null_fct_messages_message_id
[0m09:20:04.435318 [info ] [MainThread]: telegram_project.models.not_null_stg_telegram_messages_message_id
[0m09:20:04.436317 [info ] [MainThread]: telegram_project.models.not_null_stg_telegram_messages_message_text
[0m09:20:04.436317 [info ] [MainThread]: telegram_project.models.unique_dim_channels_channel_id
[0m09:20:04.437316 [info ] [MainThread]: telegram_project.models.unique_fct_messages_message_id
[0m09:20:04.437316 [info ] [MainThread]: telegram_project.models.unique_stg_telegram_messages_message_id
[0m09:20:04.438319 [debug] [MainThread]: Command `dbt ls` succeeded at 09:20:04.438319 after 1.20 seconds
[0m09:20:04.439318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A309916890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3099E7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3099E7650>]}
[0m09:20:04.440342 [debug] [MainThread]: Flushing usage events
[0m09:20:05.244220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:12.069032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85F0AE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85F0DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85F0D84D0>]}


============================== 09:20:12.072811 | f9f79731-5bda-47dd-88bc-cef132d24ddc ==============================
[0m09:20:12.072811 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:20:12.073851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:20:12.253190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85F2C3150>]}
[0m09:20:12.308190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85BA75B10>]}
[0m09:20:12.309190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:12.533190 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:20:12.678157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:20:12.679157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:20:12.719197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8605AC750>]}
[0m09:20:12.795189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:20:12.798176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:20:12.820157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8604BB010>]}
[0m09:20:12.821159 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:20:12.822157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86056BED0>]}
[0m09:20:12.824155 [info ] [MainThread]: 
[0m09:20:12.824155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:12.825156 [info ] [MainThread]: 
[0m09:20:12.825156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:12.830156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:20:12.902189 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:20:12.903160 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:20:12.903160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:13.047790 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.144 seconds
[0m09:20:13.048790 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:20:13.050791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:20:13.061843 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:20:13.070820 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:20:13.071826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:13.100749 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:20:13.101748 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:20:13.101748 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:20:13.107748 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:20:13.108749 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:20:13.109748 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:20:13.114748 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.115748 [debug] [MainThread]: On master: BEGIN
[0m09:20:13.115748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:13.246414 [debug] [MainThread]: SQL status: BEGIN in 0.130 seconds
[0m09:20:13.246414 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.247452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:13.254414 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:20:13.256415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8605CEF90>]}
[0m09:20:13.257413 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:13.258414 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.258414 [debug] [MainThread]: On master: BEGIN
[0m09:20:13.259414 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:20:13.259414 [debug] [MainThread]: On master: COMMIT
[0m09:20:13.260414 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.260414 [debug] [MainThread]: On master: COMMIT
[0m09:20:13.261414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:13.261414 [debug] [MainThread]: On master: Close
[0m09:20:13.265660 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:20:13.265660 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:20:13.266684 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:20:13.267683 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:20:13.274683 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:20:13.275693 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:20:13.306682 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:20:13.307683 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:20:13.307683 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:20:13.308682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:20:13.448246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m09:20:13.448246 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:20:13.449248 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT
    CAST(detection_id AS TEXT) AS detection_id,
    file_name,
    object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:20:13.449248 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "detection_id" does not exist
LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                 ^

[0m09:20:13.450281 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: ROLLBACK
[0m09:20:13.451246 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:20:13.455245 [debug] [Thread-1 (]: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:20:13.457244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D860A20B90>]}
[0m09:20:13.458246 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_image_detections ............ [[31mERROR[0m in 0.19s]
[0m09:20:13.459007 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:20:13.460013 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:20:13.460013 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql.
[0m09:20:13.461012 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:20:13.462597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:20:13.462597 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:20:13.464603 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:20:13.465604 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:20:13.469603 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:20:13.470614 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:20:13.470614 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:20:13.471604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:13.505243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:20:13.506283 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:20:13.506283 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.telegram_messages
),

cleaned AS (
    SELECT
        CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        text,
        CAST(date AS TIMESTAMP) AS message_timestamp,
        channel_id,
        CASE WHEN media IS NOT NULL THEN TRUE ELSE FALSE END AS has_image
    FROM source
)

SELECT * FROM cleaned
  );
[0m09:20:13.507284 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "text" does not exist
LINE 15:         text,
                 ^

[0m09:20:13.508282 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:20:13.508282 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:20:13.511249 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "text" does not exist
  LINE 15:         text,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:20:13.512250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9f79731-5bda-47dd-88bc-cef132d24ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D860F5FE90>]}
[0m09:20:13.512250 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.05s]
[0m09:20:13.513281 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:20:13.514250 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "text" does not exist
  LINE 15:         text,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:20:13.515333 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:20:13.515333 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:20:13.516366 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:20:13.516366 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:20:13.517687 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:20:13.518709 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:20:13.518709 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:20:13.519709 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:20:13.520738 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:20:13.521709 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:20:13.522719 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:20:13.522719 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:20:13.524711 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.524711 [debug] [MainThread]: On master: BEGIN
[0m09:20:13.525720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:13.558709 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:20:13.559708 [debug] [MainThread]: On master: COMMIT
[0m09:20:13.559708 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:13.560708 [debug] [MainThread]: On master: COMMIT
[0m09:20:13.560708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:13.560708 [debug] [MainThread]: On master: Close
[0m09:20:13.561712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:13.562711 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:20:13.562711 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:20:13.563712 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:20:13.563712 [info ] [MainThread]: 
[0m09:20:13.564712 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m09:20:13.565710 [debug] [MainThread]: Command end result
[0m09:20:13.633744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:20:13.635739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:20:13.641737 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:20:13.642710 [info ] [MainThread]: 
[0m09:20:13.642710 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:20:13.643709 [info ] [MainThread]: 
[0m09:20:13.644709 [error] [MainThread]: [31mFailure in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)[0m
[0m09:20:13.644709 [error] [MainThread]:   Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:20:13.645709 [info ] [MainThread]: 
[0m09:20:13.646710 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:20:13.646710 [info ] [MainThread]: 
[0m09:20:13.647708 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:20:13.648709 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "text" does not exist
  LINE 15:         text,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:20:13.648709 [info ] [MainThread]: 
[0m09:20:13.649718 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:20:13.650709 [info ] [MainThread]: 
[0m09:20:13.651708 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=6
[0m09:20:13.652710 [debug] [MainThread]: Command `dbt run` failed at 09:20:13.652710 after 1.66 seconds
[0m09:20:13.652710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8583D6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85C518150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8587317D0>]}
[0m09:20:13.653715 [debug] [MainThread]: Flushing usage events
[0m09:20:14.373622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:14.852218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C90609E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C90609F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C90282FD0>]}


============================== 09:23:14.856217 | 21979f47-7161-4770-bea8-2324d6c8f52f ==============================
[0m09:23:14.856217 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:23:14.856217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:15.033251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9077F410>]}
[0m09:23:15.089248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8CFF4C50>]}
[0m09:23:15.090251 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:15.320834 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:23:15.459799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:15.460799 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:23:15.825832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C907E2DD0>]}
[0m09:23:15.942800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:23:15.944800 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:23:15.964799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C91E361D0>]}
[0m09:23:15.965800 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:23:15.965800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C91ED2750>]}
[0m09:23:15.967798 [info ] [MainThread]: 
[0m09:23:15.968799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:15.968799 [info ] [MainThread]: 
[0m09:23:15.969799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:23:15.973816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:23:16.054834 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:23:16.055832 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:23:16.055832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:16.089799 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.033 seconds
[0m09:23:16.090799 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:23:16.092799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:23:16.098801 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:23:16.098801 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:23:16.098801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:16.127833 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m09:23:16.128820 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:23:16.128820 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:23:16.134828 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:23:16.135827 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:23:16.135827 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:23:16.140828 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.141828 [debug] [MainThread]: On master: BEGIN
[0m09:23:16.141828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:16.171372 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m09:23:16.171372 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.172373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:23:16.179493 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:23:16.181494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C91DEFF90>]}
[0m09:23:16.181494 [debug] [MainThread]: On master: ROLLBACK
[0m09:23:16.182494 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.182494 [debug] [MainThread]: On master: BEGIN
[0m09:23:16.183524 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:23:16.184521 [debug] [MainThread]: On master: COMMIT
[0m09:23:16.184521 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.184521 [debug] [MainThread]: On master: COMMIT
[0m09:23:16.185521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:23:16.185521 [debug] [MainThread]: On master: Close
[0m09:23:16.189494 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:23:16.190496 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:23:16.190496 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:23:16.191496 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:23:16.198496 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:23:16.198496 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:23:16.229496 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:23:16.230496 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:23:16.230496 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:23:16.231496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:16.376084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m09:23:16.377117 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:23:16.377117 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT
    CAST(detection_id AS TEXT) AS detection_id,
    file_name,
    object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:23:16.378086 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "detection_id" does not exist
LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                 ^

[0m09:23:16.379117 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: ROLLBACK
[0m09:23:16.380084 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:23:16.385083 [debug] [Thread-1 (]: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:23:16.387083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C91EA2F50>]}
[0m09:23:16.388085 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_image_detections ............ [[31mERROR[0m in 0.19s]
[0m09:23:16.389083 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:23:16.389083 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:23:16.390085 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql.
[0m09:23:16.390085 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:23:16.392086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:23:16.392086 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:23:16.395084 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:23:16.396085 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:23:16.401085 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:23:16.403087 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:23:16.403087 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:23:16.404085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:16.436606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m09:23:16.436606 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:23:16.437593 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    SELECT
    CAST(message_id AS INTEGER) AS message_id,
    sender_id,
    message_text,  -- instead of text
    CAST(date AS TIMESTAMP) AS message_timestamp,
    channel_id,
    CASE WHEN media IS NOT NULL THEN TRUE ELSE FALSE END AS has_image
FROM source
  );
[0m09:23:16.439036 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "source" does not exist
LINE 14: FROM source
              ^

[0m09:23:16.439036 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:23:16.440043 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:23:16.443053 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  relation "source" does not exist
  LINE 14: FROM source
                ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:23:16.444043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21979f47-7161-4770-bea8-2324d6c8f52f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C921A9ED0>]}
[0m09:23:16.445043 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.05s]
[0m09:23:16.446046 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:23:16.447044 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  relation "source" does not exist
  LINE 14: FROM source
                ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:23:16.448070 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:23:16.448070 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:23:16.449056 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:23:16.450045 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:23:16.450045 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:23:16.451046 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:23:16.451046 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:23:16.452044 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:23:16.453044 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:23:16.453044 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:23:16.454044 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:23:16.455043 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:23:16.456046 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.457046 [debug] [MainThread]: On master: BEGIN
[0m09:23:16.457046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:23:16.488045 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:23:16.490069 [debug] [MainThread]: On master: COMMIT
[0m09:23:16.490069 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:16.491043 [debug] [MainThread]: On master: COMMIT
[0m09:23:16.491043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:23:16.492042 [debug] [MainThread]: On master: Close
[0m09:23:16.492042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:16.493044 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:23:16.493044 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:23:16.493044 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:23:16.494044 [info ] [MainThread]: 
[0m09:23:16.495045 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m09:23:16.496045 [debug] [MainThread]: Command end result
[0m09:23:16.520095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:23:16.523110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:23:16.529096 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:23:16.530096 [info ] [MainThread]: 
[0m09:23:16.531096 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:23:16.531096 [info ] [MainThread]: 
[0m09:23:16.532096 [error] [MainThread]: [31mFailure in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)[0m
[0m09:23:16.533097 [error] [MainThread]:   Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:23:16.533097 [info ] [MainThread]: 
[0m09:23:16.534097 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:23:16.534097 [info ] [MainThread]: 
[0m09:23:16.535097 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:23:16.536118 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  relation "source" does not exist
  LINE 14: FROM source
                ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:23:16.537100 [info ] [MainThread]: 
[0m09:23:16.538101 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:23:16.538101 [info ] [MainThread]: 
[0m09:23:16.539097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=6
[0m09:23:16.540098 [debug] [MainThread]: Command `dbt run` failed at 09:23:16.540098 after 1.75 seconds
[0m09:23:16.541097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C89916890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9068AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9068AE90>]}
[0m09:23:16.541097 [debug] [MainThread]: Flushing usage events
[0m09:23:17.442339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:27.674048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF06B38D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF06B0E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF06B0E990>]}


============================== 09:24:27.678052 | 1ede3ac1-16ec-48be-bf8d-38c91b078b3d ==============================
[0m09:24:27.678052 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:24:27.679048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:24:27.855081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF06C11610>]}
[0m09:24:27.910047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF034C4AD0>]}
[0m09:24:27.912049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:28.149077 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:24:28.308082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:28.309086 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:24:28.678050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08202350>]}
[0m09:24:28.796052 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:24:28.799050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:24:28.824048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0827C690>]}
[0m09:24:28.824048 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 433 macros
[0m09:24:28.825048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0822DB50>]}
[0m09:24:28.827048 [info ] [MainThread]: 
[0m09:24:28.828062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:28.828062 [info ] [MainThread]: 
[0m09:24:28.829050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:28.834049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:24:28.903078 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:24:28.904082 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:24:28.904082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:28.939082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.035 seconds
[0m09:24:28.940082 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:24:28.942049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:24:28.948051 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:24:28.948051 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:24:28.948051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:28.978965 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:24:28.978965 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:24:28.980003 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:24:28.985127 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:24:28.987122 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:24:28.987122 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:24:28.993087 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:28.993087 [debug] [MainThread]: On master: BEGIN
[0m09:24:28.993087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:29.025748 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:24:29.026747 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:29.026747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:29.034746 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:24:29.035747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08201FD0>]}
[0m09:24:29.036747 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:29.037417 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:29.037417 [debug] [MainThread]: On master: BEGIN
[0m09:24:29.038424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:24:29.038424 [debug] [MainThread]: On master: COMMIT
[0m09:24:29.039424 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:29.039424 [debug] [MainThread]: On master: COMMIT
[0m09:24:29.040424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:29.040424 [debug] [MainThread]: On master: Close
[0m09:24:29.044353 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:24:29.045359 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:24:29.046390 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:24:29.046390 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:24:29.053391 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:24:29.054359 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:24:29.086358 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:24:29.087359 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:24:29.087359 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:24:29.088381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:29.118389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m09:24:29.119359 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:24:29.119359 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT
    CAST(detection_id AS TEXT) AS detection_id,
    file_name,
    object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:24:29.120387 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "detection_id" does not exist
LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                 ^

[0m09:24:29.121394 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: ROLLBACK
[0m09:24:29.121394 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:24:29.126389 [debug] [Thread-1 (]: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:24:29.128359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08677990>]}
[0m09:24:29.129358 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model analytics.stg_image_detections ............ [[31mERROR[0m in 0.08s]
[0m09:24:29.130359 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:24:29.130359 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:24:29.131359 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql.
[0m09:24:29.132359 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:24:29.133359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:24:29.134359 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:24:29.135359 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:24:29.136358 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:24:29.140358 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:24:29.141358 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:24:29.141358 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:24:29.142359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:29.297401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m09:24:29.297401 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:24:29.298432 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM raw.telegram_messages
),

cleaned AS (
    SELECT
        CAST(message_id AS INTEGER) AS message_id,  
        sender_id,
        message_text AS text,  
        CAST(date AS TIMESTAMP) AS message_timestamp,
        channel_id,
        CASE WHEN media IS NOT NULL THEN TRUE ELSE FALSE END AS has_image
    FROM source
)

SELECT * FROM cleaned
  );
[0m09:24:29.299399 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 16:         CAST(date AS TIMESTAMP) AS message_timestamp,
                      ^

[0m09:24:29.299399 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:24:29.300404 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:24:29.303398 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "date" does not exist
  LINE 16:         CAST(date AS TIMESTAMP) AS message_timestamp,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:24:29.304398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ede3ac1-16ec-48be-bf8d-38c91b078b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF08647410>]}
[0m09:24:29.304398 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.17s]
[0m09:24:29.305398 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:24:29.306398 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "date" does not exist
  LINE 16:         CAST(date AS TIMESTAMP) AS message_timestamp,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:24:29.307398 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:24:29.308398 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:24:29.308398 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:24:29.309398 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:24:29.310398 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:24:29.310398 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:24:29.311412 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:24:29.312401 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:24:29.313413 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:24:29.314409 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:24:29.314409 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:24:29.315399 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:24:29.317410 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:29.317410 [debug] [MainThread]: On master: BEGIN
[0m09:24:29.318402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:29.500332 [debug] [MainThread]: SQL status: BEGIN in 0.182 seconds
[0m09:24:29.501362 [debug] [MainThread]: On master: COMMIT
[0m09:24:29.501362 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:29.502333 [debug] [MainThread]: On master: COMMIT
[0m09:24:29.503333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:29.503333 [debug] [MainThread]: On master: Close
[0m09:24:29.504371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:29.504371 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:24:29.505360 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:24:29.505360 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:24:29.506331 [info ] [MainThread]: 
[0m09:24:29.507330 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m09:24:29.508330 [debug] [MainThread]: Command end result
[0m09:24:29.532330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:24:29.536332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:24:29.543330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:24:29.543330 [info ] [MainThread]: 
[0m09:24:29.544330 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:24:29.544330 [info ] [MainThread]: 
[0m09:24:29.545330 [error] [MainThread]: [31mFailure in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)[0m
[0m09:24:29.546332 [error] [MainThread]:   Database Error in model stg_image_detections (telegram_project/models\staging\stg_image_detections.sql)
  column "detection_id" does not exist
  LINE 8:     CAST(detection_id AS TEXT) AS detection_id,
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:24:29.547330 [info ] [MainThread]: 
[0m09:24:29.547330 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_image_detections.sql
[0m09:24:29.548329 [info ] [MainThread]: 
[0m09:24:29.549330 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:24:29.549330 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "date" does not exist
  LINE 16:         CAST(date AS TIMESTAMP) AS message_timestamp,
                        ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:24:29.550330 [info ] [MainThread]: 
[0m09:24:29.551330 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:24:29.551330 [info ] [MainThread]: 
[0m09:24:29.552332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=6
[0m09:24:29.553332 [debug] [MainThread]: Command `dbt run` failed at 09:24:29.553332 after 1.94 seconds
[0m09:24:29.553332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7FD76890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF00104290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF001817D0>]}
[0m09:24:29.554332 [debug] [MainThread]: Flushing usage events
[0m09:24:30.641288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:23.876066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122A69FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122A6A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122A6A910>]}


============================== 09:32:23.880066 | 14f8d800-ccfa-4802-bb3c-b6ba58e3703d ==============================
[0m09:32:23.880066 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:32:23.881067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:32:24.067069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f8d800-ccfa-4802-bb3c-b6ba58e3703d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122CAEF10>]}
[0m09:32:24.123069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f8d800-ccfa-4802-bb3c-b6ba58e3703d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F4655D0>]}
[0m09:32:24.124068 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:24.367382 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:32:24.535382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:32:24.536383 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:32:24.536383 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_image_detections.sql
[0m09:32:24.865384 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_project.stg_telegram_messages' (telegram_project/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m09:32:24.866409 [debug] [MainThread]: Command `dbt run` failed at 09:32:24.866409 after 1.06 seconds
[0m09:32:24.867382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911BCE6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122AE3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019122AE1210>]}
[0m09:32:24.867382 [debug] [MainThread]: Flushing usage events
[0m09:32:25.772439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:43.591994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BB5A9C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BB609E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BB609E50>]}


============================== 09:32:43.595999 | 1368aeb7-2c23-4cbf-9dfb-edd1bef50142 ==============================
[0m09:32:43.595999 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:32:43.596980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:32:43.771997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1368aeb7-2c23-4cbf-9dfb-edd1bef50142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B81F2750>]}
[0m09:32:43.826001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1368aeb7-2c23-4cbf-9dfb-edd1bef50142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B7F95390>]}
[0m09:32:43.828005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:44.048007 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:32:44.188003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:32:44.188973 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:32:44.188973 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_image_detections.sql
[0m09:32:44.491006 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_project.stg_telegram_messages' (telegram_project/models\staging\stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m09:32:44.492003 [debug] [MainThread]: Command `dbt run` failed at 09:32:44.492003 after 0.96 seconds
[0m09:32:44.492987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198B4816890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BB627350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BB625090>]}
[0m09:32:44.492987 [debug] [MainThread]: Flushing usage events
[0m09:32:45.211987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:15.078093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD3019F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD307BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD3079E50>]}


============================== 09:34:15.082093 | 31b1b8b4-a662-4d07-a5df-79a4549c98b9 ==============================
[0m09:34:15.082093 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:34:15.083094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:34:15.261650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31b1b8b4-a662-4d07-a5df-79a4549c98b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD3262ED0>]}
[0m09:34:15.316650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31b1b8b4-a662-4d07-a5df-79a4549c98b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CCFA15190>]}
[0m09:34:15.318650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:15.544683 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:34:15.688650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:34:15.690650 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\schema.yml
[0m09:34:15.690650 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_image_detections.sql
[0m09:34:15.691652 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:34:15.940683 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_image_detections".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "image_detections").
  
  To fix this, change the name of one of these resources:
  - source.telegram_project.raw.image_detections (telegram_project/models\schema.yml)
  - source.telegram_project.raw.image_detections (telegram_project/models\sources.yml)
[0m09:34:15.941651 [debug] [MainThread]: Command `dbt run` failed at 09:34:15.941651 after 0.94 seconds
[0m09:34:15.942651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD304D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CCC296890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CCC574290>]}
[0m09:34:15.943651 [debug] [MainThread]: Flushing usage events
[0m09:34:16.769411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:35.427298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8100F9C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8100F82D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8100F9550>]}


============================== 09:35:35.431297 | d0ca9f3f-cd01-4507-a4d3-ba3194aedfde ==============================
[0m09:35:35.431297 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:35:35.432297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:35:35.565296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ca9f3f-cd01-4507-a4d3-ba3194aedfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81021EFD0>]}
[0m09:35:35.590298 [debug] [MainThread]: Command `dbt clean` succeeded at 09:35:35.590298 after 0.23 seconds
[0m09:35:35.591491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E809376890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80FD72FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80FE6D810>]}
[0m09:35:35.591491 [debug] [MainThread]: Flushing usage events
[0m09:35:36.419631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:48.302076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022696B2A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022696B5DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022696B5C050>]}


============================== 09:35:48.306079 | 5a9e436e-9969-4df4-bc6a-bd1bdc59706d ==============================
[0m09:35:48.306079 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:35:48.307079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:35:48.443079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a9e436e-9969-4df4-bc6a-bd1bdc59706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022696C0B250>]}
[0m09:35:48.470077 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:35:48.471076 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:35:48.472086 [debug] [MainThread]: Command `dbt deps` succeeded at 09:35:48.472086 after 0.24 seconds
[0m09:35:48.473076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022696B29B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268FDF6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268FEC7690>]}
[0m09:35:48.473076 [debug] [MainThread]: Flushing usage events
[0m09:35:49.299466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:11.832399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF13A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF198D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF199C90>]}


============================== 09:36:11.835387 | af53c51d-6ac6-44f4-89a4-ecc1fa8cc320 ==============================
[0m09:36:11.835387 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:36:11.836385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:12.019423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF19A9D0>]}
[0m09:36:12.073419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FBB25B10>]}
[0m09:36:12.074420 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:36:12.306770 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:36:12.307768 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:36:12.308768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF549C90>]}
[0m09:36:13.440767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF81D190>]}
[0m09:36:13.515768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:36:13.518776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:36:13.544735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FFA56510>]}
[0m09:36:13.545735 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:36:13.546734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FF3160D0>]}
[0m09:36:13.547735 [info ] [MainThread]: 
[0m09:36:13.548734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:36:13.549735 [info ] [MainThread]: 
[0m09:36:13.550735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:13.554741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:36:13.623769 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:36:13.623769 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:36:13.624736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:13.781309 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.157 seconds
[0m09:36:13.782308 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:36:13.785308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:36:13.790307 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:36:13.790307 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:36:13.791309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:13.822000 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:36:13.822000 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:36:13.822999 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:36:13.828821 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:36:13.829821 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:36:13.830820 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:36:13.835820 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:13.835820 [debug] [MainThread]: On master: BEGIN
[0m09:36:13.836820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:13.866760 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m09:36:13.867796 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:13.867796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:13.875588 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:36:13.876586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FFD03A10>]}
[0m09:36:13.877588 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:13.878567 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:13.878567 [debug] [MainThread]: On master: BEGIN
[0m09:36:13.879579 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:36:13.879579 [debug] [MainThread]: On master: COMMIT
[0m09:36:13.879579 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:13.880586 [debug] [MainThread]: On master: COMMIT
[0m09:36:13.880586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:13.881596 [debug] [MainThread]: On master: Close
[0m09:36:13.885006 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:36:13.886042 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:36:13.886042 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:36:13.887045 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:36:13.893046 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:36:13.896015 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:36:13.926046 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:36:13.929131 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:13.929131 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:36:13.930119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:36:14.070922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m09:36:14.070922 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:14.071921 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:36:14.086733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:36:14.092730 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:14.092730 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:36:14.094685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:36:14.098701 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:14.099701 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:36:14.099701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:14.114701 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:36:14.115703 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:14.115703 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:36:14.117531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:14.122555 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:36:14.127571 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:36:14.128538 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:36:14.132537 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:36:14.135538 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:36:14.138538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FFDE06D0>]}
[0m09:36:14.139538 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.25s]
[0m09:36:14.140537 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:36:14.140537 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:36:14.141538 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:36:14.142539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:36:14.142539 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:36:14.145537 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:36:14.146536 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:36:14.150543 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:36:14.151538 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:36:14.152538 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:36:14.152538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:14.289429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m09:36:14.289951 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:36:14.291065 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
   FROM "telegram_db"."raw"."telegram_messages"

),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        CASE
            WHEN file_name IS NOT NULL THEN TRUE
            ELSE FALSE
        END AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:36:14.291686 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "file_name" does not exist
LINE 19:             WHEN file_name IS NOT NULL THEN TRUE
                          ^

[0m09:36:14.292190 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:36:14.293288 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:36:14.297986 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "file_name" does not exist
  LINE 19:             WHEN file_name IS NOT NULL THEN TRUE
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:36:14.298502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af53c51d-6ac6-44f4-89a4-ecc1fa8cc320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0FFAA3450>]}
[0m09:36:14.299015 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.16s]
[0m09:36:14.300148 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:36:14.301173 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "file_name" does not exist
  LINE 19:             WHEN file_name IS NOT NULL THEN TRUE
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:36:14.302885 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:36:14.303391 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:36:14.304495 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:36:14.305028 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:36:14.305550 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:36:14.306064 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:36:14.307109 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:36:14.307629 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:36:14.308149 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:36:14.308675 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:36:14.309731 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:36:14.310254 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:36:14.311832 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:14.312923 [debug] [MainThread]: On master: BEGIN
[0m09:36:14.313453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:14.346003 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:36:14.347003 [debug] [MainThread]: On master: COMMIT
[0m09:36:14.347003 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:14.348002 [debug] [MainThread]: On master: COMMIT
[0m09:36:14.348002 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:14.349003 [debug] [MainThread]: On master: Close
[0m09:36:14.350001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:14.350001 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:36:14.350001 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:36:14.351002 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:36:14.351002 [info ] [MainThread]: 
[0m09:36:14.352002 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m09:36:14.353003 [debug] [MainThread]: Command end result
[0m09:36:14.376002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:36:14.378001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:36:14.384001 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:36:14.384001 [info ] [MainThread]: 
[0m09:36:14.385002 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:36:14.385002 [info ] [MainThread]: 
[0m09:36:14.386002 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:36:14.387002 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  column "file_name" does not exist
  LINE 19:             WHEN file_name IS NOT NULL THEN TRUE
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:36:14.388007 [info ] [MainThread]: 
[0m09:36:14.389006 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:36:14.390004 [info ] [MainThread]: 
[0m09:36:14.390004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m09:36:14.392004 [debug] [MainThread]: Command `dbt run` failed at 09:36:14.392004 after 2.63 seconds
[0m09:36:14.392004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0F83E6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0F8472850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0F8741790>]}
[0m09:36:14.393007 [debug] [MainThread]: Flushing usage events
[0m09:36:15.117020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:42.930279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E2669410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E269DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E26C4BD0>]}


============================== 09:40:42.934278 | 8714fda3-fa8a-40f6-9240-1a7fcdf9912c ==============================
[0m09:40:42.934278 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:40:42.935279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:40:43.112312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E27DF110>]}
[0m09:40:43.167306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DF064AD0>]}
[0m09:40:43.168307 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:40:43.397279 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:40:43.552308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:43.553328 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:40:43.785319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E38B6990>]}
[0m09:40:43.856312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:40:43.859313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:40:43.880293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E3EAEF90>]}
[0m09:40:43.881279 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:40:43.882279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E3D994D0>]}
[0m09:40:43.884279 [info ] [MainThread]: 
[0m09:40:43.884279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:43.885291 [info ] [MainThread]: 
[0m09:40:43.886279 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:40:43.890279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:40:43.999309 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:40:43.999309 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:40:44.000281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:44.035315 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.035 seconds
[0m09:40:44.036316 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:40:44.038319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:40:44.043313 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:40:44.043313 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:40:44.044295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:44.178631 [debug] [ThreadPool]: SQL status: BEGIN in 0.134 seconds
[0m09:40:44.178631 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:40:44.179658 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:40:44.185631 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:40:44.186631 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:40:44.187659 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:40:44.193664 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.193664 [debug] [MainThread]: On master: BEGIN
[0m09:40:44.194668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:44.228631 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m09:40:44.229631 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.230631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:40:44.237631 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m09:40:44.238634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E3EDCE10>]}
[0m09:40:44.239631 [debug] [MainThread]: On master: ROLLBACK
[0m09:40:44.239631 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.240631 [debug] [MainThread]: On master: BEGIN
[0m09:40:44.241641 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:40:44.241641 [debug] [MainThread]: On master: COMMIT
[0m09:40:44.242631 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.242631 [debug] [MainThread]: On master: COMMIT
[0m09:40:44.243631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:44.243631 [debug] [MainThread]: On master: Close
[0m09:40:44.248631 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:40:44.249631 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:40:44.250631 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:40:44.250631 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:40:44.257630 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:40:44.259631 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:40:44.290662 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:40:44.292632 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.292632 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:40:44.293665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:40:44.445658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m09:40:44.445658 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.446633 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:40:44.450629 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:40:44.455628 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.456628 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:40:44.457664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:40:44.460670 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.460670 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:40:44.461672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:40:44.474669 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:40:44.475670 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.475670 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:40:44.477601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:40:44.482607 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:40:44.486606 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:40:44.486606 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:40:44.488636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:40:44.490642 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:40:44.492640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E26B8110>]}
[0m09:40:44.493607 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.24s]
[0m09:40:44.494607 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:40:44.495607 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:40:44.495607 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:40:44.496606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:40:44.497607 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:40:44.499607 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:40:44.499607 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:40:44.503606 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:40:44.504607 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:40:44.505607 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:40:44.505607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:44.541607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m09:40:44.541607 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:40:44.542607 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM { { source('raw', 'telegram_messages') } }
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image -- ← temporary fix
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:40:44.543608 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 9:     FROM { { source('raw', 'telegram_messages') } }
                 ^

[0m09:40:44.543608 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: ROLLBACK
[0m09:40:44.544607 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:40:44.550607 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  syntax error at or near "{"
  LINE 9:     FROM { { source('raw', 'telegram_messages') } }
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:40:44.551606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8714fda3-fa8a-40f6-9240-1a7fcdf9912c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E4222950>]}
[0m09:40:44.551606 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model analytics.stg_telegram_messages ........... [[31mERROR[0m in 0.05s]
[0m09:40:44.552608 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:40:44.553636 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  syntax error at or near "{"
  LINE 9:     FROM { { source('raw', 'telegram_messages') } }
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql.
[0m09:40:44.555607 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:40:44.555607 [info ] [Thread-1 (]: 3 of 6 SKIP relation analytics.dim_channels .................................... [[33mSKIP[0m]
[0m09:40:44.556606 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:40:44.556606 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:40:44.557607 [info ] [Thread-1 (]: 4 of 6 SKIP relation analytics.dim_dates ....................................... [[33mSKIP[0m]
[0m09:40:44.557607 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:40:44.558607 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:40:44.559607 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:40:44.559607 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:40:44.560607 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:40:44.561608 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:40:44.561608 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:40:44.562607 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.563608 [debug] [MainThread]: On master: BEGIN
[0m09:40:44.563608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:40:44.596635 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:40:44.597609 [debug] [MainThread]: On master: COMMIT
[0m09:40:44.597609 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:44.598614 [debug] [MainThread]: On master: COMMIT
[0m09:40:44.598614 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:44.599641 [debug] [MainThread]: On master: Close
[0m09:40:44.599641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:44.600609 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:40:44.600609 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:40:44.601609 [debug] [MainThread]: Connection 'model.telegram_project.stg_telegram_messages' was properly closed.
[0m09:40:44.601609 [info ] [MainThread]: 
[0m09:40:44.602608 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m09:40:44.603608 [debug] [MainThread]: Command end result
[0m09:40:44.624641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:40:44.627608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:40:44.633609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:40:44.634608 [info ] [MainThread]: 
[0m09:40:44.635607 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:40:44.635607 [info ] [MainThread]: 
[0m09:40:44.636624 [error] [MainThread]: [31mFailure in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)[0m
[0m09:40:44.637609 [error] [MainThread]:   Database Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  syntax error at or near "{"
  LINE 9:     FROM { { source('raw', 'telegram_messages') } }
                   ^
  compiled code at target\run\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:40:44.637609 [info ] [MainThread]: 
[0m09:40:44.638607 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\staging\stg_telegram_messages.sql
[0m09:40:44.638607 [info ] [MainThread]: 
[0m09:40:44.639609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m09:40:44.640608 [debug] [MainThread]: Command `dbt run` failed at 09:40:44.640608 after 1.77 seconds
[0m09:40:44.641608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DB976890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DBC54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208DBCD1790>]}
[0m09:40:44.641608 [debug] [MainThread]: Flushing usage events
[0m09:40:45.614422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:11.985016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC361CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC361C990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3644D10>]}


============================== 09:41:11.989016 | 6210c51a-cd20-455d-8d59-466c31ecc25b ==============================
[0m09:41:11.989016 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:41:11.990016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:41:12.173018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6210c51a-cd20-455d-8d59-466c31ecc25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3832C90>]}
[0m09:41:12.227019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6210c51a-cd20-455d-8d59-466c31ecc25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBFFE4BD0>]}
[0m09:41:12.228019 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:41:12.477851 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:41:12.630823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:12.631823 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:41:12.795824 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_telegram_messages (telegram_project/models\staging\stg_telegram_messages.sql)
  unexpected '}'
    line 3
      FROM {{ source('raw', 'telegram_messages')} }
[0m09:41:12.797824 [debug] [MainThread]: Command `dbt run` failed at 09:41:12.797824 after 0.88 seconds
[0m09:41:12.797824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBC896890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC36686D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC366A7D0>]}
[0m09:41:12.798823 [debug] [MainThread]: Flushing usage events
[0m09:41:13.555350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:25.847348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7153A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7153BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE71539C90>]}


============================== 09:42:25.850349 | a3c0a208-fa12-4943-965b-82ac3f342fc5 ==============================
[0m09:42:25.850349 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:42:25.851331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:42:26.026356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE71729A10>]}
[0m09:42:26.080353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE6DF357D0>]}
[0m09:42:26.082352 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:42:26.305352 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:42:26.455321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:26.456319 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\staging\stg_telegram_messages.sql
[0m09:42:26.718319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE72C4C150>]}
[0m09:42:26.801321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:42:26.804323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:42:26.827320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE72D7F7D0>]}
[0m09:42:26.828319 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:42:26.828319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE729BF690>]}
[0m09:42:26.830319 [info ] [MainThread]: 
[0m09:42:26.831320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:42:26.831320 [info ] [MainThread]: 
[0m09:42:26.832321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:26.837320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:42:26.960632 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:42:26.961631 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:42:26.961631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:26.996206 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.035 seconds
[0m09:42:26.998178 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:42:27.000177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:42:27.006177 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:42:27.007177 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:42:27.007177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:27.152645 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m09:42:27.152645 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:42:27.153652 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:42:27.159615 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:42:27.160618 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:42:27.161620 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:42:27.166612 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.167612 [debug] [MainThread]: On master: BEGIN
[0m09:42:27.167612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:27.201754 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:42:27.201754 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.202753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:27.209037 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m09:42:27.211037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE729BFA10>]}
[0m09:42:27.211037 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:27.212036 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.212036 [debug] [MainThread]: On master: BEGIN
[0m09:42:27.213036 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:42:27.214037 [debug] [MainThread]: On master: COMMIT
[0m09:42:27.214037 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.215062 [debug] [MainThread]: On master: COMMIT
[0m09:42:27.216036 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:42:27.216036 [debug] [MainThread]: On master: Close
[0m09:42:27.220036 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:42:27.221040 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:42:27.222057 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:42:27.222057 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:42:27.230039 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:42:27.231039 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:42:27.274038 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:42:27.276039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.277040 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:42:27.277040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:42:27.312039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:42:27.312039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.313039 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:42:27.320070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:42:27.326040 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.326040 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:42:27.327039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:42:27.330039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.331040 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:42:27.331040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:42:27.346039 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:42:27.347039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.347039 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:42:27.349040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:42:27.354039 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:42:27.359039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:42:27.360040 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:42:27.361038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:42:27.363039 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:42:27.366039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE716F26D0>]}
[0m09:42:27.367047 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.14s]
[0m09:42:27.368037 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:42:27.369048 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:42:27.369048 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:42:27.370039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:42:27.370039 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:42:27.373040 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:42:27.374040 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:42:27.378039 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:42:27.378039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.379040 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:42:27.380039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:27.411038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:42:27.412038 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.412038 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:42:27.418039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:42:27.421039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.421039 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:42:27.422040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:42:27.425039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.425039 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:42:27.426039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:42:27.428039 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:42:27.429041 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.429041 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:42:27.430040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:42:27.434039 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m09:42:27.435039 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:42:27.435039 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m09:42:27.437039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:42:27.439039 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:42:27.439039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE730FFC90>]}
[0m09:42:27.440040 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.07s]
[0m09:42:27.441038 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:42:27.442037 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:42:27.443062 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m09:42:27.444041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:42:27.444041 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:42:27.447039 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:42:27.448040 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:42:27.469040 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m09:42:27.470040 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:42:27.471040 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m09:42:27.472056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:27.618260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m09:42:27.618260 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:42:27.619261 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT * FROM "telegram_db"."analytics"."stg_telegram_messages"
),

channels AS (
    SELECT
        DISTINCT channel_id
    FROM messages
)

SELECT
    channel_id,
    'Channel ' || channel_id AS channel_name
FROM channels
  );
  
[0m09:42:27.620260 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_id" does not exist
LINE 18:         DISTINCT channel_id
                          ^

[0m09:42:27.620260 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: ROLLBACK
[0m09:42:27.621260 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m09:42:27.625259 [debug] [Thread-1 (]: Database Error in model dim_channels (telegram_project/models\marts\dim_channels.sql)
  column "channel_id" does not exist
  LINE 18:         DISTINCT channel_id
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\dim_channels.sql
[0m09:42:27.626260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE730E7BD0>]}
[0m09:42:27.626260 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model analytics.dim_channels ................... [[31mERROR[0m in 0.18s]
[0m09:42:27.627338 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:42:27.628377 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:42:27.628377 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.dim_channels' to be skipped because of status 'error'.  Reason: Database Error in model dim_channels (telegram_project/models\marts\dim_channels.sql)
  column "channel_id" does not exist
  LINE 18:         DISTINCT channel_id
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\dim_channels.sql.
[0m09:42:27.629371 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m09:42:27.631345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:42:27.631345 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:42:27.634372 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:42:27.635347 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:42:27.638375 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m09:42:27.639377 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:42:27.640372 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m09:42:27.640372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:27.674052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:42:27.675059 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:42:27.676062 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m09:42:27.687058 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.011 seconds
[0m09:42:27.694059 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:42:27.694059 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:42:27.695060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:42:27.696094 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:42:27.697092 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:42:27.697092 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:42:27.698804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:42:27.700841 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m09:42:27.703844 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:42:27.703844 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m09:42:27.704812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:42:27.705844 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m09:42:27.706812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c0a208-fa12-4943-965b-82ac3f342fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE71783B50>]}
[0m09:42:27.706812 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.07s]
[0m09:42:27.708812 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:42:27.708812 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:42:27.709842 [info ] [Thread-1 (]: 5 of 6 SKIP relation analytics.fct_messages .................................... [[33mSKIP[0m]
[0m09:42:27.710811 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:42:27.711810 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:42:27.711810 [info ] [Thread-1 (]: 6 of 6 SKIP relation analytics.fct_image_detections ............................ [[33mSKIP[0m]
[0m09:42:27.712810 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:42:27.713811 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.713811 [debug] [MainThread]: On master: BEGIN
[0m09:42:27.714810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:27.747811 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:42:27.747811 [debug] [MainThread]: On master: COMMIT
[0m09:42:27.748810 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:27.748810 [debug] [MainThread]: On master: COMMIT
[0m09:42:27.749810 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:42:27.749810 [debug] [MainThread]: On master: Close
[0m09:42:27.750813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:27.750813 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:42:27.751813 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:42:27.751813 [debug] [MainThread]: Connection 'model.telegram_project.dim_dates' was properly closed.
[0m09:42:27.752811 [info ] [MainThread]: 
[0m09:42:27.753811 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:42:27.754810 [debug] [MainThread]: Command end result
[0m09:42:27.776810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:42:27.778814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:42:27.785812 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:42:27.785812 [info ] [MainThread]: 
[0m09:42:27.786811 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:42:27.787816 [info ] [MainThread]: 
[0m09:42:27.788812 [error] [MainThread]: [31mFailure in model dim_channels (telegram_project/models\marts\dim_channels.sql)[0m
[0m09:42:27.789812 [error] [MainThread]:   Database Error in model dim_channels (telegram_project/models\marts\dim_channels.sql)
  column "channel_id" does not exist
  LINE 18:         DISTINCT channel_id
                            ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\dim_channels.sql
[0m09:42:27.790830 [info ] [MainThread]: 
[0m09:42:27.791815 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\dim_channels.sql
[0m09:42:27.791815 [info ] [MainThread]: 
[0m09:42:27.792811 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=6
[0m09:42:27.793813 [debug] [MainThread]: Command `dbt run` failed at 09:42:27.793813 after 2.01 seconds
[0m09:42:27.794811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE712A32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE6A7B6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE712AD9D0>]}
[0m09:42:27.794811 [debug] [MainThread]: Flushing usage events
[0m09:42:28.987553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:57.241804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473CDFC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473CE297D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473CE29E50>]}


============================== 09:43:57.245804 | f1c6462b-145b-4042-88ca-b16502650c35 ==============================
[0m09:43:57.245804 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:43:57.246804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:43:57.420803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473D00DAD0>]}
[0m09:43:57.475831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147397B5950>]}
[0m09:43:57.477831 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:43:57.697837 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:43:57.848838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:43:57.849839 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\dim_channels.sql
[0m09:43:58.089837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473D05AA10>]}
[0m09:43:58.163835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:43:58.165843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:43:58.189837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473D1DB050>]}
[0m09:43:58.190824 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:43:58.191805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E44D8D0>]}
[0m09:43:58.193850 [info ] [MainThread]: 
[0m09:43:58.193850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:43:58.194836 [info ] [MainThread]: 
[0m09:43:58.195804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:58.199850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:43:58.309835 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:43:58.309835 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:43:58.310805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:58.344805 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m09:43:58.345804 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:43:58.347804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:43:58.352803 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:43:58.353804 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:43:58.353804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:58.488305 [debug] [ThreadPool]: SQL status: BEGIN in 0.134 seconds
[0m09:43:58.489306 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:43:58.489306 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:43:58.494305 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:43:58.495306 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:43:58.496327 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:43:58.501337 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.501337 [debug] [MainThread]: On master: BEGIN
[0m09:43:58.502305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:58.531306 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m09:43:58.531306 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.531306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:58.538304 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:43:58.539305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473CFAF710>]}
[0m09:43:58.540312 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:58.540312 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.541305 [debug] [MainThread]: On master: BEGIN
[0m09:43:58.541305 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:43:58.542305 [debug] [MainThread]: On master: COMMIT
[0m09:43:58.542305 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:58.543304 [debug] [MainThread]: On master: COMMIT
[0m09:43:58.544305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:58.544305 [debug] [MainThread]: On master: Close
[0m09:43:58.548306 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:43:58.548306 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:43:58.549305 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:43:58.550304 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:43:58.557304 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:43:58.558304 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:43:58.589341 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:43:58.590339 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.591306 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:43:58.591306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:43:58.620305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m09:43:58.620305 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.621305 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:43:58.625305 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:43:58.630304 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.631304 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:43:58.632306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.634304 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.635304 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:43:58.635304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.649305 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:43:58.650334 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.650334 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:43:58.653367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:43:58.659338 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:43:58.663339 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:43:58.664339 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:43:58.665306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:43:58.667333 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:43:58.669306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473CE2AB50>]}
[0m09:43:58.670346 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.12s]
[0m09:43:58.671305 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:43:58.672306 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:43:58.673345 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:43:58.673345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:43:58.674306 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:43:58.676304 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:43:58.677304 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:43:58.681304 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:43:58.682304 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.682304 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:43:58.683306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:58.827529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m09:43:58.827529 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.828568 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:43:58.832529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:43:58.834528 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.835528 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:43:58.836460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.838466 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.839466 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:43:58.840466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.841467 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:43:58.842467 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.842467 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:43:58.843468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:43:58.846466 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m09:43:58.847466 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:43:58.848466 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m09:43:58.849466 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:43:58.850467 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:43:58.851467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E994DD0>]}
[0m09:43:58.852466 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.18s]
[0m09:43:58.853489 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:43:58.854489 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:43:58.855468 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m09:43:58.856470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:43:58.856470 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:43:58.859466 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:43:58.860466 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:43:58.879467 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m09:43:58.880467 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:43:58.881466 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m09:43:58.881466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:58.913819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m09:43:58.913819 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:43:58.914827 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m09:43:58.920849 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m09:43:58.926819 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:43:58.927819 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:43:58.927819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:58.929820 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:43:58.929820 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:43:58.930820 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:43:58.933043 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:43:58.935850 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m09:43:58.938850 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:43:58.938850 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m09:43:58.939836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:43:58.940820 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m09:43:58.941820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E98E8D0>]}
[0m09:43:58.941820 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.09s]
[0m09:43:58.943820 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:43:58.943820 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:43:58.944847 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m09:43:58.945816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:43:58.945816 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:43:58.948847 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:43:58.949818 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:43:58.953850 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m09:43:58.954818 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:58.955851 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m09:43:58.955851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:58.990822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:43:58.990822 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:58.991820 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m09:43:58.998817 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:43:59.002817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:59.003816 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:43:59.006816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:43:59.009819 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:59.010819 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:43:59.010819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:59.012847 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:43:59.012847 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:59.013817 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:43:59.014817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:43:59.016820 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m09:43:59.017820 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:43:59.018820 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m09:43:59.021820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:43:59.022820 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m09:43:59.022820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E8CA550>]}
[0m09:43:59.023820 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.08s]
[0m09:43:59.024816 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:43:59.025817 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:43:59.026820 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m09:43:59.027820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_messages)
[0m09:43:59.027820 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:43:59.031820 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:43:59.032820 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:43:59.036819 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m09:43:59.038820 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:43:59.038820 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m09:43:59.038820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:59.069818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m09:43:59.069818 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:43:59.070820 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- SELECT
--     m.message_id,
--     c.channel_id,
--     d.date,
--     m.sender_id,
--     m.message_length,
--     m.has_image,
--     img.file_name  -- media filename from image detections, can be null if no image
-- FROM "telegram_db"."analytics"."stg_telegram_messages" AS m
-- JOIN "telegram_db"."analytics"."dim_channels" AS c ON m.channel_name = c.channel_name
-- JOIN "telegram_db"."analytics"."dim_dates" AS d ON m.message_date::date = d.date
-- LEFT JOIN "telegram_db"."analytics"."stg_image_detections" AS img ON m.message_id = img.message_id

-- dbt_project/models/marts/fct_messages.sql

with stg as (
  select * from "telegram_db"."analytics"."stg_telegram_messages"
)

select
  message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m09:43:59.080268 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.009 seconds
[0m09:43:59.083266 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:43:59.083266 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:43:59.084267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:59.086272 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:43:59.086272 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:43:59.087293 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:43:59.088267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:43:59.090266 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m09:43:59.091266 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:43:59.091266 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m09:43:59.092267 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:43:59.093267 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m09:43:59.094267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E9C8050>]}
[0m09:43:59.095281 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.07s]
[0m09:43:59.096268 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:43:59.097271 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:43:59.097271 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m09:43:59.098268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.fct_image_detections)
[0m09:43:59.099267 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:43:59.102267 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:43:59.103267 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:43:59.106267 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m09:43:59.107267 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:43:59.108271 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m09:43:59.109269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:59.141268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m09:43:59.141268 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:43:59.142268 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    SELECT
    msg.message_id,
    det.file_name,
    det.object_class,
    det.confidence_score
FROM "telegram_db"."analytics"."stg_image_detections" AS det
LEFT JOIN "telegram_db"."analytics"."fct_messages" AS msg
    ON det.file_name = msg.media_file_name
  );
  
[0m09:43:59.143268 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column msg.media_file_name does not exist
LINE 19:     ON det.file_name = msg.media_file_name
                                ^

[0m09:43:59.144268 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: ROLLBACK
[0m09:43:59.144268 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m09:43:59.151267 [debug] [Thread-1 (]: Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  column msg.media_file_name does not exist
  LINE 19:     ON det.file_name = msg.media_file_name
                                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:43:59.151267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c6462b-145b-4042-88ca-b16502650c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473E60C410>]}
[0m09:43:59.152267 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics.fct_image_detections ........... [[31mERROR[0m in 0.05s]
[0m09:43:59.153267 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:43:59.154267 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  column msg.media_file_name does not exist
  LINE 19:     ON det.file_name = msg.media_file_name
                                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql.
[0m09:43:59.156267 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.156267 [debug] [MainThread]: On master: BEGIN
[0m09:43:59.157268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:59.290269 [debug] [MainThread]: SQL status: BEGIN in 0.133 seconds
[0m09:43:59.290269 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.291299 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.292317 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.293269 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:59.293269 [debug] [MainThread]: On master: Close
[0m09:43:59.294293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:59.294293 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:43:59.295268 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:43:59.295268 [debug] [MainThread]: Connection 'model.telegram_project.fct_image_detections' was properly closed.
[0m09:43:59.296268 [info ] [MainThread]: 
[0m09:43:59.297278 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m09:43:59.299291 [debug] [MainThread]: Command end result
[0m09:43:59.323268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:43:59.325267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:43:59.333268 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:43:59.334268 [info ] [MainThread]: 
[0m09:43:59.335272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:43:59.336277 [info ] [MainThread]: 
[0m09:43:59.337268 [error] [MainThread]: [31mFailure in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)[0m
[0m09:43:59.338268 [error] [MainThread]:   Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  column msg.media_file_name does not exist
  LINE 19:     ON det.file_name = msg.media_file_name
                                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:43:59.339268 [info ] [MainThread]: 
[0m09:43:59.339268 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:43:59.340269 [info ] [MainThread]: 
[0m09:43:59.341271 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m09:43:59.342272 [debug] [MainThread]: Command `dbt run` failed at 09:43:59.342272 after 2.16 seconds
[0m09:43:59.343268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147360B6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014736142850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473978B190>]}
[0m09:43:59.344268 [debug] [MainThread]: Flushing usage events
[0m09:44:00.543682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:12.909973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024944ECA050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024944F2BB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024944F28E10>]}


============================== 09:45:12.913525 | 8da43a1d-514a-4c3f-a359-276f373f8576 ==============================
[0m09:45:12.913525 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:45:12.914560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:13.096073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024945112310>]}
[0m09:45:13.151072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249418C4C10>]}
[0m09:45:13.153073 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:45:13.376106 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:45:13.527072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:45:13.528103 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\fct_image_detections.sql
[0m09:45:13.887111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024945096590>]}
[0m09:45:14.005102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:45:14.007079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:45:14.029078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946658B90>]}
[0m09:45:14.030086 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:45:14.031073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002494675E710>]}
[0m09:45:14.032073 [info ] [MainThread]: 
[0m09:45:14.033073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:45:14.034072 [info ] [MainThread]: 
[0m09:45:14.035085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:45:14.039073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:45:14.107106 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:45:14.108107 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:45:14.108107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:14.142102 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.033 seconds
[0m09:45:14.143080 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:45:14.145105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:45:14.151072 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:45:14.151072 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:45:14.151072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:14.304490 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m09:45:14.305496 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:45:14.305496 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:45:14.311495 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m09:45:14.312532 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:45:14.313529 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:45:14.320494 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:14.321495 [debug] [MainThread]: On master: BEGIN
[0m09:45:14.321495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:14.352127 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m09:45:14.352127 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:14.353167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:45:14.360128 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:45:14.361127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002494665E890>]}
[0m09:45:14.361127 [debug] [MainThread]: On master: ROLLBACK
[0m09:45:14.362127 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:14.363128 [debug] [MainThread]: On master: BEGIN
[0m09:45:14.363128 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:45:14.364127 [debug] [MainThread]: On master: COMMIT
[0m09:45:14.364127 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:14.365126 [debug] [MainThread]: On master: COMMIT
[0m09:45:14.366134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:45:14.366134 [debug] [MainThread]: On master: Close
[0m09:45:14.371146 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:45:14.371146 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:45:14.372143 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:45:14.373151 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:45:14.380150 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:45:14.381171 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:45:14.413180 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:45:14.415167 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.415167 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:45:14.416176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:45:14.450201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:45:14.450201 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.451150 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:45:14.455183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:45:14.461179 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.461179 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:45:14.462151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.465183 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.466184 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:45:14.466184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.480183 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:45:14.481180 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.481180 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:45:14.482191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:45:14.488182 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:45:14.493183 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:45:14.494183 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:45:14.495185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:45:14.497178 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:45:14.499181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002494665C590>]}
[0m09:45:14.501150 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.13s]
[0m09:45:14.502151 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:45:14.502151 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:45:14.503182 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:45:14.504149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:45:14.504149 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:45:14.507179 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:45:14.508183 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:45:14.511178 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:45:14.512178 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.513150 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:45:14.513150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:14.548185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:45:14.548185 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.549177 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:45:14.555152 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:45:14.558181 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.558181 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:45:14.559177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.562182 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.562182 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:45:14.563182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.565186 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:45:14.565186 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.566177 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:45:14.567179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:45:14.569188 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m09:45:14.570178 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:45:14.570178 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m09:45:14.571151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:45:14.573181 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:45:14.573181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946AF3310>]}
[0m09:45:14.574170 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.07s]
[0m09:45:14.575164 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:45:14.576150 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:45:14.577149 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m09:45:14.578150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:45:14.578150 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:45:14.581149 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:45:14.582149 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:45:14.602149 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m09:45:14.603149 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.603149 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m09:45:14.604151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:14.753654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m09:45:14.753654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.754648 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m09:45:14.761623 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m09:45:14.767619 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.767619 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m09:45:14.768619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.771619 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.772619 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:45:14.773622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.774650 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:45:14.775619 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.775619 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:45:14.779345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:45:14.782350 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m09:45:14.784350 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:45:14.785350 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m09:45:14.788400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:45:14.789489 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m09:45:14.790437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946E74450>]}
[0m09:45:14.791430 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.21s]
[0m09:45:14.792407 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:45:14.793439 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:45:14.794439 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m09:45:14.795406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:45:14.795406 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:45:14.799434 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:45:14.800435 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:45:14.805406 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m09:45:14.806408 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.807411 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m09:45:14.808409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:14.842090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:45:14.843125 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.844101 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m09:45:14.851273 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:45:14.854270 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.855270 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:45:14.856163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.858169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.859169 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:45:14.860189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.861169 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:45:14.861169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.862188 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:45:14.863171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:45:14.865169 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m09:45:14.866169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:45:14.867169 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m09:45:14.870169 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:45:14.871169 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m09:45:14.871169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946EC4890>]}
[0m09:45:14.872185 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.08s]
[0m09:45:14.873171 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:45:14.874172 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:45:14.875169 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m09:45:14.876170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m09:45:14.876170 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:45:14.879169 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:45:14.880181 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:45:14.884169 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m09:45:14.884169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:45:14.885170 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m09:45:14.885170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:14.918199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:45:14.919170 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:45:14.920184 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    SELECT det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM "telegram_db"."analytics"."stg_image_detections" AS det
    LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg ON det.message_id = msg.message_id
  );
  
[0m09:45:14.921202 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text = integer
LINE 19: ...."stg_telegram_messages" AS msg ON det.message_id = msg.mess...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m09:45:14.922170 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: ROLLBACK
[0m09:45:14.922170 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m09:45:14.927169 [debug] [Thread-1 (]: Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  operator does not exist: text = integer
  LINE 19: ...."stg_telegram_messages" AS msg ON det.message_id = msg.mess...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:45:14.928170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946AF7910>]}
[0m09:45:14.928170 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model analytics.fct_image_detections ........... [[31mERROR[0m in 0.05s]
[0m09:45:14.929171 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:45:14.930170 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:45:14.930170 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  operator does not exist: text = integer
  LINE 19: ...."stg_telegram_messages" AS msg ON det.message_id = msg.mess...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql.
[0m09:45:14.931198 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m09:45:14.932170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m09:45:14.933170 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:45:14.936169 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:45:14.937169 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:45:14.941170 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m09:45:14.942170 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:14.943170 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m09:45:14.943170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:14.974169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:45:14.975170 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:14.975170 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- SELECT
--     m.message_id,
--     c.channel_id,
--     d.date,
--     m.sender_id,
--     m.message_length,
--     m.has_image,
--     img.file_name  -- media filename from image detections, can be null if no image
-- FROM "telegram_db"."analytics"."stg_telegram_messages" AS m
-- JOIN "telegram_db"."analytics"."dim_channels" AS c ON m.channel_name = c.channel_name
-- JOIN "telegram_db"."analytics"."dim_dates" AS d ON m.message_date::date = d.date
-- LEFT JOIN "telegram_db"."analytics"."stg_image_detections" AS img ON m.message_id = img.message_id

-- dbt_project/models/marts/fct_messages.sql

with stg as (
  select * from "telegram_db"."analytics"."stg_telegram_messages"
)

select
  message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m09:45:14.981199 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.005 seconds
[0m09:45:14.984169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:14.985169 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m09:45:14.985169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.989179 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:14.990181 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:45:14.991170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:45:14.993171 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:45:14.994171 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:14.994171 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:45:14.997170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:45:15.001169 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m09:45:15.002171 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:45:15.003172 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m09:45:15.005171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:45:15.007171 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m09:45:15.008170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8da43a1d-514a-4c3f-a359-276f373f8576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946F41BD0>]}
[0m09:45:15.009171 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.08s]
[0m09:45:15.010172 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:45:15.011170 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:15.012172 [debug] [MainThread]: On master: BEGIN
[0m09:45:15.012172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:15.152302 [debug] [MainThread]: SQL status: BEGIN in 0.140 seconds
[0m09:45:15.152302 [debug] [MainThread]: On master: COMMIT
[0m09:45:15.153299 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:15.153299 [debug] [MainThread]: On master: COMMIT
[0m09:45:15.154300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:45:15.154300 [debug] [MainThread]: On master: Close
[0m09:45:15.155300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:15.155300 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:45:15.156302 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:45:15.156302 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m09:45:15.157301 [info ] [MainThread]: 
[0m09:45:15.158300 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m09:45:15.160299 [debug] [MainThread]: Command end result
[0m09:45:15.182301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:45:15.185299 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:45:15.193298 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:45:15.193298 [info ] [MainThread]: 
[0m09:45:15.194315 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:45:15.195299 [info ] [MainThread]: 
[0m09:45:15.195299 [error] [MainThread]: [31mFailure in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)[0m
[0m09:45:15.196301 [error] [MainThread]:   Database Error in model fct_image_detections (telegram_project/models\marts\fct_image_detections.sql)
  operator does not exist: text = integer
  LINE 19: ...."stg_telegram_messages" AS msg ON det.message_id = msg.mess...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:45:15.197327 [info ] [MainThread]: 
[0m09:45:15.199305 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_image_detections.sql
[0m09:45:15.199305 [info ] [MainThread]: 
[0m09:45:15.200314 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m09:45:15.202302 [debug] [MainThread]: Command `dbt run` failed at 09:45:15.202302 after 2.36 seconds
[0m09:45:15.202302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493E1E6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493E541790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024946102E90>]}
[0m09:45:15.203301 [debug] [MainThread]: Flushing usage events
[0m09:45:16.257523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:57.074498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE26BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE2C9DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE2CB810>]}


============================== 09:46:57.078495 | c48822de-a891-4b86-a73d-8292603e65de ==============================
[0m09:46:57.078495 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:46:57.079496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:57.272180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE4AF4D0>]}
[0m09:46:57.328180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BAC657D0>]}
[0m09:46:57.329180 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:46:57.551178 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:46:57.700868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:57.701871 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\fct_image_detections.sql
[0m09:46:58.069867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BF9B4C10>]}
[0m09:46:58.188897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:46:58.190871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:46:58.212125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BFBADE50>]}
[0m09:46:58.213126 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:46:58.214128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BFAB67D0>]}
[0m09:46:58.216128 [info ] [MainThread]: 
[0m09:46:58.216388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:46:58.216388 [info ] [MainThread]: 
[0m09:46:58.217395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:58.221686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:46:58.291096 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:46:58.291096 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:46:58.292065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:58.326064 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m09:46:58.327062 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:46:58.329064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:46:58.335062 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:46:58.335062 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:46:58.335062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:58.504856 [debug] [ThreadPool]: SQL status: BEGIN in 0.169 seconds
[0m09:46:58.504856 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:46:58.505858 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:46:58.514881 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m09:46:58.515880 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:46:58.516747 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:46:58.521785 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:58.521785 [debug] [MainThread]: On master: BEGIN
[0m09:46:58.522766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:58.554754 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:46:58.555786 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:58.555786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:58.563754 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m09:46:58.564752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BFE1A010>]}
[0m09:46:58.564752 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:58.565753 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:58.565753 [debug] [MainThread]: On master: BEGIN
[0m09:46:58.566754 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:46:58.566754 [debug] [MainThread]: On master: COMMIT
[0m09:46:58.567755 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:58.567755 [debug] [MainThread]: On master: COMMIT
[0m09:46:58.568766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:58.568766 [debug] [MainThread]: On master: Close
[0m09:46:58.572754 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:46:58.573754 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:46:58.574759 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:46:58.574759 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:46:58.581752 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:46:58.582752 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:46:58.614792 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:46:58.615756 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.615756 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:46:58.616789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:46:58.649930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:46:58.649930 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.650928 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:46:58.654931 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:46:58.660928 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.660928 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:46:58.661929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:58.664928 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.664928 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:46:58.665928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:58.679957 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:46:58.679957 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.680958 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:46:58.682178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:58.687183 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:46:58.692183 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:46:58.693184 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:46:58.694749 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:46:58.696786 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:46:58.698755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE269A50>]}
[0m09:46:58.699760 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.12s]
[0m09:46:58.700755 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:46:58.701755 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:46:58.701755 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:46:58.702803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:46:58.703757 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:46:58.705788 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:46:58.706789 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:46:58.710791 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:46:58.711771 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.711771 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:46:58.712788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:58.868306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m09:46:58.869346 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.869346 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:46:58.875679 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:46:58.878656 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.879654 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:46:58.880624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:58.882656 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.883626 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:46:58.884623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:58.885656 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:46:58.886653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.886653 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:46:58.888384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:58.890389 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m09:46:58.891389 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:46:58.891389 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m09:46:58.893392 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:46:58.894389 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:46:58.895390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BFDEA590>]}
[0m09:46:58.896397 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.19s]
[0m09:46:58.897393 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:46:58.899390 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:46:58.899390 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m09:46:58.900390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:46:58.901390 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:46:58.903389 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:46:58.904389 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:46:58.926390 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m09:46:58.927401 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.928406 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m09:46:58.928406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:58.961390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:46:58.962390 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.962390 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m09:46:58.969425 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m09:46:58.976424 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.977422 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m09:46:58.978390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:58.980389 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.981390 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:46:58.982392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:58.983420 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:46:58.984421 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.984421 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:46:58.987397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:46:58.990424 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m09:46:58.992424 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:46:58.993425 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m09:46:58.996390 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:46:58.997390 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m09:46:58.998390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C0241290>]}
[0m09:46:58.998390 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.10s]
[0m09:46:58.999390 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:46:59.000390 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:46:59.001390 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m09:46:59.002394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:46:59.002394 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:46:59.006390 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:46:59.007390 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:46:59.010390 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m09:46:59.011389 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.012390 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m09:46:59.012390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:59.152467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.140 seconds
[0m09:46:59.153466 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.153466 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m09:46:59.160471 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m09:46:59.164471 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.164471 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:46:59.165441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:59.168467 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.168467 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:46:59.169456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:59.172467 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:46:59.173467 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.173467 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:46:59.175471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:59.178471 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m09:46:59.179447 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:46:59.179447 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m09:46:59.182467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:46:59.184472 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m09:46:59.185441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C0267510>]}
[0m09:46:59.185441 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.18s]
[0m09:46:59.187441 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:46:59.188458 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:46:59.189439 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m09:46:59.190444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m09:46:59.190444 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:46:59.194438 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:46:59.195470 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:46:59.199467 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m09:46:59.201439 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:46:59.201439 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m09:46:59.202473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:59.340509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m09:46:59.341036 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:46:59.341560 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    SELECT det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM "telegram_db"."analytics"."stg_image_detections" AS det
    LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m09:46:59.350480 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.008 seconds
[0m09:46:59.354134 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:46:59.354654 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m09:46:59.355694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:59.357273 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m09:46:59.357792 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:46:59.358324 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m09:46:59.360642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:46:59.363651 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m09:46:59.364650 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:46:59.365650 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m09:46:59.365650 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:46:59.367650 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m09:46:59.368651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BFE96AD0>]}
[0m09:46:59.369657 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.18s]
[0m09:46:59.370650 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:46:59.370650 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:46:59.371671 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m09:46:59.372651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m09:46:59.372651 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:46:59.376651 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:46:59.378843 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:46:59.383852 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m09:46:59.385850 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.385850 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m09:46:59.386852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:59.420881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m09:46:59.421863 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.422853 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- SELECT
--     m.message_id,
--     c.channel_id,
--     d.date,
--     m.sender_id,
--     m.message_length,
--     m.has_image,
--     img.file_name  -- media filename from image detections, can be null if no image
-- FROM "telegram_db"."analytics"."stg_telegram_messages" AS m
-- JOIN "telegram_db"."analytics"."dim_channels" AS c ON m.channel_name = c.channel_name
-- JOIN "telegram_db"."analytics"."dim_dates" AS d ON m.message_date::date = d.date
-- LEFT JOIN "telegram_db"."analytics"."stg_image_detections" AS img ON m.message_id = img.message_id

-- dbt_project/models/marts/fct_messages.sql

with stg as (
  select * from "telegram_db"."analytics"."stg_telegram_messages"
)

select
  message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m09:46:59.430851 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.007 seconds
[0m09:46:59.435850 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.435850 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m09:46:59.436851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:59.440852 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.440852 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:46:59.442851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:59.444850 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:46:59.444850 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.445851 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:46:59.446873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:59.449852 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m09:46:59.451851 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:46:59.451851 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m09:46:59.454851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:46:59.455851 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m09:46:59.456851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48822de-a891-4b86-a73d-8292603e65de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C027B390>]}
[0m09:46:59.457852 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.08s]
[0m09:46:59.459870 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:46:59.460850 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:59.460850 [debug] [MainThread]: On master: BEGIN
[0m09:46:59.461856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:59.490850 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m09:46:59.491851 [debug] [MainThread]: On master: COMMIT
[0m09:46:59.492852 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:59.492852 [debug] [MainThread]: On master: COMMIT
[0m09:46:59.493851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:59.493851 [debug] [MainThread]: On master: Close
[0m09:46:59.494851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:59.494851 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:46:59.495851 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:46:59.495851 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m09:46:59.496850 [info ] [MainThread]: 
[0m09:46:59.496850 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m09:46:59.498850 [debug] [MainThread]: Command end result
[0m09:46:59.519851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:46:59.522854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:46:59.528851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:46:59.528851 [info ] [MainThread]: 
[0m09:46:59.529851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:59.530850 [info ] [MainThread]: 
[0m09:46:59.531851 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m09:46:59.532852 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:59.532852 after 2.52 seconds
[0m09:46:59.532852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235BE2E1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B7566890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B78C17D0>]}
[0m09:46:59.533850 [debug] [MainThread]: Flushing usage events
[0m09:47:00.474519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:38.644583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B078701350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0786CBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B078701DD0>]}


============================== 09:47:38.648570 | 89316682-6a26-4554-9f96-d5b9b7576605 ==============================
[0m09:47:38.648570 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:47:38.649570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m09:47:38.831569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0788AE990>]}
[0m09:47:38.886569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0750C5810>]}
[0m09:47:38.888569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:47:39.118570 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:47:39.264571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:39.265572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:39.306573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B079C0B0D0>]}
[0m09:47:39.383572 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:47:39.385573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:47:39.420570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B079E57E50>]}
[0m09:47:39.421571 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:47:39.422570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B078B06D50>]}
[0m09:47:39.424570 [info ] [MainThread]: 
[0m09:47:39.424570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:47:39.425572 [info ] [MainThread]: 
[0m09:47:39.426571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:47:39.430604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:47:39.501603 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:47:39.501603 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:47:39.501603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:39.541583 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m09:47:39.542604 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:47:39.542604 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:47:39.547570 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m09:47:39.549570 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:47:39.549570 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:47:39.555573 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.555573 [debug] [MainThread]: On master: BEGIN
[0m09:47:39.556573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:39.591823 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m09:47:39.591823 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.592823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:47:39.599158 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:47:39.600160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89316682-6a26-4554-9f96-d5b9b7576605', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B079B1B650>]}
[0m09:47:39.601159 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:39.601159 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.602159 [debug] [MainThread]: On master: BEGIN
[0m09:47:39.602159 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:47:39.603160 [debug] [MainThread]: On master: COMMIT
[0m09:47:39.603160 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.604159 [debug] [MainThread]: On master: COMMIT
[0m09:47:39.604159 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:47:39.605159 [debug] [MainThread]: On master: Close
[0m09:47:39.608491 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:47:39.608491 [info ] [Thread-1 (]: 1 of 1 START test not_null_fct_image_detections_message_id ..................... [RUN]
[0m09:47:39.609498 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8'
[0m09:47:39.610527 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:47:39.624526 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:47:39.626500 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:47:39.643498 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:47:39.644498 [debug] [Thread-1 (]: Using postgres connection "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:47:39.645501 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m09:47:39.645501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:47:39.674774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m09:47:39.675779 [debug] [Thread-1 (]: Using postgres connection "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:47:39.675779 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "telegram_db"."analytics"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:47:39.678774 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:47:39.682776 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m09:47:39.683776 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m09:47:39.683776 [error] [Thread-1 (]: 1 of 1 FAIL 1464 not_null_fct_image_detections_message_id ...................... [[31mFAIL 1464[0m in 0.07s]
[0m09:47:39.684773 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:47:39.686774 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.686774 [debug] [MainThread]: On master: BEGIN
[0m09:47:39.686774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:39.718913 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:47:39.719435 [debug] [MainThread]: On master: COMMIT
[0m09:47:39.719953 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:39.720473 [debug] [MainThread]: On master: COMMIT
[0m09:47:39.720993 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:47:39.721517 [debug] [MainThread]: On master: Close
[0m09:47:39.722041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:39.722562 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:47:39.723132 [debug] [MainThread]: Connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8' was properly closed.
[0m09:47:39.723638 [info ] [MainThread]: 
[0m09:47:39.724333 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m09:47:39.725360 [debug] [MainThread]: Command end result
[0m09:47:39.797071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:47:39.799042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:47:39.806678 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:47:39.806678 [info ] [MainThread]: 
[0m09:47:39.807679 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:47:39.808679 [info ] [MainThread]: 
[0m09:47:39.808679 [error] [MainThread]: [31mFailure in test not_null_fct_image_detections_message_id (telegram_project/models\marts\schema.yml)[0m
[0m09:47:39.809678 [error] [MainThread]:   Got 1464 results, configured to fail if != 0
[0m09:47:39.809678 [info ] [MainThread]: 
[0m09:47:39.810679 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\schema.yml\not_null_fct_image_detections_message_id.sql
[0m09:47:39.811679 [info ] [MainThread]: 
[0m09:47:39.811679 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:47:39.812678 [debug] [MainThread]: Command `dbt test` failed at 09:47:39.812678 after 1.23 seconds
[0m09:47:39.813678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B071956890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0719E2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0750C8C10>]}
[0m09:47:39.813678 [debug] [MainThread]: Flushing usage events
[0m09:47:40.533223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:54.088771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20D9ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20E09C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20E08DD0>]}


============================== 09:51:54.092771 | 8d3eadbc-b463-476d-b176-afb2bdb9a88d ==============================
[0m09:51:54.092771 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:51:54.093771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:51:54.271770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20FF2690>]}
[0m09:51:54.326771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1D795B10>]}
[0m09:51:54.327770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:51:54.546771 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:51:54.687770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:54.688770 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\fct_image_detections.sql
[0m09:51:55.044770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD210251D0>]}
[0m09:51:55.159770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:51:55.162772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:51:55.183771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD22582210>]}
[0m09:51:55.183771 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:51:55.184770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD22642510>]}
[0m09:51:55.186771 [info ] [MainThread]: 
[0m09:51:55.187784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:55.187784 [info ] [MainThread]: 
[0m09:51:55.188771 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:55.192771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m09:51:55.266804 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m09:51:55.266804 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m09:51:55.267811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:55.304772 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.037 seconds
[0m09:51:55.305773 [debug] [ThreadPool]: On list_telegram_db: Close
[0m09:51:55.307772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:51:55.314327 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:51:55.314834 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:51:55.315890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:55.459577 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m09:51:55.459577 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:51:55.460578 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:51:55.465577 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m09:51:55.466578 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:51:55.467577 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:51:55.473576 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.474576 [debug] [MainThread]: On master: BEGIN
[0m09:51:55.474576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:55.615338 [debug] [MainThread]: SQL status: BEGIN in 0.141 seconds
[0m09:51:55.616338 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.616338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:55.623338 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m09:51:55.625337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2265D590>]}
[0m09:51:55.625337 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:55.626337 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.626337 [debug] [MainThread]: On master: BEGIN
[0m09:51:55.627337 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:51:55.628347 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.628347 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.629339 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.629339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:55.630337 [debug] [MainThread]: On master: Close
[0m09:51:55.634337 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:51:55.635339 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m09:51:55.636355 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:51:55.637369 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:51:55.644367 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:51:55.645367 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:51:55.678366 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m09:51:55.680338 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.680338 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m09:51:55.681337 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:51:55.715339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:51:55.715339 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.716337 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m09:51:55.720337 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:51:55.727338 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.728336 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m09:51:55.729338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:55.732340 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.733394 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m09:51:55.734401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:55.749401 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:51:55.750406 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.750406 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m09:51:55.752309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:51:55.760316 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m09:51:55.765314 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m09:51:55.765314 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m09:51:55.767316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:51:55.769315 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m09:51:55.772318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD224CBBD0>]}
[0m09:51:55.772318 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.13s]
[0m09:51:55.774325 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:51:55.775321 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:51:55.776317 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m09:51:55.776317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:51:55.777316 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:51:55.780316 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:51:55.781317 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:51:55.785315 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m09:51:55.786315 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.787316 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m09:51:55.787316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.820317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:51:55.821315 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.821315 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m09:51:55.827317 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:51:55.831316 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.832315 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:51:55.833316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:55.835315 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.836315 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:51:55.837319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:55.839316 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:51:55.839316 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.840315 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m09:51:55.841317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:51:55.844316 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m09:51:55.845316 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m09:51:55.845316 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m09:51:55.846316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:51:55.848316 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m09:51:55.848316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2292CCD0>]}
[0m09:51:55.849334 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.07s]
[0m09:51:55.851317 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:51:55.852317 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:51:55.852317 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m09:51:55.853315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:51:55.854316 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:51:55.856315 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:51:55.857317 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:51:55.878320 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m09:51:55.879320 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:55.880318 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m09:51:55.880318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:56.045256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m09:51:56.046257 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:56.046257 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m09:51:56.054257 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m09:51:56.061257 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:56.061257 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m09:51:56.062255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.066257 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:56.066257 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:51:56.067226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.069255 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:51:56.070257 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:56.070257 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m09:51:56.073258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:51:56.075264 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m09:51:56.078263 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m09:51:56.080413 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m09:51:56.083260 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:51:56.085255 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m09:51:56.086228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD22D8E710>]}
[0m09:51:56.087227 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.23s]
[0m09:51:56.088226 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:51:56.089229 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:51:56.090224 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m09:51:56.091236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:51:56.091236 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:51:56.096224 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:51:56.097223 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:51:56.101224 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m09:51:56.102224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.103224 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m09:51:56.103224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:56.246225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m09:51:56.246225 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.247260 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m09:51:56.255237 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m09:51:56.258224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.259231 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:51:56.260226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.263226 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.263226 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:51:56.264227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.266238 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:51:56.267224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.267224 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m09:51:56.270224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:51:56.273224 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m09:51:56.274224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m09:51:56.274224 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m09:51:56.277255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:51:56.279262 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m09:51:56.280223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD22D8F050>]}
[0m09:51:56.281244 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.19s]
[0m09:51:56.282240 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:51:56.283242 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:51:56.284238 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m09:51:56.285224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m09:51:56.285224 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:51:56.289255 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:51:56.290256 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:51:56.294224 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m09:51:56.295258 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.296228 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m09:51:56.296228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:56.332224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m09:51:56.333224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.333224 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m09:51:56.343225 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m09:51:56.347224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.348227 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m09:51:56.348227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.352225 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.352225 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m09:51:56.353224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.355223 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m09:51:56.355223 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.356225 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m09:51:56.357225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:51:56.360241 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m09:51:56.361225 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m09:51:56.361225 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m09:51:56.366224 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:51:56.367223 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m09:51:56.368225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD222075D0>]}
[0m09:51:56.369224 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 0[0m in 0.08s]
[0m09:51:56.370227 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:51:56.370227 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:51:56.371224 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m09:51:56.372229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m09:51:56.373224 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:51:56.376224 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:51:56.378228 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:51:56.384230 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m09:51:56.386244 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.386244 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m09:51:56.387257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:56.420225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m09:51:56.421261 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.422285 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- SELECT
--     m.message_id,
--     c.channel_id,
--     d.date,
--     m.sender_id,
--     m.message_length,
--     m.has_image,
--     img.file_name  -- media filename from image detections, can be null if no image
-- FROM "telegram_db"."analytics"."stg_telegram_messages" AS m
-- JOIN "telegram_db"."analytics"."dim_channels" AS c ON m.channel_name = c.channel_name
-- JOIN "telegram_db"."analytics"."dim_dates" AS d ON m.message_date::date = d.date
-- LEFT JOIN "telegram_db"."analytics"."stg_image_detections" AS img ON m.message_id = img.message_id

-- dbt_project/models/marts/fct_messages.sql

with stg as (
  select * from "telegram_db"."analytics"."stg_telegram_messages"
)

select
  message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m09:51:56.429224 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.007 seconds
[0m09:51:56.432224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.433223 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m09:51:56.434224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.437252 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.437252 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:51:56.438232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:51:56.440224 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:51:56.440224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.441226 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m09:51:56.442226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:51:56.444252 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m09:51:56.445252 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m09:51:56.446252 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m09:51:56.448253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:51:56.449252 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m09:51:56.450256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d3eadbc-b463-476d-b176-afb2bdb9a88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD22DB13D0>]}
[0m09:51:56.451257 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.08s]
[0m09:51:56.452227 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:51:56.453225 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:56.454240 [debug] [MainThread]: On master: BEGIN
[0m09:51:56.454240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:56.619057 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m09:51:56.619057 [debug] [MainThread]: On master: COMMIT
[0m09:51:56.620088 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:56.620088 [debug] [MainThread]: On master: COMMIT
[0m09:51:56.621086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:56.621086 [debug] [MainThread]: On master: Close
[0m09:51:56.622087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:56.623058 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m09:51:56.623058 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:51:56.623058 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m09:51:56.624057 [info ] [MainThread]: 
[0m09:51:56.625056 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m09:51:56.626535 [debug] [MainThread]: Command end result
[0m09:51:56.646525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:51:56.649506 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:51:56.656538 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:51:56.657536 [info ] [MainThread]: 
[0m09:51:56.657536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:56.658506 [info ] [MainThread]: 
[0m09:51:56.659506 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m09:51:56.661539 [debug] [MainThread]: Command `dbt run` succeeded at 09:51:56.661539 after 2.64 seconds
[0m09:51:56.662550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1A026890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD1A0F7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2289F350>]}
[0m09:51:56.662550 [debug] [MainThread]: Flushing usage events
[0m09:51:57.826157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:03.496026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB148A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB14EE250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB14EEA50>]}


============================== 09:52:03.499024 | 0820997f-348e-435f-8b60-bee878ec9800 ==============================
[0m09:52:03.499024 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:52:03.500023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:03.677059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB16AFFD0>]}
[0m09:52:03.732051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBADE85510>]}
[0m09:52:03.734071 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:03.966450 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:52:04.112417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:04.112417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:04.159447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB29CE8D0>]}
[0m09:52:04.233421 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:52:04.235449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:52:04.265417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB2C17FD0>]}
[0m09:52:04.266416 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:52:04.267418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB28A0950>]}
[0m09:52:04.268416 [info ] [MainThread]: 
[0m09:52:04.269415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:04.269415 [info ] [MainThread]: 
[0m09:52:04.270416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:04.275434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:52:04.348450 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:52:04.348450 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:52:04.349432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:04.383447 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m09:52:04.383447 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:52:04.383447 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:52:04.390449 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m09:52:04.391418 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:52:04.392464 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:52:04.397449 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.397449 [debug] [MainThread]: On master: BEGIN
[0m09:52:04.398450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:04.433246 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m09:52:04.433246 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.434245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:04.440891 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m09:52:04.442893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0820997f-348e-435f-8b60-bee878ec9800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB2C17290>]}
[0m09:52:04.442893 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:04.443879 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.443879 [debug] [MainThread]: On master: BEGIN
[0m09:52:04.444861 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:04.444861 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.444861 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.445859 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.445859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:04.446860 [debug] [MainThread]: On master: Close
[0m09:52:04.450891 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:52:04.450891 [info ] [Thread-1 (]: 1 of 1 START test not_null_fct_image_detections_message_id ..................... [RUN]
[0m09:52:04.451887 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8'
[0m09:52:04.452860 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:52:04.465887 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:52:04.466888 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:52:04.483897 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:52:04.484860 [debug] [Thread-1 (]: Using postgres connection "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:52:04.485860 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m09:52:04.485860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:04.619602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.134 seconds
[0m09:52:04.620632 [debug] [Thread-1 (]: Using postgres connection "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:52:04.620632 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "telegram_db"."analytics"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:52:04.622600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.625601 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m09:52:04.626603 [debug] [Thread-1 (]: On test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m09:52:04.627602 [info ] [Thread-1 (]: 1 of 1 PASS not_null_fct_image_detections_message_id ........................... [[32mPASS[0m in 0.18s]
[0m09:52:04.628603 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:52:04.630602 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.630602 [debug] [MainThread]: On master: BEGIN
[0m09:52:04.631601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:04.662601 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m09:52:04.662601 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.663601 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.663601 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.664602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:04.664602 [debug] [MainThread]: On master: Close
[0m09:52:04.665601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:04.665601 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:52:04.666601 [debug] [MainThread]: Connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8' was properly closed.
[0m09:52:04.666601 [info ] [MainThread]: 
[0m09:52:04.667601 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m09:52:04.668602 [debug] [MainThread]: Command end result
[0m09:52:04.735605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:52:04.737604 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:52:04.743604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:52:04.744604 [info ] [MainThread]: 
[0m09:52:04.744604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:04.745608 [info ] [MainThread]: 
[0m09:52:04.746602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:52:04.747630 [debug] [MainThread]: Command `dbt test` succeeded at 09:52:04.746602 after 1.32 seconds
[0m09:52:04.747630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAA756890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAA46910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAA827650>]}
[0m09:52:04.748633 [debug] [MainThread]: Flushing usage events
[0m09:52:05.540943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:06.501601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F838259150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F838259350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F838259250>]}


============================== 09:53:06.505601 | 73ba334f-41a7-411e-8742-faa279b7169e ==============================
[0m09:53:06.505601 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:53:06.506603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:53:06.692634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8384A3D10>]}
[0m09:53:06.749629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F834C55B10>]}
[0m09:53:06.750630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:06.972602 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m09:53:07.121602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:07.121602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:07.164604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8397D49D0>]}
[0m09:53:07.192602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8398D56D0>]}
[0m09:53:07.192602 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m09:53:07.193602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8397D43D0>]}
[0m09:53:07.195601 [info ] [MainThread]: 
[0m09:53:07.195601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:07.196602 [info ] [MainThread]: 
[0m09:53:07.197602 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:07.201602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m09:53:07.278604 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:53:07.279604 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m09:53:07.279604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:07.313611 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m09:53:07.313611 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m09:53:07.314622 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:53:07.319630 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m09:53:07.320638 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m09:53:07.321631 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m09:53:07.326630 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:07.327630 [debug] [MainThread]: On master: BEGIN
[0m09:53:07.327630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:07.473349 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m09:53:07.473349 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:07.474344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:07.481344 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m09:53:07.483344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ba334f-41a7-411e-8742-faa279b7169e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F837A38710>]}
[0m09:53:07.484344 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:07.484344 [debug] [MainThread]: On master: Close
[0m09:53:07.488345 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m09:53:07.489346 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m09:53:07.489346 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m09:53:07.496344 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m09:53:07.497345 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m09:53:07.498345 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m09:53:07.499351 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m09:53:07.499351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m09:53:07.500345 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m09:53:07.502344 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m09:53:07.503344 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m09:53:07.504345 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m09:53:07.505651 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m09:53:07.505651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m09:53:07.506696 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m09:53:07.508692 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m09:53:07.509694 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m09:53:07.510688 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m09:53:07.511674 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m09:53:07.511674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m09:53:07.512692 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m09:53:07.514698 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m09:53:07.515691 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m09:53:07.516659 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m09:53:07.517659 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m09:53:07.518158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m09:53:07.518158 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m09:53:07.521185 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m09:53:07.522218 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m09:53:07.523187 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m09:53:07.524195 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m09:53:07.524195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m09:53:07.525217 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m09:53:07.528218 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m09:53:07.529196 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m09:53:07.530186 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m09:53:07.530186 [debug] [Thread-1 (]: Began running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:53:07.531186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m09:53:07.531186 [debug] [Thread-1 (]: Began compiling node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:53:07.541218 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m09:53:07.542187 [debug] [Thread-1 (]: Began executing node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:53:07.543186 [debug] [Thread-1 (]: Finished running node test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8
[0m09:53:07.545185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:07.545185 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m09:53:07.546195 [debug] [MainThread]: Connection 'test.telegram_project.not_null_fct_image_detections_message_id.fccdbca0c8' was properly closed.
[0m09:53:07.548214 [debug] [MainThread]: Command end result
[0m09:53:07.621218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:53:07.624187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:53:07.630186 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m09:53:07.938368 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m09:53:07.939365 [info ] [MainThread]: Building catalog
[0m09:53:07.948352 [debug] [ThreadPool]: Acquiring new postgres connection 'telegram_db.information_schema'
[0m09:53:07.955352 [debug] [ThreadPool]: Using postgres connection "telegram_db.information_schema"
[0m09:53:07.955352 [debug] [ThreadPool]: On telegram_db.information_schema: BEGIN
[0m09:53:07.956354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:08.093381 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m09:53:08.094381 [debug] [ThreadPool]: Using postgres connection "telegram_db.information_schema"
[0m09:53:08.095370 [debug] [ThreadPool]: On telegram_db.information_schema: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "telegram_db.information_schema"} */

    
    

    select
        'telegram_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('fct_image_detections')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('stg_image_detections')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('image_detections')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('dim_dates')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m09:53:08.109370 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.014 seconds
[0m09:53:08.114356 [debug] [ThreadPool]: On telegram_db.information_schema: ROLLBACK
[0m09:53:08.115353 [debug] [ThreadPool]: On telegram_db.information_schema: Close
[0m09:53:08.130353 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\catalog.json
[0m09:53:08.198377 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m09:53:08.200353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m09:53:08.201357 [info ] [MainThread]: Catalog written to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\catalog.json
[0m09:53:08.202354 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:53:08.202354 after 1.77 seconds
[0m09:53:08.203354 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:53:08.204353 [debug] [MainThread]: Connection 'telegram_db.information_schema' was properly closed.
[0m09:53:08.204353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8394916D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8315E7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F836CF5950>]}
[0m09:53:08.205353 [debug] [MainThread]: Flushing usage events
[0m09:53:09.074950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:19.763280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0AAF9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0AB2DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0AB2D910>]}


============================== 09:53:19.767265 | 7c2a313d-3665-48b3-8f02-6ea9172269f1 ==============================
[0m09:53:19.767265 [info ] [MainThread]: Running with dbt=1.10.3
[0m09:53:19.768265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:53:19.944268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c2a313d-3665-48b3-8f02-6ea9172269f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0AD27C50>]}
[0m09:53:19.998264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c2a313d-3665-48b3-8f02-6ea9172269f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D074F5C10>]}
[0m15:37:55.809878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019956EF2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019957063D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019957063E50>]}


============================== 15:37:55.815879 | 4d8a09f8-274b-4011-b374-55ef864f4c22 ==============================
[0m15:37:55.815879 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:37:55.816877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:37:56.102874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995717B250>]}
[0m15:37:56.179876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199539F5F10>]}
[0m15:37:56.181876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:56.581905 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:37:57.791287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:57.792283 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\fct_messages.sql
[0m15:37:58.066253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019958279290>]}
[0m15:37:58.153252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:37:58.158252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:37:58.199255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995841F690>]}
[0m15:37:58.200256 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m15:37:58.201254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199586EED50>]}
[0m15:37:58.203254 [info ] [MainThread]: 
[0m15:37:58.204255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:58.204255 [info ] [MainThread]: 
[0m15:37:58.205255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:58.209251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:38:01.292528 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:38:01.293533 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:38:01.293533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:01.335533 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m15:38:01.337527 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:38:01.338527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m15:38:01.344528 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:38:01.345527 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m15:38:01.345527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:01.380528 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:38:01.381531 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:38:01.382529 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:38:01.390532 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m15:38:01.392529 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m15:38:01.392529 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m15:38:01.398531 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:01.399530 [debug] [MainThread]: On master: BEGIN
[0m15:38:01.400529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:01.432528 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m15:38:01.433528 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:01.433528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:38:01.443528 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m15:38:01.445527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995867D390>]}
[0m15:38:01.446530 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:01.447530 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:01.447530 [debug] [MainThread]: On master: BEGIN
[0m15:38:01.448528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:38:01.448528 [debug] [MainThread]: On master: COMMIT
[0m15:38:01.449529 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:01.449529 [debug] [MainThread]: On master: COMMIT
[0m15:38:01.450528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:01.450528 [debug] [MainThread]: On master: Close
[0m15:38:01.455528 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m15:38:01.456528 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m15:38:01.457528 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.fct_messages'
[0m15:38:01.458527 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m15:38:01.465526 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m15:38:01.467531 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m15:38:01.506528 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m15:38:01.509530 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:38:01.509530 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m15:38:01.510529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:01.546527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:38:01.547528 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:38:01.547528 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from { { ref('stg_telegram_messages') } }
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m15:38:01.549527 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 14:   from { { ref('stg_telegram_messages') } }
                ^

[0m15:38:01.550527 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: ROLLBACK
[0m15:38:01.551527 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m15:38:01.655529 [debug] [Thread-1 (]: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:38:01.657527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019957062E10>]}
[0m15:38:01.658528 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics.fct_messages ................... [[31mERROR[0m in 0.20s]
[0m15:38:01.658528 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m15:38:01.659527 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m15:38:01.660527 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql.
[0m15:38:01.660527 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m15:38:01.662529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.stg_image_detections)
[0m15:38:01.662529 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m15:38:01.666528 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m15:38:01.667541 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m15:38:01.686528 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m15:38:01.687527 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.687527 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m15:38:01.688546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:01.825355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m15:38:01.825871 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.826390 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m15:38:01.842689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m15:38:01.849701 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.850222 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m15:38:01.852913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:38:01.856593 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.857113 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m15:38:01.858158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:01.874114 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:38:01.874114 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.875115 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:38:01.877314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:38:01.887322 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m15:38:01.893324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:38:01.894324 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m15:38:01.898325 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:38:01.901323 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m15:38:01.902323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019958B17690>]}
[0m15:38:01.902323 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.24s]
[0m15:38:01.904350 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m15:38:01.905324 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m15:38:01.905324 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m15:38:01.906323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m15:38:01.907324 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m15:38:01.910324 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m15:38:01.912325 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m15:38:01.918337 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m15:38:01.920340 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:01.921324 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m15:38:01.921324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:02.066324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m15:38:02.067324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:02.067324 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m15:38:02.075323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:38:02.079323 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:02.079323 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:38:02.080323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.083322 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:02.084323 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:38:02.085325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.087324 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:38:02.087324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:02.088322 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:38:02.089322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:38:02.092324 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m15:38:02.093324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:38:02.093324 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m15:38:02.095324 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:38:02.096323 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m15:38:02.097322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019958C29010>]}
[0m15:38:02.098323 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.19s]
[0m15:38:02.099324 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m15:38:02.100323 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m15:38:02.101323 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m15:38:02.101323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m15:38:02.102324 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m15:38:02.105326 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m15:38:02.106325 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m15:38:02.110324 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m15:38:02.111323 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.112324 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m15:38:02.112324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:02.262377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m15:38:02.262377 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.263378 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m15:38:02.275378 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.011 seconds
[0m15:38:02.282377 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.283377 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:38:02.284377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.287378 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.288377 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:38:02.289379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.291376 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:38:02.291376 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.292380 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:38:02.293378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:38:02.296376 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m15:38:02.299389 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:38:02.300380 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m15:38:02.304378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:38:02.306381 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m15:38:02.307382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019958FAA790>]}
[0m15:38:02.307382 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.21s]
[0m15:38:02.308381 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m15:38:02.309378 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m15:38:02.309378 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m15:38:02.310377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m15:38:02.310377 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m15:38:02.314380 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m15:38:02.315384 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m15:38:02.319392 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m15:38:02.320393 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.321400 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m15:38:02.321400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:02.358393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:38:02.358393 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.359404 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m15:38:02.367396 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m15:38:02.371424 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.371424 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:38:02.372421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.377421 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.378391 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:38:02.379394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.381392 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:38:02.382390 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.383392 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:38:02.384392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:38:02.387390 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m15:38:02.388392 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:38:02.388392 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m15:38:02.392395 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:38:02.394392 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m15:38:02.395392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019958476C50>]}
[0m15:38:02.396393 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.09s]
[0m15:38:02.397400 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m15:38:02.398392 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m15:38:02.399391 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m15:38:02.399391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m15:38:02.400392 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m15:38:02.404395 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m15:38:02.405391 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m15:38:02.410391 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m15:38:02.411418 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.412392 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m15:38:02.412392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:02.446393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m15:38:02.446393 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.447392 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m15:38:02.460428 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.012 seconds
[0m15:38:02.464395 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.464395 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:38:02.465394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.469421 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.470422 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:38:02.471404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:38:02.473397 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:38:02.474420 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.474420 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:38:02.476402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:38:02.479392 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m15:38:02.480399 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:38:02.481393 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m15:38:02.484392 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:38:02.486390 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m15:38:02.487394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8a09f8-274b-4011-b374-55ef864f4c22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019957192D90>]}
[0m15:38:02.489392 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.09s]
[0m15:38:02.490392 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m15:38:02.491392 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:02.492392 [debug] [MainThread]: On master: BEGIN
[0m15:38:02.492392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:02.527391 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m15:38:02.527391 [debug] [MainThread]: On master: COMMIT
[0m15:38:02.528391 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:02.528391 [debug] [MainThread]: On master: COMMIT
[0m15:38:02.529392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:02.529392 [debug] [MainThread]: On master: Close
[0m15:38:02.530396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:02.530396 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m15:38:02.531391 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m15:38:02.531391 [debug] [MainThread]: Connection 'model.telegram_project.fct_image_detections' was properly closed.
[0m15:38:02.532391 [info ] [MainThread]: 
[0m15:38:02.532391 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m15:38:02.534392 [debug] [MainThread]: Command end result
[0m15:38:02.558392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:38:02.561391 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:38:02.568392 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m15:38:02.569392 [info ] [MainThread]: 
[0m15:38:02.570392 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:38:02.570392 [info ] [MainThread]: 
[0m15:38:02.571404 [error] [MainThread]: [31mFailure in model fct_messages (telegram_project/models\marts\fct_messages.sql)[0m
[0m15:38:02.572391 [error] [MainThread]:   Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:38:02.572391 [info ] [MainThread]: 
[0m15:38:02.573390 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:38:02.573390 [info ] [MainThread]: 
[0m15:38:02.574392 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:38:02.575392 [debug] [MainThread]: Command `dbt run` failed at 15:38:02.575392 after 6.87 seconds
[0m15:38:02.575392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019950297210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019956EF9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199505F1E50>]}
[0m15:38:02.576392 [debug] [MainThread]: Flushing usage events
[0m15:38:19.368782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:51.166938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA1A0B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA18C9DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA19D9D10>]}


============================== 15:42:51.172937 | e48f35bf-9082-462c-b2fe-15ad8c8ac51b ==============================
[0m15:42:51.172937 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:42:51.173939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:51.421921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA1B4B910>]}
[0m15:42:51.498893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC9E3C4250>]}
[0m15:42:51.500898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:42:51.807895 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:42:52.019923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:52.019923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:52.074894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA2EBF3D0>]}
[0m15:42:52.183895 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:42:52.185896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:42:52.217894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA302BF50>]}
[0m15:42:52.217894 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m15:42:52.218894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA1B6E250>]}
[0m15:42:52.220892 [info ] [MainThread]: 
[0m15:42:52.221893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:52.221893 [info ] [MainThread]: 
[0m15:42:52.223896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:52.229901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:42:52.313895 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:42:52.314898 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:52.314898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:52.356895 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.042 seconds
[0m15:42:52.358895 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:42:52.360892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m15:42:52.367896 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:42:52.368895 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m15:42:52.368895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:52.404905 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:42:52.405894 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:42:52.405894 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:42:52.412897 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m15:42:52.414895 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m15:42:52.415893 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m15:42:52.420894 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:52.421892 [debug] [MainThread]: On master: BEGIN
[0m15:42:52.421892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:52.558895 [debug] [MainThread]: SQL status: BEGIN in 0.137 seconds
[0m15:42:52.558895 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:52.559895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:52.570896 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m15:42:52.571895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA2F40950>]}
[0m15:42:52.572893 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:52.572893 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:52.573895 [debug] [MainThread]: On master: BEGIN
[0m15:42:52.573895 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:42:52.574894 [debug] [MainThread]: On master: COMMIT
[0m15:42:52.574894 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:52.575893 [debug] [MainThread]: On master: COMMIT
[0m15:42:52.575893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:42:52.576897 [debug] [MainThread]: On master: Close
[0m15:42:52.580900 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m15:42:52.581896 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m15:42:52.582893 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.fct_messages'
[0m15:42:52.582893 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m15:42:52.590896 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m15:42:52.591895 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m15:42:52.630924 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m15:42:52.632914 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:42:52.633900 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m15:42:52.633900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:52.667896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m15:42:52.667896 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:42:52.668897 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from { { ref('stg_telegram_messages') } }
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m15:42:52.669897 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 14:   from { { ref('stg_telegram_messages') } }
                ^

[0m15:42:52.669897 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: ROLLBACK
[0m15:42:52.670896 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m15:42:52.675897 [debug] [Thread-1 (]: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:42:52.678896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA33A7F50>]}
[0m15:42:52.678896 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics.fct_messages ................... [[31mERROR[0m in 0.10s]
[0m15:42:52.679896 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m15:42:52.680898 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m15:42:52.681928 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql.
[0m15:42:52.681928 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m15:42:52.683895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.stg_image_detections)
[0m15:42:52.684895 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m15:42:52.687895 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m15:42:52.689896 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m15:42:52.707893 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m15:42:52.709900 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.709900 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m15:42:52.710894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:52.746895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:42:52.747923 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.747923 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m15:42:52.754894 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:42:52.760894 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.761894 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m15:42:52.762892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:52.766894 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.766894 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m15:42:52.767896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:52.787894 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:42:52.788894 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.788894 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:42:52.821179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m15:42:52.885109 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m15:42:52.891212 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:42:52.891212 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m15:42:52.907233 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m15:42:52.910225 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m15:42:52.910225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA38D0910>]}
[0m15:42:52.911227 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.23s]
[0m15:42:52.912225 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m15:42:52.913226 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m15:42:52.914223 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m15:42:52.915220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m15:42:52.915220 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m15:42:52.919222 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m15:42:52.920249 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m15:42:52.924222 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m15:42:52.925221 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.925221 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m15:42:52.926221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:52.958227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m15:42:52.959221 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.959221 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m15:42:52.964220 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:42:52.968223 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.969225 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:42:52.970233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:52.974224 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.974224 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:42:52.975225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:52.977249 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:42:52.977249 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.978249 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:42:52.994063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m15:42:52.997067 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m15:42:52.998066 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:42:52.998066 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m15:42:53.000031 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:42:53.002048 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m15:42:53.003060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA1C194D0>]}
[0m15:42:53.005032 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.09s]
[0m15:42:53.005032 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m15:42:53.007032 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m15:42:53.008034 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m15:42:53.010030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m15:42:53.010030 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m15:42:53.013029 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m15:42:53.014030 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m15:42:53.019031 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m15:42:53.020029 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.020029 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m15:42:53.021041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:53.165829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m15:42:53.165829 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.166838 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m15:42:53.175839 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m15:42:53.182838 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.182838 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:42:53.183836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:53.186836 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.187837 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:42:53.188837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:53.190837 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:42:53.191836 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.191836 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:42:53.193368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:42:53.195376 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m15:42:53.199413 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:42:53.199413 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m15:42:53.203398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:42:53.205403 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m15:42:53.206375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA1B0BA50>]}
[0m15:42:53.206375 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.20s]
[0m15:42:53.207374 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m15:42:53.208387 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m15:42:53.209377 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m15:42:53.210377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m15:42:53.210377 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m15:42:53.215375 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m15:42:53.216375 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m15:42:53.220379 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m15:42:53.221379 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.222378 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m15:42:53.223377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:53.258620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:42:53.258620 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.259619 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m15:42:53.267619 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m15:42:53.271620 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.271620 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:42:53.272620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:53.275617 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.276622 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:42:53.277622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:53.279619 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:42:53.280629 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.281619 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:42:53.286508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:42:53.289507 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m15:42:53.290507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:42:53.291506 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m15:42:53.294508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:42:53.297508 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m15:42:53.298508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA30B0C50>]}
[0m15:42:53.300510 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.09s]
[0m15:42:53.301510 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m15:42:53.302509 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m15:42:53.303512 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m15:42:53.303512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m15:42:53.304510 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m15:42:53.309509 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m15:42:53.311509 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m15:42:53.316510 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m15:42:53.318512 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.318512 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m15:42:53.319512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:53.463507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m15:42:53.463507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.464507 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m15:42:53.475506 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.011 seconds
[0m15:42:53.480508 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.480508 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:42:53.481507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:53.484543 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.485537 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:42:53.486509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:42:53.488508 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:42:53.489507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.489507 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:42:53.499508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m15:42:53.502507 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m15:42:53.503507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:42:53.503507 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m15:42:53.519509 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:42:53.522507 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m15:42:53.523508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48f35bf-9082-462c-b2fe-15ad8c8ac51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACA33F9110>]}
[0m15:42:53.524508 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.22s]
[0m15:42:53.525508 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m15:42:53.527507 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:53.527507 [debug] [MainThread]: On master: BEGIN
[0m15:42:53.528508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:53.665507 [debug] [MainThread]: SQL status: BEGIN in 0.137 seconds
[0m15:42:53.666508 [debug] [MainThread]: On master: COMMIT
[0m15:42:53.666508 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:53.667510 [debug] [MainThread]: On master: COMMIT
[0m15:42:53.668508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:42:53.668508 [debug] [MainThread]: On master: Close
[0m15:42:53.669507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:53.669507 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m15:42:53.670508 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m15:42:53.670508 [debug] [MainThread]: Connection 'model.telegram_project.fct_image_detections' was properly closed.
[0m15:42:53.671508 [info ] [MainThread]: 
[0m15:42:53.671508 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m15:42:53.673509 [debug] [MainThread]: Command end result
[0m15:42:53.698505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:42:53.701509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:42:53.708511 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m15:42:53.709511 [info ] [MainThread]: 
[0m15:42:53.709511 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:42:53.710511 [info ] [MainThread]: 
[0m15:42:53.710511 [error] [MainThread]: [31mFailure in model fct_messages (telegram_project/models\marts\fct_messages.sql)[0m
[0m15:42:53.711512 [error] [MainThread]:   Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:42:53.711512 [info ] [MainThread]: 
[0m15:42:53.712510 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:42:53.712510 [info ] [MainThread]: 
[0m15:42:53.713509 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:42:53.714508 [debug] [MainThread]: Command `dbt run` failed at 15:42:53.714508 after 2.65 seconds
[0m15:42:53.715507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC9AD47210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC9B024B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC9B0A1E50>]}
[0m15:42:53.715507 [debug] [MainThread]: Flushing usage events
[0m15:42:57.463869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:02.765039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463AA43F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463AA3B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463AA43D50>]}


============================== 15:55:02.771039 | 911f0a16-dbd0-4f10-8548-23f9051db443 ==============================
[0m15:55:02.771039 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:55:02.773039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:55:03.052040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463AC26A10>]}
[0m15:55:03.130041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246373D2050>]}
[0m15:55:03.132043 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:03.420068 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:55:03.597239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:03.598281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:03.662057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463BED2250>]}
[0m15:55:03.780662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:55:03.783635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:55:03.812636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463AB5BA90>]}
[0m15:55:03.813639 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m15:55:03.814639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463BF1D450>]}
[0m15:55:03.816658 [info ] [MainThread]: 
[0m15:55:03.817634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:03.817634 [info ] [MainThread]: 
[0m15:55:03.818634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:03.824634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:55:03.907637 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:55:03.908662 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:55:03.909634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:04.058276 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.149 seconds
[0m15:55:04.060281 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:55:04.062276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m15:55:04.069275 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:55:04.070275 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m15:55:04.070275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:04.206381 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m15:55:04.207381 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:55:04.207381 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:55:04.215380 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m15:55:04.216393 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m15:55:04.217379 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m15:55:04.223378 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:04.223378 [debug] [MainThread]: On master: BEGIN
[0m15:55:04.224380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:04.363378 [debug] [MainThread]: SQL status: BEGIN in 0.139 seconds
[0m15:55:04.364378 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:04.364378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:04.373379 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m15:55:04.375378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463ABD0990>]}
[0m15:55:04.375378 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:04.376379 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:04.376379 [debug] [MainThread]: On master: BEGIN
[0m15:55:04.377422 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:04.377422 [debug] [MainThread]: On master: COMMIT
[0m15:55:04.377422 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:04.378413 [debug] [MainThread]: On master: COMMIT
[0m15:55:04.378413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:04.379379 [debug] [MainThread]: On master: Close
[0m15:55:04.383381 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m15:55:04.384380 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m15:55:04.385381 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.fct_messages'
[0m15:55:04.386381 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m15:55:04.392380 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m15:55:04.394388 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m15:55:04.433382 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m15:55:04.434382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:55:04.435400 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m15:55:04.435400 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:04.582380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m15:55:04.583381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:55:04.583381 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from { { ref('stg_telegram_messages') } }
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m15:55:04.584382 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 14:   from { { ref('stg_telegram_messages') } }
                ^

[0m15:55:04.585407 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: ROLLBACK
[0m15:55:04.585407 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m15:55:04.592380 [debug] [Thread-1 (]: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:55:04.595381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463C0448D0>]}
[0m15:55:04.596382 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics.fct_messages ................... [[31mERROR[0m in 0.21s]
[0m15:55:04.597398 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m15:55:04.597398 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m15:55:04.598382 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql.
[0m15:55:04.598382 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m15:55:04.600381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.stg_image_detections)
[0m15:55:04.600381 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m15:55:04.604381 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m15:55:04.605383 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m15:55:04.622383 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m15:55:04.623381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.624382 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m15:55:04.624382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:04.765380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m15:55:04.766412 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.767407 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m15:55:04.771412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:55:04.777381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.778381 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m15:55:04.779381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:04.783384 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.783384 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m15:55:04.784384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:04.800381 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:55:04.801381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.802381 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:55:04.804384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:55:04.859409 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m15:55:04.864408 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:55:04.865412 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m15:55:04.867381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:55:04.870380 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m15:55:04.871382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463C8B9DD0>]}
[0m15:55:04.872383 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.27s]
[0m15:55:04.873380 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m15:55:04.874381 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m15:55:04.875381 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m15:55:04.876384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m15:55:04.877409 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m15:55:04.880409 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m15:55:04.881380 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m15:55:04.885381 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m15:55:04.887385 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.887385 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m15:55:04.888385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:04.926383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:55:04.927382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.927382 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m15:55:04.932408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:55:04.936383 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.936383 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:55:04.937383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:04.941381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.941381 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:55:04.942383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:04.944383 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:55:04.945382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.945382 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:55:04.948436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:04.951411 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m15:55:04.952406 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:55:04.953408 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m15:55:04.955381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:55:04.957383 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m15:55:04.958384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463A8EACD0>]}
[0m15:55:04.959381 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.08s]
[0m15:55:04.960382 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m15:55:04.961380 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m15:55:04.962383 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m15:55:04.962383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m15:55:04.963408 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m15:55:04.966381 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m15:55:04.967383 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m15:55:04.971383 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m15:55:04.972382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:04.973383 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m15:55:04.973383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:05.112380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m15:55:05.113384 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:05.113384 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m15:55:05.123382 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m15:55:05.129383 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:05.130384 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:55:05.131385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:05.134382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:05.135382 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:55:05.136387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:05.138411 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:55:05.139382 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:05.140438 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:55:05.141412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:55:05.144399 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m15:55:05.147381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:55:05.148382 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m15:55:05.152380 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:55:05.153382 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m15:55:05.154381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463C8C56D0>]}
[0m15:55:05.155383 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.19s]
[0m15:55:05.156382 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m15:55:05.156382 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m15:55:05.158383 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m15:55:05.158383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m15:55:05.159383 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m15:55:05.164408 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m15:55:05.165392 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m15:55:05.169381 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m15:55:05.170381 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.171385 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m15:55:05.171385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:05.314058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m15:55:05.315091 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.315091 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m15:55:05.326096 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m15:55:05.329084 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.330112 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:55:05.331058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:05.334056 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.335058 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:55:05.336057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:05.337090 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:55:05.338057 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.338057 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:55:05.340086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:55:05.342084 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m15:55:05.343084 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:55:05.344093 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m15:55:05.348058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:55:05.349057 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m15:55:05.350057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463C42FC50>]}
[0m15:55:05.351059 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.19s]
[0m15:55:05.352059 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m15:55:05.352059 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m15:55:05.353058 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m15:55:05.354058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m15:55:05.354058 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m15:55:05.358092 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m15:55:05.359058 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m15:55:05.363058 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m15:55:05.364071 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.365057 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m15:55:05.366056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:05.400062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:55:05.401059 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.402058 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m15:55:05.413057 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.011 seconds
[0m15:55:05.417058 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.418056 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:55:05.419057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:05.423057 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.423057 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:55:05.424058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:55:05.426058 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:55:05.427059 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.427059 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:55:05.429059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:55:05.432057 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m15:55:05.433057 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:55:05.434057 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m15:55:05.439058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:55:05.441062 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m15:55:05.442062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f0a16-dbd0-4f10-8548-23f9051db443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002463C43B190>]}
[0m15:55:05.443061 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.09s]
[0m15:55:05.444059 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m15:55:05.446058 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:05.446058 [debug] [MainThread]: On master: BEGIN
[0m15:55:05.447058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:05.481058 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m15:55:05.482059 [debug] [MainThread]: On master: COMMIT
[0m15:55:05.482059 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:05.483059 [debug] [MainThread]: On master: COMMIT
[0m15:55:05.484059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:05.484059 [debug] [MainThread]: On master: Close
[0m15:55:05.485058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:05.485058 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m15:55:05.486056 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m15:55:05.486056 [debug] [MainThread]: Connection 'model.telegram_project.fct_image_detections' was properly closed.
[0m15:55:05.487059 [info ] [MainThread]: 
[0m15:55:05.487059 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m15:55:05.489059 [debug] [MainThread]: Command end result
[0m15:55:05.513057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:55:05.515057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:55:05.522089 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m15:55:05.523057 [info ] [MainThread]: 
[0m15:55:05.523057 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:55:05.524084 [info ] [MainThread]: 
[0m15:55:05.524084 [error] [MainThread]: [31mFailure in model fct_messages (telegram_project/models\marts\fct_messages.sql)[0m
[0m15:55:05.525060 [error] [MainThread]:   Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:55:05.525060 [info ] [MainThread]: 
[0m15:55:05.526057 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:55:05.527056 [info ] [MainThread]: 
[0m15:55:05.527056 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:55:05.528057 [debug] [MainThread]: Command `dbt run` failed at 15:55:05.528057 after 2.86 seconds
[0m15:55:05.529057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024633C67210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024633F44B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024633FC1E50>]}
[0m15:55:05.530057 [debug] [MainThread]: Flushing usage events
[0m15:55:08.368390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:03.980103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B16748F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B167383990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1673826D0>]}


============================== 15:57:03.984104 | f36a4213-3f37-4e41-8627-e5e4aa0d9744 ==============================
[0m15:57:03.984104 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:57:03.984104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:04.171101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1675D37D0>]}
[0m15:57:04.229136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B163E85D10>]}
[0m15:57:04.231102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:04.493104 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:57:04.640102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:04.641102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:04.686136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B168986090>]}
[0m15:57:04.766136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:57:04.768104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:57:04.792103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B167684B10>]}
[0m15:57:04.792103 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m15:57:04.793103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B168AE8A90>]}
[0m15:57:04.795103 [info ] [MainThread]: 
[0m15:57:04.796103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:04.796103 [info ] [MainThread]: 
[0m15:57:04.797107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:04.801102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:57:04.874102 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:57:04.875102 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:57:04.875102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:04.915103 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.040 seconds
[0m15:57:04.917136 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:57:04.918104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m15:57:04.925140 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:57:04.925140 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m15:57:04.926112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:04.958169 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m15:57:04.959196 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:57:04.959196 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:57:04.966167 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m15:57:04.967167 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m15:57:04.968167 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m15:57:04.974196 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:04.974196 [debug] [MainThread]: On master: BEGIN
[0m15:57:04.974196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:05.006167 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m15:57:05.007167 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.007167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:05.016167 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m15:57:05.017167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1689E2D50>]}
[0m15:57:05.018168 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:05.018168 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.019205 [debug] [MainThread]: On master: BEGIN
[0m15:57:05.019205 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:05.020168 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.020168 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.021167 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.021167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:05.022197 [debug] [MainThread]: On master: Close
[0m15:57:05.026169 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m15:57:05.027167 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m15:57:05.028167 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.fct_messages'
[0m15:57:05.028167 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m15:57:05.034167 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m15:57:05.035167 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m15:57:05.072167 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m15:57:05.074169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:57:05.075168 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m15:57:05.075168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:05.107178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m15:57:05.108168 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:57:05.109169 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from { { ref('stg_telegram_messages') } }
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m15:57:05.109169 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 14:   from { { ref('stg_telegram_messages') } }
                ^

[0m15:57:05.110168 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: ROLLBACK
[0m15:57:05.111198 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m15:57:05.115168 [debug] [Thread-1 (]: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:57:05.117167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B168E1F150>]}
[0m15:57:05.118168 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics.fct_messages ................... [[31mERROR[0m in 0.09s]
[0m15:57:05.119167 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m15:57:05.119167 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m15:57:05.120167 [debug] [Thread-4 (]: Marking all children of 'model.telegram_project.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql.
[0m15:57:05.120167 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m15:57:05.122174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_messages, now model.telegram_project.stg_image_detections)
[0m15:57:05.123168 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m15:57:05.126166 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m15:57:05.126166 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m15:57:05.143167 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m15:57:05.144169 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.145168 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m15:57:05.145168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.181169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m15:57:05.182168 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.182168 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m15:57:05.187167 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:57:05.193167 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.194167 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m15:57:05.195167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.198168 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.199170 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m15:57:05.200168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.216167 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:57:05.216167 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.217167 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:57:05.218168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:57:05.273628 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m15:57:05.279627 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:57:05.279627 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m15:57:05.281657 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:57:05.284627 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m15:57:05.285629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B16938A010>]}
[0m15:57:05.286629 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.16s]
[0m15:57:05.287628 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m15:57:05.287628 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m15:57:05.288658 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m15:57:05.289645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m15:57:05.289645 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m15:57:05.292626 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m15:57:05.293657 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m15:57:05.298628 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m15:57:05.300627 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.300627 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m15:57:05.301627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.336657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:57:05.337649 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.337649 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m15:57:05.341657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:57:05.344657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.345660 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:57:05.346658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.348657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.349657 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:57:05.349657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.351657 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:57:05.351657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.352660 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:57:05.353657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:57:05.355661 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m15:57:05.356657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:57:05.356657 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m15:57:05.358653 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:57:05.359655 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m15:57:05.360627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B166C60F10>]}
[0m15:57:05.360627 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.07s]
[0m15:57:05.361652 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m15:57:05.362653 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m15:57:05.363626 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m15:57:05.364625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m15:57:05.364625 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m15:57:05.367623 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m15:57:05.368623 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m15:57:05.372625 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m15:57:05.373624 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.373624 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m15:57:05.374624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.521190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m15:57:05.522223 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.522223 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m15:57:05.532189 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m15:57:05.538188 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.538188 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:57:05.539613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.541620 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.542636 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:57:05.542636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.544653 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:57:05.545653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.545653 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:57:05.547274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:57:05.549280 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m15:57:05.551280 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:57:05.552280 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m15:57:05.555281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:57:05.556303 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m15:57:05.557280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B168B78F10>]}
[0m15:57:05.558280 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.19s]
[0m15:57:05.560284 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m15:57:05.560284 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m15:57:05.561309 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m15:57:05.562280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m15:57:05.562280 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m15:57:05.567280 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m15:57:05.567280 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m15:57:05.573280 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m15:57:05.574281 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.575280 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m15:57:05.576281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.611280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:57:05.611280 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.612280 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m15:57:05.620280 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m15:57:05.623280 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.623280 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:57:05.624280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.627281 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.627281 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:57:05.628252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.629260 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:57:05.630290 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.630290 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:57:05.632135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:57:05.634140 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m15:57:05.635141 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:57:05.635141 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m15:57:05.638312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:57:05.639293 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m15:57:05.640330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B168E74650>]}
[0m15:57:05.641292 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.08s]
[0m15:57:05.642294 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m15:57:05.642294 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m15:57:05.643293 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m15:57:05.644292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m15:57:05.644292 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m15:57:05.648332 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m15:57:05.649326 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m15:57:05.653325 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m15:57:05.653325 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.654293 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m15:57:05.654293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.795033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.140 seconds
[0m15:57:05.796033 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.796033 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m15:57:05.807000 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.011 seconds
[0m15:57:05.810998 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.810998 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:57:05.812027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.815027 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.816000 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:57:05.816999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:05.818000 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:57:05.818999 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.819999 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:57:05.823000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:57:05.825028 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m15:57:05.826028 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:57:05.826028 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m15:57:05.831029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:57:05.832032 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m15:57:05.833066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36a4213-3f37-4e41-8627-e5e4aa0d9744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B16764C2D0>]}
[0m15:57:05.834000 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.19s]
[0m15:57:05.834999 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m15:57:05.836998 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.836998 [debug] [MainThread]: On master: BEGIN
[0m15:57:05.836998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:05.868571 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m15:57:05.869573 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.869573 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.870605 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.870605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:05.871604 [debug] [MainThread]: On master: Close
[0m15:57:05.871604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:05.872580 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m15:57:05.872580 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m15:57:05.873571 [debug] [MainThread]: Connection 'model.telegram_project.fct_image_detections' was properly closed.
[0m15:57:05.874571 [info ] [MainThread]: 
[0m15:57:05.874571 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m15:57:05.876572 [debug] [MainThread]: Command end result
[0m15:57:05.900570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:57:05.903571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:57:05.909590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m15:57:05.910572 [info ] [MainThread]: 
[0m15:57:05.910572 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:05.911572 [info ] [MainThread]: 
[0m15:57:05.912574 [error] [MainThread]: [31mFailure in model fct_messages (telegram_project/models\marts\fct_messages.sql)[0m
[0m15:57:05.913572 [error] [MainThread]:   Database Error in model fct_messages (telegram_project/models\marts\fct_messages.sql)
  syntax error at or near "{"
  LINE 14:   from { { ref('stg_telegram_messages') } }
                  ^
  compiled code at target\run\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:57:05.913572 [info ] [MainThread]: 
[0m15:57:05.914571 [info ] [MainThread]:   compiled code at target\compiled\telegram_project\telegram_project/models\marts\fct_messages.sql
[0m15:57:05.914571 [info ] [MainThread]: 
[0m15:57:05.915572 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m15:57:05.916572 [debug] [MainThread]: Command `dbt run` failed at 15:57:05.916572 after 2.01 seconds
[0m15:57:05.917572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1607F7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B160AD49D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B160AD4A10>]}
[0m15:57:05.917572 [debug] [MainThread]: Flushing usage events
[0m15:57:07.915776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:22.438840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC54B6F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC54B6EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC54E34CD0>]}


============================== 15:58:22.441841 | e99ab5cf-0b28-45e1-833d-42e602e13968 ==============================
[0m15:58:22.441841 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:58:22.442841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:22.629878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC55045650>]}
[0m15:58:22.684873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC517E4650>]}
[0m15:58:22.685875 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:22.907870 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:58:23.052743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:23.052743 [debug] [MainThread]: Partial parsing: updated file: telegram_project://telegram_project/models\marts\fct_messages.sql
[0m15:58:23.291714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC564EDD10>]}
[0m15:58:23.363743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:58:23.365748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:58:23.386726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC565D0650>]}
[0m15:58:23.387715 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m15:58:23.388729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC564CEA90>]}
[0m15:58:23.390714 [info ] [MainThread]: 
[0m15:58:23.390714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:23.391715 [info ] [MainThread]: 
[0m15:58:23.391715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:23.396715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:58:23.505745 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:58:23.505745 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:58:23.506717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:23.543127 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m15:58:23.544133 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:58:23.546164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m15:58:23.551166 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:58:23.552135 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m15:58:23.552135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:23.723103 [debug] [ThreadPool]: SQL status: BEGIN in 0.171 seconds
[0m15:58:23.724143 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m15:58:23.725113 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:58:23.732111 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m15:58:23.734140 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m15:58:23.734140 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m15:58:23.740112 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:23.740112 [debug] [MainThread]: On master: BEGIN
[0m15:58:23.741133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:23.773301 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m15:58:23.774333 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:23.774333 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:23.783195 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m15:58:23.784161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC56276690>]}
[0m15:58:23.785162 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:23.786305 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:23.786305 [debug] [MainThread]: On master: BEGIN
[0m15:58:23.787364 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:58:23.787364 [debug] [MainThread]: On master: COMMIT
[0m15:58:23.788338 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:23.788338 [debug] [MainThread]: On master: COMMIT
[0m15:58:23.789344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:23.790336 [debug] [MainThread]: On master: Close
[0m15:58:23.794363 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m15:58:23.796332 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m15:58:23.797334 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m15:58:23.798349 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m15:58:23.805329 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m15:58:23.806330 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m15:58:23.840364 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m15:58:23.841332 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.841332 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m15:58:23.842367 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:23.871360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m15:58:23.872364 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.872364 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m15:58:23.877359 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:58:23.883332 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.883332 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m15:58:23.884332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:23.887365 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.888366 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m15:58:23.889333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:23.903364 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:58:23.903364 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.904331 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m15:58:23.906330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:23.911330 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m15:58:23.916359 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m15:58:23.916359 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m15:58:23.917332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:58:23.920364 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m15:58:23.922346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC54E52F90>]}
[0m15:58:23.923356 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:58:23.924334 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m15:58:23.924334 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m15:58:23.925333 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m15:58:23.926372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m15:58:23.926372 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m15:58:23.929363 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m15:58:23.930382 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m15:58:23.933367 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m15:58:23.934364 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.935340 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m15:58:23.936333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:23.969330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m15:58:23.969330 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.970331 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m15:58:23.974329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:58:23.977331 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.977331 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:58:23.978330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:23.981329 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.981329 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:58:23.982330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:23.984331 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:58:23.984331 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.985330 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m15:58:23.986330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:23.989331 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m15:58:23.990332 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m15:58:23.991334 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m15:58:23.992331 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:58:23.993331 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m15:58:23.994329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC569C1C10>]}
[0m15:58:23.995330 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.07s]
[0m15:58:23.996331 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m15:58:23.997341 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m15:58:23.997341 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m15:58:23.998330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m15:58:23.999330 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m15:58:24.001330 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m15:58:24.002329 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m15:58:24.022334 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m15:58:24.023330 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.024333 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m15:58:24.024333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.165238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m15:58:24.165755 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.166271 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m15:58:24.172831 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m15:58:24.179829 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.180829 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:58:24.181828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.184829 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.184829 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:58:24.185829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.187828 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:58:24.188834 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.188834 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m15:58:24.189829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:24.192828 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m15:58:24.194828 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m15:58:24.195828 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m15:58:24.198829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:58:24.199828 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m15:58:24.200828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC569C2510>]}
[0m15:58:24.201829 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.20s]
[0m15:58:24.202840 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m15:58:24.203830 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m15:58:24.204749 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m15:58:24.205287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m15:58:24.206316 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m15:58:24.209330 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m15:58:24.210295 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m15:58:24.213326 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m15:58:24.214294 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.214294 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m15:58:24.215296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.356368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.141 seconds
[0m15:58:24.356368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.357371 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m15:58:24.365369 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m15:58:24.369368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.370367 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:58:24.371378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.375371 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.375371 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:58:24.376371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.378370 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:58:24.379370 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.379370 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m15:58:24.380371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:24.383370 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m15:58:24.385370 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m15:58:24.385370 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m15:58:24.389371 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:58:24.390371 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m15:58:24.391370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC568D91D0>]}
[0m15:58:24.392370 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.19s]
[0m15:58:24.393369 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m15:58:24.393369 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m15:58:24.394370 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m15:58:24.395370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m15:58:24.395370 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m15:58:24.400370 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m15:58:24.401370 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m15:58:24.406401 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m15:58:24.407372 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.408397 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m15:58:24.408397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.446371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m15:58:24.447371 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.447371 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m15:58:24.457397 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.009 seconds
[0m15:58:24.460371 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.461371 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:58:24.462369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.465371 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.465371 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:58:24.466372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.468393 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:58:24.469396 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.469396 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m15:58:24.471397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:24.474369 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m15:58:24.475376 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m15:58:24.475376 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m15:58:24.479368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:58:24.481368 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m15:58:24.481368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC56930610>]}
[0m15:58:24.482368 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.09s]
[0m15:58:24.483369 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m15:58:24.484380 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m15:58:24.485368 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m15:58:24.486371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m15:58:24.486371 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m15:58:24.489371 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m15:58:24.490371 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m15:58:24.494371 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m15:58:24.495372 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.495372 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m15:58:24.496373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.538386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m15:58:24.539368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.540371 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from "telegram_db"."analytics"."stg_telegram_messages"
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m15:58:24.550368 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.009 seconds
[0m15:58:24.553368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.554368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m15:58:24.555368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.558368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.558368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m15:58:24.559368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:24.561368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m15:58:24.561368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.562368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m15:58:24.563368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:24.565368 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m15:58:24.566368 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m15:58:24.567368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m15:58:24.570368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:58:24.571368 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m15:58:24.572369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99ab5cf-0b28-45e1-833d-42e602e13968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC569A08D0>]}
[0m15:58:24.573370 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.09s]
[0m15:58:24.574369 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m15:58:24.575369 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:24.576368 [debug] [MainThread]: On master: BEGIN
[0m15:58:24.577370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:24.722388 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m15:58:24.722388 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.723368 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:24.723368 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.724369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:24.724369 [debug] [MainThread]: On master: Close
[0m15:58:24.725368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:24.726367 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m15:58:24.726367 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m15:58:24.727368 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m15:58:24.727368 [info ] [MainThread]: 
[0m15:58:24.728384 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m15:58:24.730367 [debug] [MainThread]: Command end result
[0m15:58:24.754369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m15:58:24.756401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m15:58:24.762401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m15:58:24.763369 [info ] [MainThread]: 
[0m15:58:24.763369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:24.764368 [info ] [MainThread]: 
[0m15:58:24.765369 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m15:58:24.766374 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:24.766374 after 2.41 seconds
[0m15:58:24.767368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E107110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E461ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E1D7D90>]}
[0m15:58:24.767368 [debug] [MainThread]: Flushing usage events
[0m15:58:26.604870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:57.680536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B06890D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B064F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B068A810>]}


============================== 16:00:57.685531 | f687b6c5-6ce7-4452-bb58-d728d3f202b0 ==============================
[0m16:00:57.685531 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:00:57.686535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:57.908533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B088D7D0>]}
[0m16:00:57.981350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AD0360D0>]}
[0m16:00:57.983438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:00:58.263424 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:00:58.438423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:58.438423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:58.497424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B1B8E110>]}
[0m16:00:58.590426 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:00:58.592423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:00:58.621424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B07DCA90>]}
[0m16:00:58.622424 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m16:00:58.623425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B1ABE350>]}
[0m16:00:58.626425 [info ] [MainThread]: 
[0m16:00:58.626425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:58.627425 [info ] [MainThread]: 
[0m16:00:58.627425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:58.634423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:00:58.736427 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:00:58.737426 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:58.738425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:58.884423 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.146 seconds
[0m16:00:58.885423 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:00:58.888425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m16:00:58.894423 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:00:58.895424 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m16:00:58.895424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:58.925423 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m16:00:58.925423 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:00:58.926422 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:00:58.931422 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m16:00:58.933423 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m16:00:58.933423 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m16:00:58.939423 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:58.939423 [debug] [MainThread]: On master: BEGIN
[0m16:00:58.940422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:58.969423 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:00:58.969423 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:58.970423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:58.977422 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:00:58.979424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B1CBBA50>]}
[0m16:00:58.979424 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:58.980423 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:58.980423 [debug] [MainThread]: On master: BEGIN
[0m16:00:58.981424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:00:58.981424 [debug] [MainThread]: On master: COMMIT
[0m16:00:58.982423 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:58.982423 [debug] [MainThread]: On master: COMMIT
[0m16:00:58.982423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:58.983423 [debug] [MainThread]: On master: Close
[0m16:00:58.987423 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m16:00:58.987423 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m16:00:58.988423 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m16:00:58.989422 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m16:00:58.996422 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m16:00:58.997423 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m16:00:59.027422 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m16:00:59.029422 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.029422 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m16:00:59.030422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:00:59.063423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:00:59.063423 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.064422 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m16:00:59.069422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:00:59.075437 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.075437 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m16:00:59.076423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.079422 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.080423 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m16:00:59.080423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.095422 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:00:59.097440 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.097440 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:00:59.101423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:00:59.107450 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m16:00:59.112452 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:00:59.113423 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m16:00:59.114421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:00:59.117422 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m16:00:59.119422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B2023350>]}
[0m16:00:59.120422 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.13s]
[0m16:00:59.121422 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m16:00:59.122421 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m16:00:59.122421 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m16:00:59.123422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m16:00:59.124421 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m16:00:59.126422 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m16:00:59.127422 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m16:00:59.132422 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m16:00:59.133427 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.134436 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m16:00:59.134436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.166422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m16:00:59.166422 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.167421 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m16:00:59.172421 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:00:59.213423 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.214422 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m16:00:59.215423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.218423 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.219424 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m16:00:59.220423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.222422 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:00:59.222422 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.223423 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:00:59.224423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:59.227422 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m16:00:59.228422 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:00:59.229422 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m16:00:59.230424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:00:59.232428 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m16:00:59.232428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B24F8290>]}
[0m16:00:59.233423 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.11s]
[0m16:00:59.234423 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m16:00:59.235423 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m16:00:59.236423 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m16:00:59.236423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m16:00:59.237428 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m16:00:59.240452 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m16:00:59.241424 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m16:00:59.259142 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m16:00:59.260142 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.261110 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m16:00:59.261110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.292109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m16:00:59.293142 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.293142 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m16:00:59.302112 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:59.308111 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.309111 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m16:00:59.310111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.312111 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.313111 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m16:00:59.314111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.316112 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:00:59.317111 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.317111 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:00:59.319109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:59.322110 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m16:00:59.325139 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:00:59.325139 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m16:00:59.329109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:00:59.330109 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m16:00:59.331109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B1FDEA50>]}
[0m16:00:59.332115 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.09s]
[0m16:00:59.333110 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m16:00:59.333110 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m16:00:59.334110 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m16:00:59.335109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m16:00:59.335109 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m16:00:59.338108 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m16:00:59.338108 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m16:00:59.343108 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m16:00:59.344108 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.345114 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m16:00:59.345114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.375109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:00:59.376141 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.376141 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m16:00:59.384109 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m16:00:59.387107 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.387107 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m16:00:59.388108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.391110 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.391110 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:00:59.392111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.394109 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:00:59.395110 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.395110 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:00:59.396109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:59.399142 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m16:00:59.399142 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:00:59.400142 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m16:00:59.403109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:00:59.404111 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m16:00:59.405109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B06FBB50>]}
[0m16:00:59.406109 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.07s]
[0m16:00:59.407110 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m16:00:59.407110 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m16:00:59.408142 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m16:00:59.409109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m16:00:59.409109 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m16:00:59.412108 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m16:00:59.413108 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m16:00:59.417137 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m16:00:59.417137 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.418109 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m16:00:59.418109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.448108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:00:59.449110 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.449110 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m16:00:59.459108 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.009 seconds
[0m16:00:59.462108 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.463109 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m16:00:59.463109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.466144 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.467142 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m16:00:59.468110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.469145 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:00:59.470142 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.470142 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:00:59.471144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:59.474142 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m16:00:59.475142 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:00:59.475142 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m16:00:59.479109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:00:59.480140 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m16:00:59.481109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B20391D0>]}
[0m16:00:59.481109 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.07s]
[0m16:00:59.482109 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m16:00:59.483120 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m16:00:59.483120 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m16:00:59.484109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m16:00:59.484109 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m16:00:59.487137 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m16:00:59.488110 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m16:00:59.491138 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m16:00:59.492110 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.492110 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m16:00:59.493143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.526108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:00:59.527111 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.527111 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from "telegram_db"."analytics"."stg_telegram_messages"
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m16:00:59.535109 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.007 seconds
[0m16:00:59.538108 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.538108 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m16:00:59.539110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.543108 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.543108 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m16:00:59.544108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:00:59.546110 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:00:59.546110 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.547108 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:00:59.548109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:00:59.550108 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m16:00:59.551109 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:00:59.551109 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m16:00:59.553109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:00:59.554109 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m16:00:59.555108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f687b6c5-6ce7-4452-bb58-d728d3f202b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B0778750>]}
[0m16:00:59.556108 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.07s]
[0m16:00:59.556108 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m16:00:59.558109 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:59.558109 [debug] [MainThread]: On master: BEGIN
[0m16:00:59.559108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:59.588110 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:00:59.589142 [debug] [MainThread]: On master: COMMIT
[0m16:00:59.589142 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:59.589142 [debug] [MainThread]: On master: COMMIT
[0m16:00:59.590145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:00:59.590145 [debug] [MainThread]: On master: Close
[0m16:00:59.591141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:59.591141 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m16:00:59.592109 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m16:00:59.592109 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m16:00:59.593109 [info ] [MainThread]: 
[0m16:00:59.593109 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:00:59.595142 [debug] [MainThread]: Command end result
[0m16:00:59.614183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:00:59.617150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:00:59.623150 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m16:00:59.623150 [info ] [MainThread]: 
[0m16:00:59.624151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:59.624151 [info ] [MainThread]: 
[0m16:00:59.625180 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:00:59.626150 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:59.626150 after 2.02 seconds
[0m16:00:59.626150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A9977210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A9CD1E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A9A47F10>]}
[0m16:00:59.627150 [debug] [MainThread]: Flushing usage events
[0m16:01:00.736929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:58.912345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28D93C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28ED8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28ED8BD0>]}


============================== 16:07:58.915346 | 15e1ce96-6086-4d0b-a7dc-ec635203f185 ==============================
[0m16:07:58.915346 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:07:58.917348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:59.160620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE290E6AD0>]}
[0m16:07:59.232213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE25895490>]}
[0m16:07:59.234238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:07:59.526073 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:07:59.714046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:59.716045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:59.779045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE2A3C3090>]}
[0m16:07:59.898045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:07:59.901042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:07:59.942044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28F01F10>]}
[0m16:07:59.943044 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m16:07:59.944055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28F29A50>]}
[0m16:07:59.947044 [info ] [MainThread]: 
[0m16:07:59.948044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:59.948044 [info ] [MainThread]: 
[0m16:07:59.949043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:59.955042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:08:00.057050 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:08:00.058045 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:08:00.059044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:00.216300 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.157 seconds
[0m16:08:00.218232 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:08:00.220331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m16:08:00.229529 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:08:00.230065 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m16:08:00.230599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:00.377877 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m16:08:00.378904 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:08:00.378904 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:08:00.385874 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m16:08:00.386873 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m16:08:00.387875 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m16:08:00.393873 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:00.394875 [debug] [MainThread]: On master: BEGIN
[0m16:08:00.394875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:00.428654 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m16:08:00.428654 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:00.429653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:08:00.438653 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m16:08:00.439651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE2901B6D0>]}
[0m16:08:00.440653 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:00.441652 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:00.441652 [debug] [MainThread]: On master: BEGIN
[0m16:08:00.442653 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:08:00.442653 [debug] [MainThread]: On master: COMMIT
[0m16:08:00.443652 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:00.444654 [debug] [MainThread]: On master: COMMIT
[0m16:08:00.444654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:08:00.445653 [debug] [MainThread]: On master: Close
[0m16:08:00.448653 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m16:08:00.449653 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m16:08:00.450653 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m16:08:00.451653 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m16:08:00.459651 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m16:08:00.461653 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m16:08:00.500656 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m16:08:00.502652 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.502652 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m16:08:00.503653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:00.642690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m16:08:00.642690 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.643690 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m16:08:00.649693 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:08:00.656689 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.657691 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m16:08:00.658689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:00.662691 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.662691 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m16:08:00.663690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:00.679700 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:08:00.680691 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.681689 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:08:00.684691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:08:00.690692 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m16:08:00.696689 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:08:00.697691 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m16:08:00.698692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:08:00.702691 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m16:08:00.705702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE2A83EA50>]}
[0m16:08:00.706690 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.25s]
[0m16:08:00.706690 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m16:08:00.707691 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m16:08:00.708691 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m16:08:00.709692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m16:08:00.709692 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m16:08:00.712691 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m16:08:00.714690 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m16:08:00.719690 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m16:08:00.721698 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.721698 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m16:08:00.722692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:00.754692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:08:00.754692 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.755690 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m16:08:00.759690 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:08:00.813313 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.813313 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m16:08:00.814314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:00.818314 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.819314 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m16:08:00.820314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:00.822314 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:08:00.823314 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.823314 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:08:00.827314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:08:00.830313 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m16:08:00.831312 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:08:00.832313 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m16:08:00.833313 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:08:00.835314 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m16:08:00.836314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE29050610>]}
[0m16:08:00.837314 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.13s]
[0m16:08:00.838315 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m16:08:00.839313 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m16:08:00.840316 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m16:08:00.841313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m16:08:00.841313 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m16:08:00.845315 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m16:08:00.846313 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m16:08:00.870315 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m16:08:00.872312 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:00.872312 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m16:08:00.873313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:01.015654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m16:08:01.016684 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:01.016684 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m16:08:01.026655 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m16:08:01.033663 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:01.033663 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m16:08:01.034653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.037652 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:01.038654 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m16:08:01.039665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:01.041655 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:08:01.042654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:01.042654 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:08:01.044655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:01.047673 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m16:08:01.050653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:08:01.051654 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m16:08:01.055677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:08:01.057653 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m16:08:01.057653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE2AD41490>]}
[0m16:08:01.058655 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.22s]
[0m16:08:01.059654 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m16:08:01.060656 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m16:08:01.060656 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m16:08:01.061655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m16:08:01.062655 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m16:08:01.065656 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m16:08:01.065656 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m16:08:01.071653 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m16:08:01.072655 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.073656 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m16:08:01.073656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:01.107654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:08:01.108654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.108654 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m16:08:01.117655 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.009 seconds
[0m16:08:01.121655 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.122655 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m16:08:01.123655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.126652 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.127655 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:08:01.128655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.130656 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:08:01.132657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.133655 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:08:01.134654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:01.137655 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m16:08:01.138656 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:08:01.139662 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m16:08:01.142656 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:08:01.145661 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m16:08:01.146655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE2A8F8A90>]}
[0m16:08:01.147655 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.09s]
[0m16:08:01.148656 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m16:08:01.148656 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m16:08:01.149655 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m16:08:01.150655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m16:08:01.151654 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m16:08:01.155655 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m16:08:01.156655 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m16:08:01.162657 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m16:08:01.164654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.164654 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m16:08:01.165654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:01.312655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m16:08:01.313653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.314652 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m16:08:01.325658 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.011 seconds
[0m16:08:01.329653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.330655 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m16:08:01.331664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.335656 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.336653 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m16:08:01.336653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.338655 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:08:01.339658 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.340654 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:08:01.341655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:01.344653 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m16:08:01.345655 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:08:01.346660 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m16:08:01.350654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:08:01.352653 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m16:08:01.352653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28F001D0>]}
[0m16:08:01.353654 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.20s]
[0m16:08:01.354654 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m16:08:01.355655 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m16:08:01.355655 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m16:08:01.356656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m16:08:01.357653 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m16:08:01.360654 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m16:08:01.361654 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m16:08:01.365654 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m16:08:01.366656 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.367654 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m16:08:01.367654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:01.400654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:08:01.400654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.401654 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from "telegram_db"."analytics"."stg_telegram_messages"
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m16:08:01.409657 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.007 seconds
[0m16:08:01.413655 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.414656 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m16:08:01.415654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:08:01.421655 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.421655 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m16:08:01.423656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:08:01.425654 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:08:01.425654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.426655 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:08:01.427654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:08:01.430654 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m16:08:01.432654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:08:01.432654 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m16:08:01.435657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:08:01.437655 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m16:08:01.439656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e1ce96-6086-4d0b-a7dc-ec635203f185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE28F874D0>]}
[0m16:08:01.440655 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.08s]
[0m16:08:01.441657 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m16:08:01.443656 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:01.444654 [debug] [MainThread]: On master: BEGIN
[0m16:08:01.444654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:01.592407 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m16:08:01.593406 [debug] [MainThread]: On master: COMMIT
[0m16:08:01.593406 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:01.594420 [debug] [MainThread]: On master: COMMIT
[0m16:08:01.595406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:08:01.595406 [debug] [MainThread]: On master: Close
[0m16:08:01.596407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:01.597407 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m16:08:01.597407 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m16:08:01.598407 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m16:08:01.598407 [info ] [MainThread]: 
[0m16:08:01.599414 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m16:08:01.601406 [debug] [MainThread]: Command end result
[0m16:08:01.623407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:08:01.627407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:08:01.633408 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m16:08:01.634406 [info ] [MainThread]: 
[0m16:08:01.634406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:01.635407 [info ] [MainThread]: 
[0m16:08:01.636409 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:08:01.637408 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:01.637408 after 2.82 seconds
[0m16:08:01.638406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE22187210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE22257F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE22257F10>]}
[0m16:08:01.638406 [debug] [MainThread]: Flushing usage events
[0m16:08:02.833152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:48.871009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213736E9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213736AA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137341F310>]}


============================== 16:10:48.880013 | dbb231fd-b25e-4d50-a8a6-3f6ffb673552 ==============================
[0m16:10:48.880013 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:10:48.882012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:10:49.267189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021373830F50>]}
[0m16:10:49.344234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213700A1AD0>]}
[0m16:10:49.346228 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:10:49.659222 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:10:49.883747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:49.884745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:49.963274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021374B9EF90>]}
[0m16:10:50.096705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:10:50.100704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:10:50.143223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021374AC3E50>]}
[0m16:10:50.144223 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m16:10:50.145224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021374BD32D0>]}
[0m16:10:50.147222 [info ] [MainThread]: 
[0m16:10:50.148222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:50.148222 [info ] [MainThread]: 
[0m16:10:50.149225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:50.155224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:10:50.253763 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:10:50.254762 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:10:50.255767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:50.318763 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.063 seconds
[0m16:10:50.320763 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:10:50.323764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m16:10:50.330764 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:10:50.331764 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m16:10:50.332764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:50.371786 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m16:10:50.372790 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:10:50.373795 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:10:50.391784 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.018 seconds
[0m16:10:50.394788 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m16:10:50.395786 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m16:10:50.405785 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:50.406786 [debug] [MainThread]: On master: BEGIN
[0m16:10:50.406786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:50.447786 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m16:10:50.448788 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:50.448788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:50.462788 [debug] [MainThread]: SQL status: SELECT 2 in 0.013 seconds
[0m16:10:50.464789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021374D09650>]}
[0m16:10:50.465787 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:50.465787 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:50.466787 [debug] [MainThread]: On master: BEGIN
[0m16:10:50.467787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:10:50.467787 [debug] [MainThread]: On master: COMMIT
[0m16:10:50.468786 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:50.468786 [debug] [MainThread]: On master: COMMIT
[0m16:10:50.469788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:50.470788 [debug] [MainThread]: On master: Close
[0m16:10:50.475786 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m16:10:50.476790 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m16:10:50.477788 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m16:10:50.478787 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m16:10:50.486785 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m16:10:50.487786 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m16:10:50.526784 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m16:10:50.527784 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.528784 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m16:10:50.528784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:50.681293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m16:10:50.682292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.682292 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m16:10:50.697294 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m16:10:50.704291 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.705291 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m16:10:50.707293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:10:50.711292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.712292 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m16:10:50.713301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:50.730293 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:10:50.731292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.732293 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:10:50.733293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:50.741293 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m16:10:50.746291 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:10:50.747293 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m16:10:50.751292 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:50.754293 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m16:10:50.756294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213750CC5D0>]}
[0m16:10:50.757300 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.28s]
[0m16:10:50.758294 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m16:10:50.759293 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m16:10:50.760293 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m16:10:50.760293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m16:10:50.761293 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m16:10:50.764293 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m16:10:50.765293 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m16:10:50.771294 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m16:10:50.772293 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.772293 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m16:10:50.773293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:50.906293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.132 seconds
[0m16:10:50.906293 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.907293 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m16:10:50.914296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:10:50.970296 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.971293 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m16:10:50.972294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:50.976296 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.977297 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m16:10:50.980293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:10:50.983292 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:10:50.983292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.984296 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:10:50.985295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:50.988294 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m16:10:50.990294 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:10:50.990294 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m16:10:50.992292 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:10:50.993291 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m16:10:50.994294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213751D8050>]}
[0m16:10:50.995294 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.23s]
[0m16:10:50.996297 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m16:10:50.997296 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m16:10:50.998296 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m16:10:50.999294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m16:10:51.000296 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m16:10:51.003325 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m16:10:51.004295 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m16:10:51.025293 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m16:10:51.027293 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.027293 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m16:10:51.028291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:51.059292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:10:51.060296 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.061294 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m16:10:51.072294 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.011 seconds
[0m16:10:51.079320 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.079320 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m16:10:51.080295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.084326 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.084326 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m16:10:51.085292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.087294 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:10:51.088293 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.088293 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:10:51.089293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:51.092292 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m16:10:51.095294 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:10:51.096293 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m16:10:51.100297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:10:51.102296 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m16:10:51.103305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213751A9690>]}
[0m16:10:51.104313 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.10s]
[0m16:10:51.105296 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m16:10:51.106294 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m16:10:51.106294 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m16:10:51.107295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m16:10:51.108292 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m16:10:51.111294 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m16:10:51.112295 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m16:10:51.120294 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m16:10:51.121295 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.122297 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m16:10:51.123307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:51.274310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m16:10:51.275307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.276336 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m16:10:51.287306 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m16:10:51.291306 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.291306 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m16:10:51.292307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.296309 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.296309 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:10:51.297308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.299307 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:10:51.300307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.300307 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:10:51.302307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:51.304307 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m16:10:51.306306 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:10:51.306306 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m16:10:51.309307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:10:51.311308 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m16:10:51.312307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213750E7A90>]}
[0m16:10:51.313307 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.21s]
[0m16:10:51.314307 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m16:10:51.314307 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m16:10:51.315307 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m16:10:51.316306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m16:10:51.317337 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m16:10:51.320337 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m16:10:51.321335 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m16:10:51.326335 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m16:10:51.327335 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.328309 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m16:10:51.328309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:51.465306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m16:10:51.465306 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.466306 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m16:10:51.479306 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.013 seconds
[0m16:10:51.483307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.484308 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m16:10:51.484308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.488305 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.488305 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m16:10:51.489306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.491309 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:10:51.492306 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.493307 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:10:51.494341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:51.497307 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m16:10:51.498307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:10:51.498307 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m16:10:51.503335 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:10:51.504310 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m16:10:51.505307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021372E5E510>]}
[0m16:10:51.506307 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.19s]
[0m16:10:51.507307 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m16:10:51.508307 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m16:10:51.508307 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m16:10:51.509306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m16:10:51.509306 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m16:10:51.513305 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m16:10:51.514307 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m16:10:51.518307 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m16:10:51.519308 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.520308 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m16:10:51.520308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:51.563309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:10:51.563309 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.564310 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from "telegram_db"."analytics"."stg_telegram_messages"
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m16:10:51.573307 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.008 seconds
[0m16:10:51.577307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.578309 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m16:10:51.579306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:10:51.584307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.584307 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m16:10:51.586309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:51.588315 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:10:51.589307 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.589307 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:10:51.590306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:51.594307 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m16:10:51.595308 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:10:51.596308 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m16:10:51.599310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:10:51.600307 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m16:10:51.601309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb231fd-b25e-4d50-a8a6-3f6ffb673552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213738744D0>]}
[0m16:10:51.602309 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.09s]
[0m16:10:51.603306 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m16:10:51.604307 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.605308 [debug] [MainThread]: On master: BEGIN
[0m16:10:51.606312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:51.757865 [debug] [MainThread]: SQL status: BEGIN in 0.152 seconds
[0m16:10:51.758863 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.758863 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:51.759861 [debug] [MainThread]: On master: COMMIT
[0m16:10:51.760863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:10:51.761864 [debug] [MainThread]: On master: Close
[0m16:10:51.762864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:51.763863 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m16:10:51.763863 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m16:10:51.764863 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m16:10:51.764863 [info ] [MainThread]: 
[0m16:10:51.765862 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m16:10:51.767862 [debug] [MainThread]: Command end result
[0m16:10:51.800861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:10:51.803861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:10:51.812383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m16:10:51.812383 [info ] [MainThread]: 
[0m16:10:51.813383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:51.814385 [info ] [MainThread]: 
[0m16:10:51.814385 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:10:51.816385 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:51.816385 after 3.09 seconds
[0m16:10:51.817386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136C9E7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136CD41E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136CAB7F10>]}
[0m16:10:51.818385 [debug] [MainThread]: Flushing usage events
[0m16:10:57.319685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:14.789870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8ED77A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8E9C9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8ED748D0>]}


============================== 16:20:14.794870 | 196af69c-13c6-4b54-bf8d-bc1a0b443837 ==============================
[0m16:20:14.794870 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:20:14.795870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pc\\.dbt', 'log_path': 'C:\\Users\\pc\\Desktop\\10 Academy\\Week 7\\Shipping_data_product\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:15.071883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8EF87ED0>]}
[0m16:20:15.139882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8B72E990>]}
[0m16:20:15.141883 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:15.411923 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:20:15.594437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:15.595439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:15.657954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E90265F10>]}
[0m16:20:15.767471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:20:15.771477 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:20:15.805595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8EF87810>]}
[0m16:20:15.806610 [info ] [MainThread]: Found 6 models, 1 test, 2 sources, 433 macros
[0m16:20:15.806610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8EDA02D0>]}
[0m16:20:15.808609 [info ] [MainThread]: 
[0m16:20:15.809609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:15.810609 [info ] [MainThread]: 
[0m16:20:15.811612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:15.817607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:20:15.931606 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:20:15.932605 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:20:15.933606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:15.993973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m16:20:15.995976 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:20:16.000977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_analytics'
[0m16:20:16.012917 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:20:16.012917 [debug] [ThreadPool]: On list_telegram_db_analytics: BEGIN
[0m16:20:16.013916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:16.061598 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:20:16.062598 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_analytics"
[0m16:20:16.063602 [debug] [ThreadPool]: On list_telegram_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "list_telegram_db_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:20:16.072600 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m16:20:16.075602 [debug] [ThreadPool]: On list_telegram_db_analytics: ROLLBACK
[0m16:20:16.076601 [debug] [ThreadPool]: On list_telegram_db_analytics: Close
[0m16:20:16.086817 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.087817 [debug] [MainThread]: On master: BEGIN
[0m16:20:16.088826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:16.125817 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:20:16.125817 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.126817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:16.134818 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m16:20:16.136817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E907948D0>]}
[0m16:20:16.137821 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:16.138820 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.139817 [debug] [MainThread]: On master: BEGIN
[0m16:20:16.139817 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:20:16.140820 [debug] [MainThread]: On master: COMMIT
[0m16:20:16.141817 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.141817 [debug] [MainThread]: On master: COMMIT
[0m16:20:16.142816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:16.142816 [debug] [MainThread]: On master: Close
[0m16:20:16.146818 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_image_detections
[0m16:20:16.146818 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_image_detections ..................... [RUN]
[0m16:20:16.147816 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_project.stg_image_detections'
[0m16:20:16.148816 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_image_detections
[0m16:20:16.155817 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_image_detections"
[0m16:20:16.156817 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_image_detections
[0m16:20:16.193818 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_image_detections"
[0m16:20:16.195816 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.195816 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: BEGIN
[0m16:20:16.196816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:16.229817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:20:16.229817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.230816 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */

  create view "telegram_db"."analytics"."stg_image_detections__dbt_tmp"
    
    
  as (
    SELECT CAST(message_id AS TEXT) AS message_id,
    file_name,
    object_class AS detected_object_class,
    confidence_score
FROM "telegram_db"."raw"."image_detections"
  );
[0m16:20:16.235818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:20:16.241822 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.242816 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections" rename to "stg_image_detections__dbt_backup"
[0m16:20:16.243816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.246816 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.247814 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
alter table "telegram_db"."analytics"."stg_image_detections__dbt_tmp" rename to "stg_image_detections"
[0m16:20:16.249820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:16.265818 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:20:16.266817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.266817 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: COMMIT
[0m16:20:16.268821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:16.275840 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_image_detections__dbt_backup"
[0m16:20:16.282817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_image_detections"
[0m16:20:16.283816 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_image_detections"} */
drop view if exists "telegram_db"."analytics"."stg_image_detections__dbt_backup" cascade
[0m16:20:16.285816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:20:16.287817 [debug] [Thread-1 (]: On model.telegram_project.stg_image_detections: Close
[0m16:20:16.291817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E906CF8D0>]}
[0m16:20:16.292815 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_image_detections ................ [[32mCREATE VIEW[0m in 0.14s]
[0m16:20:16.293816 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_image_detections
[0m16:20:16.294816 [debug] [Thread-1 (]: Began running node model.telegram_project.stg_telegram_messages
[0m16:20:16.295818 [info ] [Thread-1 (]: 2 of 6 START sql view model analytics.stg_telegram_messages .................... [RUN]
[0m16:20:16.296817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_image_detections, now model.telegram_project.stg_telegram_messages)
[0m16:20:16.296817 [debug] [Thread-1 (]: Began compiling node model.telegram_project.stg_telegram_messages
[0m16:20:16.299818 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.stg_telegram_messages"
[0m16:20:16.300816 [debug] [Thread-1 (]: Began executing node model.telegram_project.stg_telegram_messages
[0m16:20:16.306814 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.stg_telegram_messages"
[0m16:20:16.307816 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.307816 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: BEGIN
[0m16:20:16.308816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.344819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:20:16.345818 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.346817 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */

  create view "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT *
    FROM "telegram_db"."raw"."telegram_messages"
),
cleaned AS (
    SELECT CAST(message_id AS INTEGER) AS message_id,
        sender_id,
        message_text AS text,
        CAST(message_date AS TIMESTAMP) AS message_timestamp,
        channel_name,
        FALSE AS has_image
    FROM source
)
SELECT *
FROM cleaned
  );
[0m16:20:16.350816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:20:16.403815 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.404817 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m16:20:16.406817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.409817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.410815 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
alter table "telegram_db"."analytics"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m16:20:16.411817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.413815 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:20:16.413815 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.414816 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: COMMIT
[0m16:20:16.415816 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:16.418814 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."stg_telegram_messages__dbt_backup"
[0m16:20:16.419816 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.stg_telegram_messages"
[0m16:20:16.420815 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.stg_telegram_messages"} */
drop view if exists "telegram_db"."analytics"."stg_telegram_messages__dbt_backup" cascade
[0m16:20:16.422818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:20:16.425817 [debug] [Thread-1 (]: On model.telegram_project.stg_telegram_messages: Close
[0m16:20:16.426816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E903F3B90>]}
[0m16:20:16.427817 [info ] [Thread-1 (]: 2 of 6 OK created sql view model analytics.stg_telegram_messages ............... [[32mCREATE VIEW[0m in 0.13s]
[0m16:20:16.429817 [debug] [Thread-1 (]: Finished running node model.telegram_project.stg_telegram_messages
[0m16:20:16.430822 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_channels
[0m16:20:16.431817 [info ] [Thread-1 (]: 3 of 6 START sql table model analytics.dim_channels ............................ [RUN]
[0m16:20:16.432815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.stg_telegram_messages, now model.telegram_project.dim_channels)
[0m16:20:16.433819 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_channels
[0m16:20:16.437818 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_channels"
[0m16:20:16.438817 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_channels
[0m16:20:16.460819 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_channels"
[0m16:20:16.461817 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.462816 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: BEGIN
[0m16:20:16.462816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.496816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m16:20:16.497822 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.498823 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */

  
    

  create  table "telegram_db"."analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    WITH messages AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_telegram_messages"
),
channels AS (
    SELECT DISTINCT channel_name
    FROM messages
)
SELECT channel_name,
    'Channel ' || channel_name AS channel_display_name
FROM channels
  );
  
[0m16:20:16.509395 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m16:20:16.518395 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.519413 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m16:20:16.520401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.524395 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.524395 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
alter table "telegram_db"."analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m16:20:16.526399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:16.528399 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:20:16.529398 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.529398 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: COMMIT
[0m16:20:16.531397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:16.535395 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_channels__dbt_backup"
[0m16:20:16.538396 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_channels"
[0m16:20:16.538396 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_channels"} */
drop table if exists "telegram_db"."analytics"."dim_channels__dbt_backup" cascade
[0m16:20:16.542395 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:20:16.544394 [debug] [Thread-1 (]: On model.telegram_project.dim_channels: Close
[0m16:20:16.545394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8DE1D590>]}
[0m16:20:16.546402 [info ] [Thread-1 (]: 3 of 6 OK created sql table model analytics.dim_channels ....................... [[32mSELECT 2[0m in 0.11s]
[0m16:20:16.547397 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_channels
[0m16:20:16.548402 [debug] [Thread-1 (]: Began running node model.telegram_project.dim_dates
[0m16:20:16.549399 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.dim_dates ............................... [RUN]
[0m16:20:16.549399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_channels, now model.telegram_project.dim_dates)
[0m16:20:16.550397 [debug] [Thread-1 (]: Began compiling node model.telegram_project.dim_dates
[0m16:20:16.553398 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.dim_dates"
[0m16:20:16.554400 [debug] [Thread-1 (]: Began executing node model.telegram_project.dim_dates
[0m16:20:16.561403 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.dim_dates"
[0m16:20:16.562399 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.562399 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: BEGIN
[0m16:20:16.563399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.599395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:20:16.600394 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.600394 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */

  
    

  create  table "telegram_db"."analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

WITH dates AS (
    SELECT DISTINCT DATE(message_timestamp) AS date_day
    FROM "telegram_db"."analytics"."stg_telegram_messages"
)

SELECT
    date_day,
    EXTRACT(DAY FROM date_day) AS day,
    EXTRACT(WEEK FROM date_day) AS week,
    EXTRACT(MONTH FROM date_day) AS month,
    EXTRACT(YEAR FROM date_day) AS year
FROM dates
  );
  
[0m16:20:16.609407 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m16:20:16.613394 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.614217 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m16:20:16.615227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.618226 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.619227 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
alter table "telegram_db"."analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:20:16.620228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.622227 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:20:16.623228 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.623228 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: COMMIT
[0m16:20:16.624227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:16.628226 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."dim_dates__dbt_backup"
[0m16:20:16.629228 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.dim_dates"
[0m16:20:16.630227 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.dim_dates"} */
drop table if exists "telegram_db"."analytics"."dim_dates__dbt_backup" cascade
[0m16:20:16.633226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:20:16.635230 [debug] [Thread-1 (]: On model.telegram_project.dim_dates: Close
[0m16:20:16.636240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E90702250>]}
[0m16:20:16.637241 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.dim_dates .......................... [[32mSELECT 11[0m in 0.09s]
[0m16:20:16.638239 [debug] [Thread-1 (]: Finished running node model.telegram_project.dim_dates
[0m16:20:16.639239 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_image_detections
[0m16:20:16.640240 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.fct_image_detections .................... [RUN]
[0m16:20:16.641239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.dim_dates, now model.telegram_project.fct_image_detections)
[0m16:20:16.642268 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_image_detections
[0m16:20:16.645242 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_image_detections"
[0m16:20:16.647244 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_image_detections
[0m16:20:16.651240 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_image_detections"
[0m16:20:16.652240 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.653270 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: BEGIN
[0m16:20:16.653270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.686239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:20:16.686239 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.687237 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */

  
    

  create  table "telegram_db"."analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    -- SELECT det.message_id,
--     det.file_name,
--     det.detected_object_class,
--     det.confidence_score,
--     msg.channel_name,
--     msg.message_timestamp
-- FROM "telegram_db"."analytics"."stg_image_detections" AS det
--     LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
--     ON CAST(det.message_id AS INTEGER) = msg.message_id

WITH valid_detections AS (
    SELECT *
    FROM "telegram_db"."analytics"."stg_image_detections"
    WHERE message_id IS NOT NULL AND message_id ~ '^\d+$'
)

SELECT 
    det.message_id,
    det.file_name,
    det.detected_object_class,
    det.confidence_score,
    msg.channel_name,
    msg.message_timestamp
FROM valid_detections AS det
LEFT JOIN "telegram_db"."analytics"."stg_telegram_messages" AS msg
    ON CAST(det.message_id AS INTEGER) = msg.message_id
  );
  
[0m16:20:16.698272 [debug] [Thread-1 (]: SQL status: SELECT 1464 in 0.010 seconds
[0m16:20:16.702270 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.702270 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m16:20:16.703266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.707238 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.707238 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
alter table "telegram_db"."analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m16:20:16.708237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.710237 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:20:16.711237 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.711237 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: COMMIT
[0m16:20:16.713258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:20:16.716238 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_image_detections__dbt_backup"
[0m16:20:16.717238 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_image_detections"
[0m16:20:16.718236 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_image_detections"} */
drop table if exists "telegram_db"."analytics"."fct_image_detections__dbt_backup" cascade
[0m16:20:16.724241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m16:20:16.726258 [debug] [Thread-1 (]: On model.telegram_project.fct_image_detections: Close
[0m16:20:16.727239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E90751D50>]}
[0m16:20:16.728268 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics.fct_image_detections ............... [[32mSELECT 1464[0m in 0.09s]
[0m16:20:16.730238 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_image_detections
[0m16:20:16.730238 [debug] [Thread-1 (]: Began running node model.telegram_project.fct_messages
[0m16:20:16.731235 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fct_messages ............................ [RUN]
[0m16:20:16.732237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_project.fct_image_detections, now model.telegram_project.fct_messages)
[0m16:20:16.732237 [debug] [Thread-1 (]: Began compiling node model.telegram_project.fct_messages
[0m16:20:16.736239 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_project.fct_messages"
[0m16:20:16.737237 [debug] [Thread-1 (]: Began executing node model.telegram_project.fct_messages
[0m16:20:16.742241 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_project.fct_messages"
[0m16:20:16.744238 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.745240 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: BEGIN
[0m16:20:16.745240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:16.784242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:20:16.785242 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.785242 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */

  
    

  create  table "telegram_db"."analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    with stg as (
  select *
  from "telegram_db"."analytics"."stg_telegram_messages"
)
select message_id,
  sender_id,
  has_image,
  length(text) as message_length,
  date_trunc('day', message_timestamp) as message_date
from stg
  );
  
[0m16:20:16.792240 [debug] [Thread-1 (]: SQL status: SELECT 400 in 0.007 seconds
[0m16:20:16.796240 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.797241 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m16:20:16.798243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:20:16.802241 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.803239 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
alter table "telegram_db"."analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m16:20:16.805256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:20:16.807240 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:20:16.807240 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.808236 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: COMMIT
[0m16:20:16.811244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:20:16.814236 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."analytics"."fct_messages__dbt_backup"
[0m16:20:16.815238 [debug] [Thread-1 (]: Using postgres connection "model.telegram_project.fct_messages"
[0m16:20:16.815238 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "telegram_project", "target_name": "dev", "node_id": "model.telegram_project.fct_messages"} */
drop table if exists "telegram_db"."analytics"."fct_messages__dbt_backup" cascade
[0m16:20:16.819239 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:20:16.821237 [debug] [Thread-1 (]: On model.telegram_project.fct_messages: Close
[0m16:20:16.822237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196af69c-13c6-4b54-bf8d-bc1a0b443837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E90C057D0>]}
[0m16:20:16.822237 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fct_messages ....................... [[32mSELECT 400[0m in 0.09s]
[0m16:20:16.823238 [debug] [Thread-1 (]: Finished running node model.telegram_project.fct_messages
[0m16:20:16.825242 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.826241 [debug] [MainThread]: On master: BEGIN
[0m16:20:16.827239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:16.961934 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m16:20:16.962934 [debug] [MainThread]: On master: COMMIT
[0m16:20:16.963904 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:16.964924 [debug] [MainThread]: On master: COMMIT
[0m16:20:16.965456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:16.966466 [debug] [MainThread]: On master: Close
[0m16:20:16.967466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:16.968469 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m16:20:16.968469 [debug] [MainThread]: Connection 'list_telegram_db_analytics' was properly closed.
[0m16:20:16.969468 [debug] [MainThread]: Connection 'model.telegram_project.fct_messages' was properly closed.
[0m16:20:16.970467 [info ] [MainThread]: 
[0m16:20:16.970467 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m16:20:16.972466 [debug] [MainThread]: Command end result
[0m16:20:16.995478 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\manifest.json
[0m16:20:16.999470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\semantic_manifest.json
[0m16:20:17.006464 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\pc\Desktop\10 Academy\Week 7\Shipping_data_product\target\run_results.json
[0m16:20:17.007464 [info ] [MainThread]: 
[0m16:20:17.008473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:17.008473 [info ] [MainThread]: 
[0m16:20:17.009465 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:20:17.010465 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:17.010465 after 2.32 seconds
[0m16:20:17.010465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E88067210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9074CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E883C1E10>]}
[0m16:20:17.011466 [debug] [MainThread]: Flushing usage events
[0m16:20:18.560778 [debug] [MainThread]: An error was encountered while trying to flush usage events
